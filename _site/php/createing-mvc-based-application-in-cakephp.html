<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>CakePHP를 이용하여 MVC 기반 웹 서비스 CRUD 개발하기</title>
    <meta name="description" content="">

    <meta content="saltfactory's blog" property="og:site_name">
    
    <meta content="CakePHP를 이용하여 MVC 기반 웹 서비스 CRUD 개발하기" property="og:title">
    
    
    <meta content="article" property="og:type">
    
    <!-- 서론

이번 포스팅은 이전 포스팅을 기반으로 CRUD ( Create, Retrieve, Update, Delete)를 기능을 추가하는 예제를 테스트한다. 이번 포스팅도 앞의 포스팅과 동일하게 CakePHP document를 기반으로 실험하도록 한다.

&lt;--more--&gt;

웹 서비스에서 CRUD는 특별한 일이 없는 이상 URL 요청으로 처리가 된다. (예외는 API나 소켓 요청인데 이 또한 URL 기반으로 되어져 있다.) 요즘은 이러한 URL 요청대신에 RESTful 서비스라고 말을 하기도 하지만 이말을 쉽게 말하면 URL 과 헤더타입에 따라서 처리를 해주는 서비스라고 생각할 수 있다. 일축하고, 우리는 이러한 CRUD 요청을 처리하기 위해서 이것을 담당하는 것이 Controller라고 앞의 포스팅에서 다루었다. 앞의 포스팅에서는 Post의 전체를 가져와서 리스팅해주는 index 메소드를 하나 생성해 두었는데, 그 아래 CRUD를 처리하기 위해서 view, add, edit, update, delete 메소드를 추가할 것이다.

Retrieve

앞에서 만들어둔 index 메소드는 블로그의 글을 리스팅하는데 우리는 블로그 제목을 클릭하면 해당되는 글의 상세 정보를 보기 위한 view 메소드를 추가할 것이다.

/app/Controller/PostController.php 파일을 열어서 다음과 같이 코드를 수정한다. 제목을 누르면 해당하는 글의 id 를 가지고 view 를 처리할 하는 View 파일을 호출할 것인데 이 때 Model 중에 id에 해당하는 데이터를 찾아서 View 파일에 post 라는 이름으로 저장하여 넘겨주게 된다.
&lt;?php
class PostsController extends AppController {
public $helpers = array(&#39;Html&#39;, &#39;Form&#39;);

    public function index() {
         $this-&gt;set(&#39;posts&#39;, $this-&gt;Post-&gt;find(&#39;all&#39;));
    }

    public function view($id = null) {
        $this-&gt;Post-&gt;id = $id;
        $this-&gt;set(&#39;post&#39;, $this-&gt;Post-&gt;read());
    }
}

컨트롤러 작업을 마쳤으면 /app/View/Posts/view.ctp 파일을 추가하고 다음과 같이 코드를 저장한다. PostController의 view 메소드에서 id 기반으로 가져온 post의 값 중에서 title, created, body를 출력시키는 코드이다.
&lt;!-- File: /app/View/Posts/view.ctp --&gt;

&lt;h1&gt;&lt;?php echo h($post[&#39;Post&#39;][&#39;title&#39;]); ?&gt;&lt;/h1&gt;

&lt;p&gt;&lt;small&gt;Created: &lt;?php echo $post[&#39;Post&#39;][&#39;created&#39;]; ?&gt;&lt;/small&gt;&lt;/p&gt;

&lt;p&gt;&lt;?php echo h($post[&#39;Post&#39;][&#39;body&#39;]); ?&gt;&lt;/p&gt;

이제 브라우저에서 바르게 동작하는지 확인해보자.
http://cake.saltfactory.local/posts



이 목록 중에서 1번째 &quot;The title&quot; 이라는 글을 클릭해보자. 그러면 http://cake.saltfactory.local/posts/view/1 URL이 요청될 것이다. 이 URL 요청은 PostsController의 view 메소드가 id 라는 파라미터와 함께 요청을 받아서 처리하게 된다. 이 때 Model Post에서 id 값이 1 인 post를 조회해서 처리하기 때문에 trace를 살펴보면 query 의 where 조건에 Post.id=1 인 쿼리가 실행 된 것을 확인할 수 있다.



Create

create를 처리하기 위해서는 두 가지 요청이 필요하다 하나는 데이터를 입력시키는 뷰를 보여주는 Form을 가진 URL 요청이고 하나는 데이터를 받아서 데이터베이스에 저장하는 URL 요청이다. 이 두 가지의 요청을 처리하기 위해서 우리는 동일한 URL 요청에 HTTP의 헤더의 method가 GET 일 경우와 Post 인 경우에 따라서 요청을 처리하는 것을 구분할 수 있도록 구현할 것이다.  우리는 add 라는 메소드를 추가하는데 $this-&gt;request-&gt;is(&#39;post&#39;) 라는 것으로 이 컨트롤러의 요청이 POST 인지를 비교해서 POST일 경우는 Post-&gt;save()를 통해서 request로 넘어온 data를 저장한다. 그리고 컨트롤러가 관장하는 Session에 flash 메세지를 저장해서 index URL 요청으로 redirect 시키도록 했다. flash는 데이터가 저장되고 난 다음 view에 저장이 성공적으로 되었다고 표시해주기 위한 영역이다.
&lt;?php
class PostsController extends AppController {
public $helpers = array(&#39;Html&#39;, &#39;Form&#39;);

    public function index() {
         $this-&gt;set(&#39;posts&#39;, $this-&gt;Post-&gt;find(&#39;all&#39;));
    }

    public function view($id = null) {
        $this-&gt;Post-&gt;id = $id;
        $this-&gt;set(&#39;post&#39;, $this-&gt;Post-&gt;read());
    }

    public function add() {
            if ($this-&gt;request-&gt;is(&#39;post&#39;)){
                    if ($this-&gt;Post-&gt;save($this-&gt;request-&gt;data)){
                            $this-&gt;Session-&gt;setFlash(&#39;Your post has been saved.&#39;);
                            $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
                    } else {
                           $this-&gt;Session-&gt;setFlash(&#39;Unable to add your post.&#39;);
                    }
            }
    }

}

그렇지 않고 GET 요청이 들어오면 단순하게 add를 할 수 있는 뷰 파일을 요청할 것이다. /app/View/Posts/add.ctp 파일을 추가하여 다음 코드를 추가한다.
&lt;!-- File: /app/View/Posts/add.ctp --&gt;

&lt;h1&gt;Add Post&lt;/h1&gt;
&lt;?php
echo $this-&gt;Form-&gt;create(&#39;Post&#39;);
echo $this-&gt;Form-&gt;input(&#39;title&#39;);
echo $this-&gt;Form-&gt;input(&#39;body&#39;, array(&#39;rows&#39; =&gt; &#39;3&#39;));
echo $this-&gt;Form-&gt;end(&#39;Save Post&#39;);
?&gt;

MVC 기반의 어플리케이션에서 Model을 만들어서 사용하는 이유가 테이블의 매핑을 단순히 하기 위해서만 사용하는 것은 아니다. Model은 데이터의 저장되는 내용 뿐만 아니라 데이터의 관계, 그리고 속성 비즈니스 규칙까지 정의할 수 있다. Model의 관계 정의에 대해서는 이후에 설명하도록 하고 지금은 Model의 속성 validation 을 하는 것을 살펴보겠다. 쉽게 말하면 Post라는 Model이 데이터베이스에 저장되거나 어플리케이션에서 사용될 때 속성의 값의 형태가 어떤지 체크를 하는 것이다. Post는 반드시 제목과 내용이 있어야 한다고 비즈니스 규칙을 정했다고 하자. 이를 Model에 반영할 수 있는데 다음과 같은 코드로 반영할 수 있다.
/app/Model/Post.php 를 다음과 같이 수정한다.
&lt;?php
class Post extends AppModel {
    public $validate = array(
        &#39;title&#39; =&gt; array(
            &#39;rule&#39; =&gt; &#39;notEmpty&#39;
        ),
        &#39;body&#39; =&gt; array(
            &#39;rule&#39; =&gt; &#39;notEmpty&#39;
        )
    );
}

이렇게 Model의 validate로 title과 body의 비즈니스 규칙을 notEmpty라고 정의하게 되면 이후에 반드시 이 두가지 속성에는 빈 값이 들어가면 안된다는 체크를 실시하게 된다.

브라우저에서 http://cake.saltfactory.local/posts/add 라고 요청해보자. 단순하게 브라우저에 요청했으니 GET으로 요청하게 될 것이기 때문에 다음과 같이 PostsController에서 GET의 요청을 처리하는 뷰를 볼 수 있다.



데이터를 저장하고 Save Post 버튼을 누르면 동일한 http://cake.saltfactory.local/posts/add 로 요청하는데 POST로 요청하기 때문에 데이터를 저장하고 flash 메시지를 만들어서 index 로 리다이렉트를 할 것이다.





만약 데이터의 값을 입력하는데 우리가 Model의 비즈니스 규칙에 맞지 않게 데이터를 입력했을 경우는 다음과 같이 validate의 체크에 의한 에러가 사용자에게 알려줄 수 있다.



Update

update 처리는 create 처리와 비슷하다. http://cake.saltfactory.local/posts/edit/1 이라는 똑 같은 URL 요청에 GET일 경우는 id = 1 인 Post를 조회해서 업데이트할 수 있는 Form 에 데이터를 넣고 수정된 데이터를 POST로 요청하면 처리하는 edit 메소드를 PostsController에 추가할 것이다.
&lt;?php
class PostsController extends AppController {
public $helpers = array(&#39;Html&#39;, &#39;Form&#39;);

    public function index() {
         $this-&gt;set(&#39;posts&#39;, $this-&gt;Post-&gt;find(&#39;all&#39;));
    }

    public function view($id = null) {
        $this-&gt;Post-&gt;id = $id;
        $this-&gt;set(&#39;post&#39;, $this-&gt;Post-&gt;read());
    }

    public function add() {
            if ($this-&gt;request-&gt;is(&#39;post&#39;)){
                    if ($this-&gt;Post-&gt;save($this-&gt;request-&gt;data)){
                            $this-&gt;Session-&gt;setFlash(&#39;Your post has been saved.&#39;);
                            $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
                    } else {
                           $this-&gt;Session-&gt;setFlash(&#39;Unable to add your post.&#39;);
                    }
            }
    }

    public function edit($id = null) {
            $this-&gt;Post-&gt;id = $id;
            if ($this-&gt;request-&gt;is(&#39;get&#39;)){
                    $this-&gt;request-&gt;data = $this-&gt;Post-&gt;read();
            } else {
                    if ($this-&gt;Post-&gt;save($this-&gt;request-&gt;data)){
                            $this-&gt;Session-&gt;setFlash(&#39;Your post has been updated.&#39;);
                            $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
                    } else {
                            $this-&gt;Session-&gt;setFlash(&#39;Unable to update your post.&#39;);
                    }
            }
    }

}

edit 메소드에서 Post를 찾아서 수정할 수 있도록 /app/View/Posts/eidt.ctp 파일을 생성하고 다음 코드를 추가한다.
&lt;!-- File:/app/View/Posts/edit.ctp --&gt;
&lt;h1&gt;Edit Post&lt;/h1&gt;
&lt;?php
        echo $this-&gt;Form-&gt;create(&#39;Post&#39;, array(&#39;action&#39; =&gt; &#39;edit&#39;));
        echo $this-&gt;Form-&gt;input(&#39;title&#39;);
        echo $this-&gt;Form-&gt;input(&#39;body&#39;, array(&#39;rows&#39;=&gt;3));
        echo $this-&gt;Form-&gt;input(&#39;id&#39;, array(&#39;type&#39;=&gt;&#39;hidden&#39;));
        echo $this-&gt;Form-&gt;end(&#39;Save Post&#39;);

브라우저를 열어서 http://cake.saltfactory.local/posts/edit/1 을 요청해보자. 다음 그림과 같이 id 가 1인 post를 조회해서 수정할 수 있도록 edit.ctp의 Form에  데이터를 넣어서 뷰를 보여준다.



Save Post를 하면 index URL 요청으로 리다이렉트를 하면서 flash를 보여 줄 것이다.



Delete

delete  처리 또한 create나 update 처리와 동일하다. 다만 delete 처리는 http URL 요청이 GET으로 들어올 경우 보안상 문제가 있기 때문에 GET은 예외처리를 할 수 있도록 코드를 추가한다. 다음 코드가 CRUD를 모두 포함한 PostsController.php의 전체 코드이다.
&lt;?php
class PostsController extends AppController {
public $helpers = array(&#39;Html&#39;, &#39;Form&#39;);

    public function index() {
         $this-&gt;set(&#39;posts&#39;, $this-&gt;Post-&gt;find(&#39;all&#39;));
    }

    public function view($id = null) {
        $this-&gt;Post-&gt;id = $id;
        $this-&gt;set(&#39;post&#39;, $this-&gt;Post-&gt;read());
    }

    public function add() {
            if ($this-&gt;request-&gt;is(&#39;post&#39;)){
                    if ($this-&gt;Post-&gt;save($this-&gt;request-&gt;data)){
                            $this-&gt;Session-&gt;setFlash(&#39;Your post has been saved.&#39;);
                            $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
                    } else {
                           $this-&gt;Session-&gt;setFlash(&#39;Unable to add your post.&#39;);
                    }
            }
    }

    public function edit($id = null) {
            $this-&gt;Post-&gt;id = $id;
            if ($this-&gt;request-&gt;is(&#39;get&#39;)){
                    $this-&gt;request-&gt;data = $this-&gt;Post-&gt;read();
            } else {
                    if ($this-&gt;Post-&gt;save($this-&gt;request-&gt;data)){
                            $this-&gt;Session-&gt;setFlash(&#39;Your post has been updated.&#39;);
                            $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
                    } else {
                            $this-&gt;Session-&gt;setFlash(&#39;Unable to update your post.&#39;);
                    }
            }
    }

    public function delete($id){
            if ($this-&gt;request-&gt;is(&#39;get&#39;)){
                    throw new MethodNotAllowedException();
            }
            if ($this-&gt;Post-&gt;delete($id)){
                    $this-&gt;Session-&gt;setFlash(&#39;The post with id: &#39; . $id . &#39; has been deleted.&#39;);
                    $this-&gt;redirect(array(&#39;action&#39; =&gt; &#39;index&#39;));
            }
    }
}

이제 CRUD를 모두 사용할 수 있도록 /app/View/Posts/index.ctp 파일을 다음과 같이 수정하자.
&lt;!-- File: /app/View/Posts/index.ctp --&gt;

&lt;h1&gt;Blog posts&lt;/h1&gt;
&lt;p&gt;&lt;?php echo $this-&gt;Html-&gt;link(&#39;Add Post&#39;, array(&#39;action&#39; =&gt; &#39;add&#39;)); ?&gt;&lt;/p&gt;
&lt;table&gt;
    &lt;tr&gt;
        &lt;th&gt;Id&lt;/th&gt;
        &lt;th&gt;Title&lt;/th&gt;
        &lt;th&gt;Actions&lt;/th&gt;
        &lt;th&gt;Created&lt;/th&gt;
    &lt;/tr&gt;

&lt;!-- Here&#39;s where we loop through our $posts array, printing out post info --&gt;

    &lt;?php foreach ($posts as $post): ?&gt;
    &lt;tr&gt;
        &lt;td&gt;&lt;?php echo $post[&#39;Post&#39;][&#39;id&#39;]; ?&gt;&lt;/td&gt;
        &lt;td&gt;
            &lt;?php echo $this-&gt;Html-&gt;link($post[&#39;Post&#39;][&#39;title&#39;], array(&#39;action&#39; =&gt; &#39;view&#39;, $post[&#39;Post&#39;][&#39;id&#39;])); ?&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;?php echo $this-&gt;Form-&gt;postLink(
                &#39;Delete&#39;,
                array(&#39;action&#39; =&gt; &#39;delete&#39;, $post[&#39;Post&#39;][&#39;id&#39;]),
                array(&#39;confirm&#39; =&gt; &#39;Are you sure?&#39;));
            ?&gt;
            &lt;?php echo $this-&gt;Html-&gt;link(&#39;Edit&#39;, array(&#39;action&#39; =&gt; &#39;edit&#39;, $post[&#39;Post&#39;][&#39;id&#39;])); ?&gt;
        &lt;/td&gt;
        &lt;td&gt;
            &lt;?php echo $post[&#39;Post&#39;][&#39;created&#39;]; ?&gt;
        &lt;/td&gt;
    &lt;/tr&gt;
    &lt;?php endforeach; ?&gt;

&lt;/table&gt;

다시 http://cake.saltfactory.local/posts 를 브라우저에서 열어보자. 이제 제법 블로그 서비스를 할 수 있는 모양을 갖추었다.



Routes 설정

/app/Config/routes.php 파일은 이 어플리케이션으로 들어오는 모든 URL요청을 특정 컨트롤러에게 매핑해주는 역활을 하는 파일이다.
우리는 http://cake.saltfactory.local/posts 로 PostsController에 URL 요청을 보내는 것을 만들었다. 만약 우리가 블로그 어플리케이션을 가지고 웹 서비스를 한다고 가정할 때 http://cake.saltfactory.local 이라는 디폴트 URL로 들어왔을때 블로그의 목록을 보여주는 http://cake.saltfactory.local/posts/index 의 요청과 동일하게 하고 싶을 것이다. 이 때 우리는 routes.php를 설정해서 이 요구사항을 해결할 수 있다. 다음과 같이 / 디폴트 URL 요청이 들어오면 controller를 posts 컨트롤러와 매핑하고 메소드는 action 이 index 메소드와 매핑되도록 설정한다.
&lt;?php
/**
 * Routes configuration
 *
 * In this file, you set up routes to your controllers and their actions.
 * Routes are very important mechanism that allows you to freely connect
 * different urls to chosen controllers and their actions (functions).
 *
 * PHP 5
 *
 * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)
 * Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)
 *
 * Licensed under The MIT License
 * Redistributions of files must retain the above copyright notice.
 *
 * @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)
 * @link          http://cakephp.org CakePHP(tm) Project
 * @package       app.Config
 * @since         CakePHP(tm) v 0.2.9
 * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)
 */
/**
 * Here, we are connecting &#39;/&#39; (base path) to controller called &#39;Pages&#39;,
 * its action called &#39;display&#39;, and we pass a param to select the view file
 * to use (in this case, /app/View/Pages/home.ctp)...
 */
/*         Router::connect(&#39;/&#39;, array(&#39;controller&#39; =&gt; &#39;pages&#39;, &#39;action&#39; =&gt; &#39;display&#39;, &#39;home&#39;)); */
        Router::connect(&#39;/&#39;, array(&#39;controller&#39; =&gt; &#39;posts&#39;, &#39;action&#39; =&gt; &#39;index&#39;));
/**
 * ...and connect the rest of &#39;Pages&#39; controller&#39;s urls.
 */
        Router::connect(&#39;/pages/*&#39;, array(&#39;controller&#39; =&gt; &#39;pages&#39;, &#39;action&#39; =&gt; &#39;display&#39;));


/**
 * Load all plugin routes.  See the CakePlugin documentation on
 * how to customize the loading of plugin routes.
 */
        CakePlugin::routes();

/**
 * Load the CakePHP default routes. Remove this if you do not want to use
 * the built-in default routes.
 */
        require CAKE . &#39;Config&#39; . DS . &#39;routes.php&#39;;

결론

아마 앞의 포스팅과 이 포스팅을 따라서 해봤을 때, 두가지 사실을 깨닫게 될 것이다. 첫번째로, MVC 기반의 웹 서비스 개발을 CakePHP를 사용하면 매우 간단하게 구축할수 있다는 것이다. 특히 ActiveRecord와 유사한 Model 메소드들은 Query를 직접사용하지 않고도 데이터를 저장하고 조회하는 기능을 처리할 수 있기 때문에 이후에 마이그레이션도 편리할 것이고 기대된다. 두번째는, CakePHP가 놀랄만큼 Ruby on Rails와 닮았다는 것을 느끼게 될 것이다. 파일의 구조 위미며, 라우터 설정, 모델 유효성 검사까지 모두 RoR과 매우 닮은 형태를 하고 있다. 하지만 CakePHP의 URL 요청은 RoR의 요청과 조금 다르다. URL 패턴이며 RESTful 형태의 요청이 다르다는 것을 알 것이다. 하지만 CakePHP는 MVC 기반의 웹 어플리케이션을 매우 쉽게 구조화해서 만들 수 있다는 것을 알 수 있다. 앞으로 RoR과 비교하면서 더 많은 테스트를 진행할 것이다. 다음은 RoR의 Scaffolding과 같은 기능을 CakePHP에서 어떻게 구현했는지에 대해서 살펴볼 예정이다.

참고


http://book.cakephp.org/2.0/en/getting-started.html#blog-tutorial


연구원 소개


작성자 : 송성광 개발 연구원
블로그 : http://blog.saltfactory.net
이메일 : saltfactory@gmail.com
트위터 : @saltfactory
페이스북 : https://facebook.com/salthub
연구소 : 하이브레인넷 부설연구소
연구실 : 창원대학교 데이터베이스 연구실

 -->


    
    
    <meta content="http://blog.saltfactory.net/php/createing-mvc-based-application-in-cakephp.html" property="og:url">
    
    
    <meta content="2012-09-04T00:00:00+09:00" property="article:published_time">
    <meta content="http://blog.saltfactory.net/about/" property="article:author">
    
    <!-- 
    <meta content="/img/logo-high-resolution.png" property="og:image">
     -->
    
    
    <meta content="php" property="article:section">
    
    
    
    
    <meta content="cakephp" property="article:tag">
    
    <meta content="php" property="article:tag">
    
    <meta content="mvc" property="article:tag">
    
    <meta content="crud" property="article:tag">
    
    



    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="http://blog.saltfactory.net/php/createing-mvc-based-application-in-cakephp.html">
    <link rel="meta" type="application/rdf+xml" title="FOAF" href="/assets/foaf.rdf" />

    

    
      <script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-8647285-2', 'auto');
ga('send', 'pageview');
</script>

    
</head>


  <body>
    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">saltfactory's blog</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
        viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
        <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
        h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
        <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
        h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
        <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
        c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
      </svg>
    </a>
    <div class="trigger">
      <!-- <a class="page-link" href="http://saltfactory.net">saltfactory.net</a> -->
      <!--
      
      <a class="page-link" href="/about/">About</a>
      
      
      
      
      
      
      
      <a class="page-link" href="/categories/">Categories</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a class="page-link" href="/guestbook/">GuestBook</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      <a class="page-link" href="/categories/ruby/">Articles by category: ruby</a>
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      
      -->


      <a class="page-link" href="/about/">About</a>
      <a class="page-link" href="/categories/">Categories</a>
      <a class="page-link" href="/guestbook/">GuestBook</a>
      <a class="page-link" href="http://saltfactory.net">saltfactory.net</a>
    </div>

    </nav>
    <script>
(function() {
  var cx = '014516175331458470005:ze8dwrrwnac';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
  '//cse.google.com/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
</script>
<gcse:search></gcse:search>

</div>

</header>



    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">CakePHP를 이용하여 MVC 기반 웹 서비스 CRUD 개발하기</h1>
    <p class="post-meta">Sep 4, 2012</p>
  </header>

  <article class="post-content">
    <h2 id="서론">서론</h2>

<p>이번 포스팅은 이전 포스팅을 기반으로 CRUD ( Create, Retrieve, Update, Delete)를 기능을 추가하는 예제를 테스트한다. 이번 포스팅도 앞의 포스팅과 동일하게 CakePHP document를 기반으로 실험하도록 한다.</p>

<p>&lt;--more--&gt;</p>

<p>웹 서비스에서 CRUD는 특별한 일이 없는 이상 URL 요청으로 처리가 된다. (예외는 API나 소켓 요청인데 이 또한 URL 기반으로 되어져 있다.) 요즘은 이러한 URL 요청대신에 RESTful 서비스라고 말을 하기도 하지만 이말을 쉽게 말하면 URL 과 헤더타입에 따라서 처리를 해주는 서비스라고 생각할 수 있다. 일축하고, 우리는 이러한 CRUD 요청을 처리하기 위해서 이것을 담당하는 것이 Controller라고 앞의 포스팅에서 다루었다. 앞의 포스팅에서는 Post의 전체를 가져와서 리스팅해주는 index 메소드를 하나 생성해 두었는데, 그 아래 CRUD를 처리하기 위해서 view, add, edit, update, delete 메소드를 추가할 것이다.</p>

<h2 id="retrieve">Retrieve</h2>

<p>앞에서 만들어둔 index 메소드는 블로그의 글을 리스팅하는데 우리는 블로그 제목을 클릭하면 해당되는 글의 상세 정보를 보기 위한 view 메소드를 추가할 것이다.</p>

<p>/app/Controller/PostController.php 파일을 열어서 다음과 같이 코드를 수정한다. 제목을 누르면 해당하는 글의 id 를 가지고 view 를 처리할 하는 View 파일을 호출할 것인데 이 때 Model 중에 id에 해당하는 데이터를 찾아서 View 파일에 post 라는 이름으로 저장하여 넘겨주게 된다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
<span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>컨트롤러 작업을 마쳤으면 /app/View/Posts/view.ctp 파일을 추가하고 다음과 같이 코드를 저장한다. PostController의 view 메소드에서 id 기반으로 가져온 post의 값 중에서 title, created, body를 출력시키는 코드이다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&lt;!-- File: /app/View/Posts/view.ctp --&gt;</span>

<span class="x">&lt;h1&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&lt;/h1&gt;</span>

<span class="x">&lt;p&gt;&lt;small&gt;Created: </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/small&gt;&lt;/p&gt;</span>

<span class="x">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nx">h</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;body&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
</code></pre></div>
<p>이제 브라우저에서 바르게 동작하는지 확인해보자.
<a href="http://cake.saltfactory.local/posts">http://cake.saltfactory.local/posts</a></p>

<p><img src="http://cfile1.uf.tistory.com/image/14180F395045E9CF16E0F3" alt=""></p>

<p>이 목록 중에서 1번째 &quot;The title&quot; 이라는 글을 클릭해보자. 그러면 <a href="http://cake.saltfactory.local/posts/view/1">http://cake.saltfactory.local/posts/view/1</a> URL이 요청될 것이다. 이 URL 요청은 PostsController의 view 메소드가 id 라는 파라미터와 함께 요청을 받아서 처리하게 된다. 이 때 Model Post에서 id 값이 1 인 post를 조회해서 처리하기 때문에 trace를 살펴보면 query 의 where 조건에 Post.id=1 인 쿼리가 실행 된 것을 확인할 수 있다.</p>

<p><img src="http://cfile7.uf.tistory.com/image/1810FC375045E9B3201978" alt=""></p>

<h2 id="create">Create</h2>

<p>create를 처리하기 위해서는 두 가지 요청이 필요하다 하나는 데이터를 입력시키는 뷰를 보여주는 Form을 가진 URL 요청이고 하나는 데이터를 받아서 데이터베이스에 저장하는 URL 요청이다. 이 두 가지의 요청을 처리하기 위해서 우리는 동일한 URL 요청에 HTTP의 헤더의 method가 GET 일 경우와 Post 인 경우에 따라서 요청을 처리하는 것을 구분할 수 있도록 구현할 것이다.  우리는 add 라는 메소드를 추가하는데 $this-&gt;request-&gt;is(&#39;post&#39;) 라는 것으로 이 컨트롤러의 요청이 POST 인지를 비교해서 POST일 경우는 Post-&gt;save()를 통해서 request로 넘어온 data를 저장한다. 그리고 컨트롤러가 관장하는 Session에 flash 메세지를 저장해서 index URL 요청으로 redirect 시키도록 했다. flash는 데이터가 저장되고 난 다음 view에 저장이 성공적으로 되었다고 표시해주기 위한 영역이다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
<span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">)){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)){</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Your post has been saved.&#39;</span><span class="p">);</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                           <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Unable to add your post.&#39;</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>그렇지 않고 GET 요청이 들어오면 단순하게 add를 할 수 있는 뷰 파일을 요청할 것이다. /app/View/Posts/add.ctp 파일을 추가하여 다음 코드를 추가한다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&lt;!-- File: /app/View/Posts/add.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Add Post&lt;/h1&gt;</span>
<span class="cp">&lt;?php</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;3&#39;</span><span class="p">));</span>
<span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">end</span><span class="p">(</span><span class="s1">&#39;Save Post&#39;</span><span class="p">);</span>
<span class="cp">?&gt;</span><span class="x"></span>
</code></pre></div>
<p>MVC 기반의 어플리케이션에서 Model을 만들어서 사용하는 이유가 테이블의 매핑을 단순히 하기 위해서만 사용하는 것은 아니다. Model은 데이터의 저장되는 내용 뿐만 아니라 데이터의 관계, 그리고 속성 비즈니스 규칙까지 정의할 수 있다. Model의 관계 정의에 대해서는 이후에 설명하도록 하고 지금은 Model의 속성 validation 을 하는 것을 살펴보겠다. 쉽게 말하면 Post라는 Model이 데이터베이스에 저장되거나 어플리케이션에서 사용될 때 속성의 값의 형태가 어떤지 체크를 하는 것이다. Post는 반드시 제목과 내용이 있어야 한다고 비즈니스 규칙을 정했다고 하자. 이를 Model에 반영할 수 있는데 다음과 같은 코드로 반영할 수 있다.
/app/Model/Post.php 를 다음과 같이 수정한다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">Post</span> <span class="k">extends</span> <span class="nx">AppModel</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$validate</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span>
        <span class="s1">&#39;title&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;rule&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;notEmpty&#39;</span>
        <span class="p">),</span>
        <span class="s1">&#39;body&#39;</span> <span class="o">=&gt;</span> <span class="k">array</span><span class="p">(</span>
            <span class="s1">&#39;rule&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;notEmpty&#39;</span>
        <span class="p">)</span>
    <span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<p>이렇게 Model의 validate로 title과 body의 비즈니스 규칙을 notEmpty라고 정의하게 되면 이후에 반드시 이 두가지 속성에는 빈 값이 들어가면 안된다는 체크를 실시하게 된다.</p>

<p>브라우저에서 <a href="http://cake.saltfactory.local/posts/add">http://cake.saltfactory.local/posts/add</a> 라고 요청해보자. 단순하게 브라우저에 요청했으니 GET으로 요청하게 될 것이기 때문에 다음과 같이 PostsController에서 GET의 요청을 처리하는 뷰를 볼 수 있다.</p>

<p><img src="http://cfile8.uf.tistory.com/image/132860395045ECA212166C" alt=""></p>

<p>데이터를 저장하고 Save Post 버튼을 누르면 동일한 <a href="http://cake.saltfactory.local/posts/add">http://cake.saltfactory.local/posts/add</a> 로 요청하는데 POST로 요청하기 때문에 데이터를 저장하고 flash 메시지를 만들어서 index 로 리다이렉트를 할 것이다.</p>

<p><img src="http://cfile2.uf.tistory.com/image/161D023C5045ED3C055B17" alt=""></p>

<p><img src="http://cfile22.uf.tistory.com/image/127042355045ED4A24285F" alt=""></p>

<p>만약 데이터의 값을 입력하는데 우리가 Model의 비즈니스 규칙에 맞지 않게 데이터를 입력했을 경우는 다음과 같이 validate의 체크에 의한 에러가 사용자에게 알려줄 수 있다.</p>

<p><img src="http://cfile29.uf.tistory.com/image/151487345045FD6E33F08E" alt=""></p>

<h2 id="update">Update</h2>

<p>update 처리는 create 처리와 비슷하다. <a href="http://cake.saltfactory.local/posts/edit/1">http://cake.saltfactory.local/posts/edit/1</a> 이라는 똑 같은 URL 요청에 GET일 경우는 id = 1 인 Post를 조회해서 업데이트할 수 있는 Form 에 데이터를 넣고 수정된 데이터를 POST로 요청하면 처리하는 edit 메소드를 PostsController에 추가할 것이다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
<span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">)){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)){</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Your post has been saved.&#39;</span><span class="p">);</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                           <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Unable to add your post.&#39;</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)){</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)){</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Your post has been updated.&#39;</span><span class="p">);</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Unable to update your post.&#39;</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div>
<p>edit 메소드에서 Post를 찾아서 수정할 수 있도록 /app/View/Posts/eidt.ctp 파일을 생성하고 다음 코드를 추가한다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&lt;!-- File:/app/View/Posts/edit.ctp --&gt;</span>
<span class="x">&lt;h1&gt;Edit Post&lt;/h1&gt;</span>
<span class="cp">&lt;?php</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">create</span><span class="p">(</span><span class="s1">&#39;Post&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;edit&#39;</span><span class="p">));</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">);</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;body&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;rows&#39;</span><span class="o">=&gt;</span><span class="mi">3</span><span class="p">));</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">input</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="o">=&gt;</span><span class="s1">&#39;hidden&#39;</span><span class="p">));</span>
        <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">end</span><span class="p">(</span><span class="s1">&#39;Save Post&#39;</span><span class="p">);</span>
</code></pre></div>
<p>브라우저를 열어서 <a href="http://cake.saltfactory.local/posts/edit/1">http://cake.saltfactory.local/posts/edit/1</a> 을 요청해보자. 다음 그림과 같이 id 가 1인 post를 조회해서 수정할 수 있도록 edit.ctp의 Form에  데이터를 넣어서 뷰를 보여준다.</p>

<p><img src="http://cfile1.uf.tistory.com/image/156449505045F9BD0521AF" alt=""></p>

<p>Save Post를 하면 index URL 요청으로 리다이렉트를 하면서 flash를 보여 줄 것이다.</p>

<p><img src="http://cfile28.uf.tistory.com/image/155B343E5045FA212408B6" alt=""></p>

<h2 id="delete">Delete</h2>

<p>delete  처리 또한 create나 update 처리와 동일하다. 다만 delete 처리는 http URL 요청이 GET으로 들어올 경우 보안상 문제가 있기 때문에 GET은 예외처리를 할 수 있도록 코드를 추가한다. 다음 코드가 CRUD를 모두 포함한 PostsController.php의 전체 코드이다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="k">class</span> <span class="nc">PostsController</span> <span class="k">extends</span> <span class="nx">AppController</span> <span class="p">{</span>
<span class="k">public</span> <span class="nv">$helpers</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;Html&#39;</span><span class="p">,</span> <span class="s1">&#39;Form&#39;</span><span class="p">);</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">index</span><span class="p">()</span> <span class="p">{</span>
         <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">find</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">view</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">set</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">,</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">());</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">add</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">)){</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)){</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Your post has been saved.&#39;</span><span class="p">);</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                           <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Unable to add your post.&#39;</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">edit</span><span class="p">(</span><span class="nv">$id</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">id</span> <span class="o">=</span> <span class="nv">$id</span><span class="p">;</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)){</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">read</span><span class="p">();</span>
            <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">data</span><span class="p">)){</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Your post has been updated.&#39;</span><span class="p">);</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
                    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
                            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;Unable to update your post.&#39;</span><span class="p">);</span>
                    <span class="p">}</span>
            <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">){</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">request</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;get&#39;</span><span class="p">)){</span>
                    <span class="k">throw</span> <span class="k">new</span> <span class="nx">MethodNotAllowedException</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Post</span><span class="o">-&gt;</span><span class="na">delete</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Session</span><span class="o">-&gt;</span><span class="na">setFlash</span><span class="p">(</span><span class="s1">&#39;The post with id: &#39;</span> <span class="o">.</span> <span class="nv">$id</span> <span class="o">.</span> <span class="s1">&#39; has been deleted.&#39;</span><span class="p">);</span>
                    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">redirect</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
            <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>이제 CRUD를 모두 사용할 수 있도록 /app/View/Posts/index.ctp 파일을 다음과 같이 수정하자.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="x">&lt;!-- File: /app/View/Posts/index.ctp --&gt;</span>

<span class="x">&lt;h1&gt;Blog posts&lt;/h1&gt;</span>
<span class="x">&lt;p&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="s1">&#39;Add Post&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;add&#39;</span><span class="p">));</span> <span class="cp">?&gt;</span><span class="x">&lt;/p&gt;</span>
<span class="x">&lt;table&gt;</span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;th&gt;Id&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Title&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Actions&lt;/th&gt;</span>
<span class="x">        &lt;th&gt;Created&lt;/th&gt;</span>
<span class="x">    &lt;/tr&gt;</span>

<span class="x">&lt;!-- Here&#39;s where we loop through our $posts array, printing out post info --&gt;</span>

<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">foreach</span> <span class="p">(</span><span class="nv">$posts</span> <span class="k">as</span> <span class="nv">$post</span><span class="p">)</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;tr&gt;</span>
<span class="x">        &lt;td&gt;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x">&lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;title&#39;</span><span class="p">],</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;view&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]));</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Form</span><span class="o">-&gt;</span><span class="na">postLink</span><span class="p">(</span>
                <span class="s1">&#39;Delete&#39;</span><span class="p">,</span>
                <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;delete&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]),</span>
                <span class="k">array</span><span class="p">(</span><span class="s1">&#39;confirm&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;Are you sure?&#39;</span><span class="p">));</span>
            <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">Html</span><span class="o">-&gt;</span><span class="na">link</span><span class="p">(</span><span class="s1">&#39;Edit&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;edit&#39;</span><span class="p">,</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]));</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">        &lt;td&gt;</span>
<span class="x">            </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$post</span><span class="p">[</span><span class="s1">&#39;Post&#39;</span><span class="p">][</span><span class="s1">&#39;created&#39;</span><span class="p">];</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">        &lt;/td&gt;</span>
<span class="x">    &lt;/tr&gt;</span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="k">endforeach</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>

<span class="x">&lt;/table&gt;</span>
</code></pre></div>
<p>다시 <a href="http://cake.saltfactory.local/posts">http://cake.saltfactory.local/posts</a> 를 브라우저에서 열어보자. 이제 제법 블로그 서비스를 할 수 있는 모양을 갖추었다.</p>

<p><img src="http://cfile10.uf.tistory.com/image/176A31435045FB9524D9D8" alt=""></p>

<h2 id="routes-설정">Routes 설정</h2>

<p>/app/Config/routes.php 파일은 이 어플리케이션으로 들어오는 모든 URL요청을 특정 컨트롤러에게 매핑해주는 역활을 하는 파일이다.
우리는 <a href="http://cake.saltfactory.local/posts">http://cake.saltfactory.local/posts</a> 로 PostsController에 URL 요청을 보내는 것을 만들었다. 만약 우리가 블로그 어플리케이션을 가지고 웹 서비스를 한다고 가정할 때 <a href="http://cake.saltfactory.local">http://cake.saltfactory.local</a> 이라는 디폴트 URL로 들어왔을때 블로그의 목록을 보여주는 <a href="http://cake.saltfactory.local/posts/index">http://cake.saltfactory.local/posts/index</a> 의 요청과 동일하게 하고 싶을 것이다. 이 때 우리는 routes.php를 설정해서 이 요구사항을 해결할 수 있다. 다음과 같이 / 디폴트 URL 요청이 들어오면 controller를 posts 컨트롤러와 매핑하고 메소드는 action 이 index 메소드와 매핑되도록 설정한다.</p>
<div class="highlight"><pre><code class="language-php" data-lang="php"><span class="cp">&lt;?php</span>
<span class="sd">/**</span>
<span class="sd"> * Routes configuration</span>
<span class="sd"> *</span>
<span class="sd"> * In this file, you set up routes to your controllers and their actions.</span>
<span class="sd"> * Routes are very important mechanism that allows you to freely connect</span>
<span class="sd"> * different urls to chosen controllers and their actions (functions).</span>
<span class="sd"> *</span>
<span class="sd"> * PHP 5</span>
<span class="sd"> *</span>
<span class="sd"> * CakePHP(tm) : Rapid Development Framework (http://cakephp.org)</span>
<span class="sd"> * Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)</span>
<span class="sd"> *</span>
<span class="sd"> * Licensed under The MIT License</span>
<span class="sd"> * Redistributions of files must retain the above copyright notice.</span>
<span class="sd"> *</span>
<span class="sd"> * @copyright     Copyright 2005-2012, Cake Software Foundation, Inc. (http://cakefoundation.org)</span>
<span class="sd"> * @link          http://cakephp.org CakePHP(tm) Project</span>
<span class="sd"> * @package       app.Config</span>
<span class="sd"> * @since         CakePHP(tm) v 0.2.9</span>
<span class="sd"> * @license       MIT License (http://www.opensource.org/licenses/mit-license.php)</span>
<span class="sd"> */</span>
<span class="sd">/**</span>
<span class="sd"> * Here, we are connecting &#39;/&#39; (base path) to controller called &#39;Pages&#39;,</span>
<span class="sd"> * its action called &#39;display&#39;, and we pass a param to select the view file</span>
<span class="sd"> * to use (in this case, /app/View/Pages/home.ctp)...</span>
<span class="sd"> */</span>
<span class="cm">/*         Router::connect(&#39;/&#39;, array(&#39;controller&#39; =&gt; &#39;pages&#39;, &#39;action&#39; =&gt; &#39;display&#39;, &#39;home&#39;)); */</span>
        <span class="nx">Router</span><span class="o">::</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;posts&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;index&#39;</span><span class="p">));</span>
<span class="sd">/**</span>
<span class="sd"> * ...and connect the rest of &#39;Pages&#39; controller&#39;s urls.</span>
<span class="sd"> */</span>
        <span class="nx">Router</span><span class="o">::</span><span class="na">connect</span><span class="p">(</span><span class="s1">&#39;/pages/*&#39;</span><span class="p">,</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;controller&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;pages&#39;</span><span class="p">,</span> <span class="s1">&#39;action&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;display&#39;</span><span class="p">));</span>


<span class="sd">/**</span>
<span class="sd"> * Load all plugin routes.  See the CakePlugin documentation on</span>
<span class="sd"> * how to customize the loading of plugin routes.</span>
<span class="sd"> */</span>
        <span class="nx">CakePlugin</span><span class="o">::</span><span class="na">routes</span><span class="p">();</span>

<span class="sd">/**</span>
<span class="sd"> * Load the CakePHP default routes. Remove this if you do not want to use</span>
<span class="sd"> * the built-in default routes.</span>
<span class="sd"> */</span>
        <span class="k">require</span> <span class="nx">CAKE</span> <span class="o">.</span> <span class="s1">&#39;Config&#39;</span> <span class="o">.</span> <span class="nx">DS</span> <span class="o">.</span> <span class="s1">&#39;routes.php&#39;</span><span class="p">;</span>
</code></pre></div>
<h2 id="결론">결론</h2>

<p>아마 앞의 포스팅과 이 포스팅을 따라서 해봤을 때, 두가지 사실을 깨닫게 될 것이다. 첫번째로, MVC 기반의 웹 서비스 개발을 CakePHP를 사용하면 매우 간단하게 구축할수 있다는 것이다. 특히 ActiveRecord와 유사한 Model 메소드들은 Query를 직접사용하지 않고도 데이터를 저장하고 조회하는 기능을 처리할 수 있기 때문에 이후에 마이그레이션도 편리할 것이고 기대된다. 두번째는, CakePHP가 놀랄만큼 Ruby on Rails와 닮았다는 것을 느끼게 될 것이다. 파일의 구조 위미며, 라우터 설정, 모델 유효성 검사까지 모두 RoR과 매우 닮은 형태를 하고 있다. 하지만 CakePHP의 URL 요청은 RoR의 요청과 조금 다르다. URL 패턴이며 RESTful 형태의 요청이 다르다는 것을 알 것이다. 하지만 CakePHP는 MVC 기반의 웹 어플리케이션을 매우 쉽게 구조화해서 만들 수 있다는 것을 알 수 있다. 앞으로 RoR과 비교하면서 더 많은 테스트를 진행할 것이다. 다음은 RoR의 Scaffolding과 같은 기능을 CakePHP에서 어떻게 구현했는지에 대해서 살펴볼 예정이다.</p>

<h2 id="참고">참고</h2>

<ol>
<li><a href="http://book.cakephp.org/2.0/en/getting-started.html#blog-tutorial">http://book.cakephp.org/2.0/en/getting-started.html#blog-tutorial</a></li>
</ol>

<h2 id="연구원-소개">연구원 소개</h2>

<ul>
<li>작성자 : <a href="http://about.me/saltfactory">송성광</a> 개발 연구원</li>
<li>블로그 : <a href="http://blog.saltfactory.net">http://blog.saltfactory.net</a></li>
<li>이메일 : <a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
<li>트위터 : <a href="https://twitter.com/saltfactory">@saltfactory</a></li>
<li>페이스북 : <a href="https://facebook.com/salthub">https://facebook.com/salthub</a></li>
<li>연구소 : <a href="http://www.hibrain.net">하이브레인넷</a> 부설연구소</li>
<li>연구실 : <a href="http://dblab.changwon.ac.kr">창원대학교 데이터베이스 연구실</a></li>
</ul>

  </article>

  <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_sharing_toolbox"></div>
<!-- Go to www.addthis.com/dashboard to customize your tools -->
<script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-55706d7f707f75ff" async="async"></script>



<!-- <div class='shareaholic-canvas' data-app='share_buttons' data-app-id=''></div>
<script type="text/javascript">
//<![CDATA[
  (function() {
    var shr = document.createElement('script');
    shr.setAttribute('data-cfasync', 'false');
    shr.src = '//dsms0mj1bbhn4.cloudfront.net/assets/pub/shareaholic.js';
    shr.type = 'text/javascript'; shr.async = 'true';
    shr.onload = shr.onreadystatechange = function() {
      var rs = this.readyState;
      if (rs && rs != 'complete' && rs != 'loaded') return;
      var site_id = 'fd3b2a079d78a86b57bffbfc4e3ee42d';
      try { Shareaholic.init(site_id); } catch (e) {}
    };
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(shr, s);
  })();
//]]>
</script> -->

  
  <div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    
      var disqus_shortname = 'saltfactoryblog';
    
    // 
    
     var disqus_identifier = 'http://blog.saltfactory.net/181'; 
    


    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  



</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">saltfactory's blog</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <!-- <li>saltfactory's blog</li> -->
          <li><img class="profile" src="/assets/images/profile.png"/></li>
          <li><a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
          <li><a href="http://saltfactory.net">saltfactory.net</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/saltfactory">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">saltfactory</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://twitter.com/saltfactory">
              <span class="icon  icon--twitter">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
                  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
                </svg>
              </span>

              <span class="username">@saltfactory</span>
            </a>
          </li>
          

          
          <li>
            <a href="https://facebook.com/salthub">
              <span class="icon icon--facebook">
                <!-- <svg class="facebook-icon-svg" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.112290344,30 C0.112290344,13.4314567 13.3426506,0 29.663129,0 C45.9836073,0 59.2139676,13.4314567 59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C13.3426506,60 0.112290344,46.5685433 0.112290344,30 Z M0.112290344,30" fill="#C2C2C2" sketch:type="MSShapeGroup"></path>
	<path d="M32.1341457,46.3196729 L32.1341457,29.9980891 L36.5657565,29.9980891 L37.1530406,24.3735809 L32.1341457,24.3735809 L32.141675,21.5584604 C32.141675,20.091502 32.2787707,19.3054722 34.351206,19.3054722 L37.1216686,19.3054722 L37.1216686,13.6803271 L32.6894304,13.6803271 C27.3655995,13.6803271 25.491749,16.4088187 25.491749,20.9972835 L25.491749,24.3742179 L22.1732173,24.3742179 L22.1732173,29.998726 L25.491749,29.998726 L25.491749,46.3196729 L32.1341457,46.3196729 Z M32.1341457,46.3196729" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
</svg>
 -->
                <svg viewBox="0 0 16 28">
                  <path id="logo" d="M14.984 0.187v4.125h-2.453q-1.344 0-1.813 0.562t-0.469 1.687v2.953h4.578l-0.609 4.625h-3.969v11.859h-4.781v-11.859h-3.984v-4.625h3.984v-3.406q0-2.906 1.625-4.508t4.328-1.602q2.297 0 3.563 0.187z"></path>
                </svg>
              </span>
              <span class="username">salthub</span>
            </a>
          </li>

        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text"></p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
