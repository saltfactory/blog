<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>node-gallery3을 이용하여 Gallery3 REST API 사용하기</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="">
    <link rel="canonical" href="/series/node/introduce-node-gallery3.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/series/assets/css/main.css">
    <!-- <link rel='stylesheet' type='text/css' href='/assets/css/main.css' /> -->

    
</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/series/">saltfactory's series</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/">saltfactory.net</a>
        <a class="page-link" href="/guestbook">Guestbook</a>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>node-gallery3을 이용하여 Gallery3 REST API 사용하기</h1>
    <p class="meta">Mar 10, 2015</p>
  </header>

  <article class="post-content">
  <h2 id="서론">서론</h2>

<p>Gallery3은 이미지 호스팅 서비스를 개발할 때 가장 많이 사용하고 있는 오픈소스 Photo Album Organizer이다. Gallery3은 REST API를 지원하기 때문에 서버에 Gallery3을 운영하고 있다면 REST API를 사용하여 다양한 어플리케이션을 개발 할 수 있다. Gallery3의 API를 사용하기 위해 node.js 모듈 node-gallery3을 만들었다. node-gallery3을 이용하여 Gallery3 REST API를 사용하는 방법에 대해서 소개한다.</p>

<!--more-->

<h2 id="gallery-소개">Gallery 소개</h2>

<p><a href="http://galleryproject.org/">Gallery</a>는 웹에서 사진을 관리하기 위한 오픈소스 Photo Album Organizer 이다. <a href="https://instagram.com/">Instagram</a>이나 <a href="https://story.kakao.com">KakaoStory</a>등 SNS가 유행하면서 지금은 예전처럼 Photo Gallery 사이트를 많이 볼수 없지만 아직 전문적인이고 체계적인 이미지 서비스를 위해 Photo Gallery를 도입하여 사용하는 곳이 많다.</p>

<p><a href="https://500px.com/">500px</a>과 같은 사진 커뮤니티를 만들기 위해서 어렵게 프로그램을 만들지 않고 Gallery을 사용하여 이와 같은 서비스를 쉽게 만들 수 있다. Gallery은 오래전부터 인기있는 <a href="http://php.net">PHP</a> 오픈소스 프로젝트 중에 하나이다. Gallery 프로젝트는 Gallery1, Gallery2 그리고 Gallery3 버전으로 개발이 진행되고 있고 가장 최근의 프로젝트가 Gallery3 이다.</p>

<h2 id="gallery3-rest">Gallery3 REST</h2>

<p>Gallery3는 앨범과 사진정보에 관한 <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful</a> 서비스 모듈을 추가 하였다. <a href="http://codex.galleryproject.org/Gallery3:API:RESTl">Gallery3:API:REST</a> 페이지에서 Gallery3의 REST 서비스에 관한 자세한 설명을 참조할 수 있다.</p>

<p>Gallery3의 REST 서비스를 요청하기 위해서 http 요청을 할 때 header에 <strong>X-Gallery-Request-Key</strong>와 <strong>X-Gallery-Request-Method</strong>를 반드시 추가해서 사용해야한다.</p>

<h3 id="x-gallery-request-key">X-Gallery-Request-Key</h3>

<p>Gallery의 REST 서비스를 요청하는 header에 request key를 반드시 필요하는데 이 값은 Login 요청으로 획득할 수 있다. <a href="http://codex.galleryproject.org/Gallery3:API:RESTl">Gallery3:API:REST</a> 페이지에서 <strong>X-Gallery-Request-Key</strong>를 획득하기 위한 요청 예제를 찾을 수 있다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">POST /gallery3/index.php/rest HTTP/1.1
Host: example.com
X-Gallery-Request-Method: post
Content-Type: application/x-www-form-urlencoded
Content-Length: 25
user=admin&amp;password=12345
</code></pre></div>
<p>위의 요청의 결과는 아래와 같이 <strong>X-Gallery-Request-Key</strong>의 값을 문자열로 응답을 받을 수 있다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> HTTP/1.1 200 OK
 Content-Length: 34
 Content-Type: application/json
 &quot;1114d4023d89b15ce10a20ba4333eff7&quot;
</code></pre></div>
<p>이렇게 발급 받은 <strong>X-Gallery-Request-Key</strong>를 이용하여 Gallery REST API를 요청할 수 있다. 예를 들어 <strong>item 1</strong>에 관한 <strong>GET</strong> 요청을 한다면 다음과 같이 발급받은 X-Gallery-Request-Key를 이용하여 요청할 수 있다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">GET /gallery3/index.php/rest/item/1 HTTP/1.1
Host: example.com
X-Gallery-Request-Method: get
X-Gallery-Request-Key: 1114d4023d89b15ce10a20ba4333eff7
</code></pre></div>
<h3 id="x-gallery-request-method">X-Gallery-Request-Method</h3>

<p>Gallery REST 서비스도 다른 <a href="http://en.wikipedia.org/wiki/Representational_state_transfer">RESTful</a>와 동일하게 <strong>Method</strong>를 이용하여 동일한 URL에 다른 의미의 요청을 가능하게 할 수 있다. Method의 값은 <strong>GET</strong>, <strong>POST</strong>, <strong>UPDATE</strong> 그리고 <strong>DELETE</strong>로 지정 할 수 있다.</p>

<h3 id="response-format">Response format</h3>

<p>Gallery3의 REST의 요청의 결과는 <strong>JSON</strong>과 <strong>HTML</strong>으로 받을 수 있는데 <code>output</code>이라는 파라미터를 추가후 <code>output=json</code>또는 <code>output=html</code>으로 지정할 수 있다. 기본적으로는 <code>json</code>으로 지정된다. 다음은 응답받은 JSON 문자열이다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> GET /gallery3/index.php/rest/item/1
 ...
 HTTP/1.1 200 OK
 Content-Length: 1200
 Content-Type: application/json
 {&quot;url&quot;:&quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item\/1&quot;,&quot;entity&quot;:{&quot;id&quot;:&quot;1&quot;,&quot;captured&quot;:
 null,&quot;created&quot;:&quot;1270793819&quot;,&quot;description&quot;:&quot;&quot;,&quot;height&quot;:null,&quot;level&quot;:&quot;1&quot;,&quot;mime_type&quot;:null,
 &quot;name&quot;:null,&quot;owner_id&quot;:&quot;2&quot;,&quot;rand_key&quot;:null,&quot;resize_height&quot;:null,&quot;resize_width&quot;:null,&quot;slug&quot;:null,
 &quot;sort_column&quot;:&quot;weight&quot;,&quot;sort_order&quot;:&quot;ASC&quot;,&quot;thumb_height&quot;:&quot;103&quot;,&quot;thumb_width&quot;:&quot;164&quot;,&quot;title&quot;:
 &quot;Gallery&quot;,&quot;type&quot;:&quot;album&quot;,&quot;updated&quot;:&quot;1270958456&quot;,&quot;view_count&quot;:&quot;0&quot;,&quot;width&quot;:null,&quot;view_1&quot;:&quot;1&quot;,
 &quot;view_2&quot;:&quot;1&quot;,&quot;album_cover&quot;:&quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item\/3&quot;,
 &quot;thumb_url&quot;:&quot;http:\/\/example.com\/gallery3\/var\/thumbs\/\/.album.jpg?m=1270958456&quot;},
 &quot;relationships&quot;:{&quot;tags&quot;:{&quot;url&quot;:&quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item_tags\/1&quot;,
 &quot;members&quot;:[&quot;http:\/\/example.com\/gallery3\/index.php\/rest\/tag_item\/9,1&quot;,
 &quot;http:\/\/example.com\/gallery3\/index.php\/rest\/tag_item\/10,1&quot;]}},&quot;members&quot;:[
 &quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item\/7&quot;,
 &quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item\/11&quot;,
 &quot;http:\/\/example.com\/gallery3\/index.php\/rest\/item\/26&quot;]}
</code></pre></div>
<p>위 결과를 JSON 객체로 변형하면 다음과 같다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{
   &quot;url&quot;: &quot;http://example.com/gallery3/index.php/rest/item/1&quot;,
   &quot;entity&quot;: {
     &quot;id&quot;: &quot;1&quot;,
     &quot;captured&quot;: null,
     &quot;created&quot;: &quot;1270793819&quot;,
     &quot;description&quot;: &quot;&quot;,
     &quot;height&quot;: null,
     &quot;level&quot;: &quot;1&quot;,
     &quot;mime_type&quot;: null,
     &quot;name&quot;: null,
     &quot;owner_id&quot;: &quot;2&quot;,
     &quot;rand_key&quot;: null,
     &quot;resize_height&quot;: null,
     ...skipped some values to keep things short...
     &quot;album_cover&quot;: &quot;http://example.com/gallery3/index.php/rest/item/3&quot;,
     &quot;thumb_url&quot;: &quot;http://example.com/gallery3/var/thumbs//.album.jpg?m=1270958456&quot;
   },
   &quot;relationships&quot;: {
     &quot;tags&quot;: {
       &quot;url&quot;: &quot;http://example.com/gallery3/index.php/rest/item_tags/1&quot;,
       &quot;members&quot;: [
         &quot;http://example.com/gallery3/index.php/rest/tag_item/9,1&quot;,
         &quot;http://example.com/gallery3/index.php/rest/tag_item/10,1&quot;
       ]
      }
    },
   &quot;members&quot;: [
     &quot;http://example.com/gallery3/index.php/rest/item/7&quot;,
     &quot;http://example.com/gallery3/index.php/rest/item/11&quot;,
     &quot;http://example.com/gallery3/index.php/rest/item/26&quot;
   ]
 }
</code></pre></div>
<p>GAllery의 REST의 결과값은 크게 <strong>url</strong>, <strong>entity</strong>, <strong>relationships</strong>, <strong>memebers</strong> 로 나눌 수 있다.</p>

<ul>
<li><strong>url</strong> : REST로 접근한 URL</li>
<li><strong>entity</strong> : item의 정보 (앨범, 사진, 영상 등 Gallery의 모든 객체를 item*으로 표현하고 있고 item은 entity로 세부 정보를 지정하거나 표현된다)</li>
<li><strong>releationships</strong> : 요청한 item과 연관된 item의 집합</li>
<li><strong>members</strong> : item에 접근 가능한 멤버의 집합</li>
</ul>

<h2 id="node-gallery3">node-gallery3</h2>

<p><a href="https://nodejs.org">Node.js</a> 프로젝트를 진행하면서 이미지 관련해서 Gallery3 서비스를 구축하여 이미지를 관리하기 위해 Node로 만들어진 Gallery3 Client가 필요했다. Gallery3 공식 페이지에서는 <a href="http://codex.galleryproject.org/Gallery_3:Other_Clients:Gallery_3_REST_Client_(rWatcher)">rWatcher</a>라는 클라이언트와 <a href="http://codex.galleryproject.org/Category:Gallery_3:Other_Clients">써드파티 클라이언트</a>에 관한 자료를 제공하고 있고,  <a href="http://codex.galleryproject.org/Gallery3:API:REST:Python">python</a>과 <a href="http://codex.galleryproject.org/Gallery3:API:REST:Java-Android">android-java</a>로 된 예제는 공개하고 있지만 Node.js 모듈로 만들어진 client 자료는 없어서 직접 만들게 되었다.</p>

<p><a href="https://github.com/saltfactory/node-gallery3">node-gallery3</a>는 Gallery3의 REST API를 사용하기 위한 <a href="https://github.com/request/request">Request.js</a>를 이용하여 Gallery REST API 요청을  랩핑한 모듈이다. 직관적이고 코드의 간결성을 위해 <a href="https://github.com/kriskowal/q">Promise</a>를 사용하여 응답을 처리하도록 하였다.</p>

<p><strong>node-gallery3</strong>은 NPM을 이용하여 쉽게 설치할 수 있다. global <code>-g</code> 옵션을 이용하여 설치하면 CLI로 사용도 가능하다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">npm install node-gallery3
</code></pre></div>
<p><strong>node-gallery3</strong>는 객체를 생성할 때 Gallery3 서버의 정보를 입력하거나 정보를 <code>$HOME/.gallery3.json</code> 파일을 만들어서 사용 할 수 있다. <strong>node-gallery3</strong> 사용하기 위한 설정 값은 다음과 같다.</p>

<ul>
<li><strong>host</strong> : Gallery3 서버가 설치된 호스트 정보</li>
<li><strong>basae</strong> : Gallery3 서버에 Gallery3가 설치된 URL 경로 (생략하면 <code>/gallery3</code>이 기본 값으로 지정)</li>
<li><strong>rootItemId</strong> : 기본적으로 REST 요청을 타겟 Item으로 보통 사진 파일을 업로드할 앨범의 id를 지정 (생락하면 <code>1</code>이 기본 값으로 지정)</li>
<li><strong>requestKey</strong> : Gallery3의 REST API를 요청하기 위해서 반드시 필요한 <strong>X-Gallery-Request-Key</strong>의 값</li>
</ul>

<p>생성자에 정보를 입력하여 사용하는 방법은 다음과 같다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">var options = {
    host: &#39;http://example.com&#39;,
    base: &#39;/gallery3&#39;,
    rootItemId: 1,
    requestKey: &#39;1234abcd&#39;
};
var gallery3 = new Gallery3(options);
</code></pre></div>
<p>설정 파일로 만들어서 사용하려면 <code>$HOME/.gallery3.json</code> 파일에 다음과 같이 저장한다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">{
    &#39;host&#39;: &#39;http://example.com&#39;,
    &#39;base&#39;: &#39;/gallery3&#39;,
    &#39;rootItemId&#39;: 1,
    &#39;requestKey&#39;: &#39;1234abcd&#39;
}
</code></pre></div>
<h2 id="gallery3.login(user,-password)">Gallery3.login(user, password)</h2>

<p>Gallery3의 REST API를 사용하기 위해서는 <strong>X-Gallery-Request-Key</strong>가 필요한데 이 값을 획득하기 위해서 <strong>node-gallery3</strong>의 <code>Gallery3.login(user, password)</code> 메소드를 사용하여 획득 할 수 있다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">  describe(&#39;login&#39;, function(){
    it(&#39;login user/password&#39;, function(done){
      var user = &#39;user&#39;;
      var password = &#39;password&#39;

      gallery3.login(user, password)
        .success(function(result){
          console.log(result);
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });
  });
</code></pre></div>
<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen_Shot_2015-03-11_at_10_25_24_AM.png?m=1426039276" alt=""></p>

<h2 id="gallery3.finditem(identifier)">Gallery3.findItem(identifier)</h2>

<p>Gallery3에서는 <strong>앨범</strong>, <strong>사진</strong>, <strong>동영상</strong> 등 모든 정보를 <strong>item</strong>이라는 개념으로 정보를 표현한다. 이미 만들어진 앨범의 정보를 요청하기 위해서 <code>Gallery3.findItem(identifier)</code> 메소드를 사용하여 정보를 가져올 수 있다. 이때 <strong>identifier</strong>는 고유 <strong>URL</strong>이거나 <strong>ItemId</strong>를 넣어주면 된다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">describe.only(&#39;findItem&#39;, function(){
    var itemId = 2;
    var url = gallery3.options.host + gallery3.options.base + &#39;/rest/item/&#39; + itemId;

    it(&#39;find item by url&#39;, function(done){
      console.log(gallery3);
      gallery3.findItem(url)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;find item by item id&#39;, function(done){
      gallery3.findItem(itemId)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });
  });
</code></pre></div>
<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen_Shot_2015-03-11_at_10_28_34_AM.png?m=1426039277" alt=""></p>

<h2 id="gallery3.createitem(entity,-identifier)">Gallery3.createItem(entity, identifier)</h2>

<p>Gallery3에서 <strong>앨범</strong>은 <code>type</code>이 <code>album</code>인 <strong>item</strong>이다. 새로운 앨범을 생성하기 위해서는 <code>Gallery3.createItem(entity, identifier)</code> 메소드를 사용한다. entity의 내용은 다음과 같다.</p>

<ul>
<li><strong>type</strong> : 앨범을 만들기 위해서&#39;album&#39; 으로 지정한다.</li>
<li><strong>name</strong> : 앨범의 이름</li>
<li><strong>title</strong> : 앨범 타이틀</li>
</ul>

<p>앨범은 특정 앨범 하위에 서브 앨범으로 만들 수 있는데 이 때 상위 item의 <strong>identifier</strong>(상위 item의 URL이나 itemId)를 입력한다. 정상적으로 앨범이 생성되면 결과 값으로 생성한 앨범의 <strong>URL</strong>을 가진 <strong>JSON</strong>을 반환한다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text"> describe.only(&#39;create Item&#39;, function(){
    var itemId = 2;
    var url = gallery3.options.host + gallery3.options.base + &#39;/rest/item/&#39; + itemId;
    var entity = {
      type: &#39;album&#39;,
      name: &#39;Sample Album&#39;,
      title: &#39;This is my Sample Album&#39;
    };

    it(&#39;create Item without parentItem, default&#39;, function(done){
      gallery3.createItem(entity)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;create Item in parent item by url&#39;, function(done){
      gallery3.createItem(entity, url)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;create Item in parent item by itemId&#39;, function(done){
      gallery3.createItem(entity, itemId)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });
  });
</code></pre></div>
<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen_Shot_2015-03-11_at_10_39_26_AM.png?m=1426039277" alt=""></p>

<h2 id="gallery3.uploadfile(filepath,-entity,-identifier)">Gallery3.uploadFile(filePath, entity, identifier)</h2>

<p>Gallery3의 주 목적은 사진을 업로드하는 것이다. 사진을 Gallery3에 업로드하기 위해서는 <code>Gallery3.uploadFile(filePath, entity, identifier)</code> 메소드를 사용하면 된다.</p>

<ul>
<li><strong>filePath</strong> : 컴퓨터 내의 파일 경로</li>
<li><strong>entity</strong> : 사진의 정보(이름, 파일이름, 설명 등)를 entity 형식으로 명시할 수 있다. (생략하면 파일 이름 기반으로 자동으로 만들어짐)</li>
<li><strong>identifier</strong> : 사진이 업로드될 앨범 (생략하면 itemId가 1인 최상위에 사진이 업로드 된다)</li>
</ul>

<p>이미지가 정상적으로 업로드가 되면 업로된 객체의 <strong>Item</strong>에 대한 고유 URL을 JSON 형태로 반환한다.</p>

<blockquote>
<p>업로드 후 반환되는 URL은 이미지의 URL이 아니라 이미지의 정보를 가지는 Item의 URL이라는 것을 주의해야한다.</p>
</blockquote>

<p>이미지에의 URL을 획득하기 위해서는 <code>Gallery3.findItem(identifier)</code>를 사용하면 이미지의 URL 정보를 포함한 JSON을 가져올 수 있다.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">describe.only(&#39;upload file&#39;, function(){
    var itemId = 2;
    var url = gallery3.options.host + gallery3.options.base + &#39;/rest/item/&#39; + itemId;
    var filePath = &#39;/Users/saltfactory/Downloads/bh6hug.jpg&#39;;
    var entity = {
      title: &#39;title&#39;,
      description: &#39;description&#39;
    };

    it(&#39;upload file without parent identifier&#39;, function(done){
      //gallery3 = new Gallery3({rootItemId:58});

      gallery3.uploadFile(filePath)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;upload file without entity in parent album by url&#39;, function(done){

      gallery3.uploadFile(filePath, url)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;upload file without entity in parent album by id&#39;, function(done){
      gallery3.uploadFile(filePath, itemId)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;upload file with entity&#39;, function(done){
      gallery3.uploadFile(filePath, entity)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;upload file with entity and url&#39;, function(done){
      gallery3.uploadFile(filePath, entity, url )
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;upload file with entity and itemId&#39;, function(done){
      gallery3.uploadFile(filePath, entity, itemId )
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

  });
</code></pre></div>
<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen_Shot_2015-03-11_at_10_45_53_AM.png?m=1426039276" alt=""></p>

<h2 id="gallery3.getimageurlpublic(identifier)">Gallery3.getImageUrlPublic(identifier)</h2>

<p>Gallery3를 이용하면서 이미지 자체의 URL이 필요한 경우가 있다. 이때는 <code>Gallery3.findItem(identifier)</code>를 사용하여 가져올 수도 있지만 좀 더 직관적인 메소드인 <code>Gallery3.getImageUrlPublic(identifier)</code>를 사용하여 이미지의 URL 가져올 수 있다. 위의 예제에서 생성한 Item 110 사진의 URL을 가져오는 예제를 만들어 보자.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">describe.only(&#39;getImageUrlPublic&#39;, function(){
    var itemId = 110;
    var url = gallery3.options.host + gallery3.options.base +&#39;/rest/item/&#39;+itemId;

    it(&#39;get public image url by url&#39;, function(done){
      gallery3.getImageUrlPublic(url)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

    it(&#39;get public image url by itemId&#39;, function(done){
      gallery3.getImageUrlPublic(itemId)
        .success(function(result){
          console.log(result)
        })
        .error(function(err){
          console.log(err);
        })
        .finally(done);
    });

  });
</code></pre></div>
<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen_Shot_2015-03-11_at_10_52_02_AM.png?m=1426039276" alt=""></p>

<h2 id="결론">결론</h2>

<p><a href="https://github.com/saltfactory/node-gallery3">node-gallery3</a>를 사용하여 Gallery3 서버에 앨범을 만들고 사진을 업로드하였다. 실제 서버에는 웹으로 업로드한 파일을 다음과 같이 관리할 수 있다.</p>

<p><img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen%20Shot%202015-03-11%20at%2010_54_25%20AM.png?m=1426039277" alt="">
<img src="http://assets.hibrainapps.net/images/var/albums/posts/Screen%20Shot%202015-03-11%20at%2010_54_12%20AM.png?m=1426039277" alt=""></p>

<p>Gallery3은 앨범을 만들거나 사진을 관리하기 위한 오픈 소스 프로젝트이만 사용하는 방법에 따라서 다양한 서비스를 만들 수 있다. 이렇게 구축된 Gallery3 서비스를 클라이언트 프로그램이나 외부 프로그램에서 Gallery3의 RESTful API를 사용하여 편리하게 데이터를 가져올 수 있다. 이 때 <strong>node-gallery3</strong>를 이용하면 편리하고 쉽게 Gallery3의 데이터를 관리할 수 있을 것이다. <strong>node-gallery3</strong>은 CLI를 제공하고 있다. Unix나 Mac을 사용하는 사용자는 터미널에서 쉽게 파일을 Gallery3로 업로드할 수 있다. <strong>node-gallery3</strong>을 이용하여 확장된 Gallery3 클라이언트 프로그램도 만들 수 있을 것이다.</p>

<h2 id="참조">참조</h2>

<ul>
<li><a href="http://codex.galleryproject.org/Gallery3:API:REST">http://codex.galleryproject.org/Gallery3:API:REST</a></li>
<li><a href="https://github.com/request/request">https://github.com/request/request</a></li>
<li><a href="https://github.com/kriskowal/q">https://github.com/kriskowal/q</a></li>
</ul>

<h2 id="연구원-소개">연구원 소개</h2>

<ul>
<li>작성자 : <a href="http://about.me/saltfactory">송성광</a> 개발 연구원</li>
<li>블로그 : <a href="http://blog.saltfactory.net">http://blog.saltfactory.net</a></li>
<li>이메일 : <a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
<li>트위터 : <a href="https://twitter.com/saltfactory">@saltfactory</a></li>
<li>페이스북 : <a href="https://facebook.com/salthub">https://facebook.com/salthub</a></li>
<li>연구소 : <a href="http://www.hibrain.net">하이브레인넷</a> 부설연구소</li>
<li>연구실 : <a href="http://dblab.changwon.ac.kr">창원대학교 데이터베이스 연구실</a></li>
</ul>

  </article>

  
  
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    
      var disqus_shortname = 'saltfactorynet';
    
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">saltfactory's series</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li><a href="http://saltfactory.net">www.saltfactory.net</a></li>
        <li><a href="http://blog.saltfactory.net">blog.saltfactory.net</a></li>
        <li><a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/saltfactory">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
  c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
  c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
  c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
  C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
  c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
  c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
  c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
  c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
</svg>

            </span>
            <span class="username">saltfactory</span>
          </a>
        </li>

        <li>
          <a href="https://twitter.com/saltfactory">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
  <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
  c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
  c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
  C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
  c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
  c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
</svg>

            </span>
            <span class="username">saltfactory</span>
          </a>
        </li>

        <li>
          <a href="https://facebook.com/saltfactory">
            <span class="icon facebook">
          		<svg class="facebook-icon-svg" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.112290344,30 C0.112290344,13.4314567 13.3426506,0 29.663129,0 C45.9836073,0 59.2139676,13.4314567 59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C13.3426506,60 0.112290344,46.5685433 0.112290344,30 Z M0.112290344,30" fill="#C2C2C2" sketch:type="MSShapeGroup"></path>
	<path d="M32.1341457,46.3196729 L32.1341457,29.9980891 L36.5657565,29.9980891 L37.1530406,24.3735809 L32.1341457,24.3735809 L32.141675,21.5584604 C32.141675,20.091502 32.2787707,19.3054722 34.351206,19.3054722 L37.1216686,19.3054722 L37.1216686,13.6803271 L32.6894304,13.6803271 C27.3655995,13.6803271 25.491749,16.4088187 25.491749,20.9972835 L25.491749,24.3742179 L22.1732173,24.3742179 L22.1732173,29.998726 L25.491749,29.998726 L25.491749,46.3196729 L32.1341457,46.3196729 Z M32.1341457,46.3196729" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
</svg>
		
        	</span>
        	<span class="username">salthub</span>
			</a>
        </li>

      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text"></p>
    </div>

  </div>

</footer>


	<script src="/series/assets/javascripts/jekyll-img-converter.js"></script>
    </body>
</html>
