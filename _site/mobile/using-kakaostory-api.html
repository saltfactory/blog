<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>KakaoStory API를 이용하여 카카오스토리 포스팅하기</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="">
    <link rel="canonical" href="/series/mobile/using-kakaostory-api.html">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/series/assets/css/main.css">
    <!-- <link rel='stylesheet' type='text/css' href='/assets/css/main.css' /> -->

    
</head>


    <body>

    <header class="site-header">

  <div class="wrap">

    <a class="site-title" href="/series/">saltfactory's series</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
           viewBox="0 0 18 15" enable-background="new 0 0 18 15" xml:space="preserve">
          <path fill="#505050" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0
            h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#505050" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484
            h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#505050" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0
            c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>
      <div class="trigger">
        <a class="page-link" href="/">saltfactory.net</a>
        <a class="page-link" href="/guestbook">Guestbook</a>
        
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

  <header class="post-header">
    <h1>KakaoStory API를 이용하여 카카오스토리 포스팅하기</h1>
    <p class="meta">Feb 13, 2014</p>
  </header>

  <article class="post-content">
  <h2 id="서론">서론</h2>

<p>이번 카카오 SDK에는 카카오 서비스의 핵심 서비스 중에 하나인 카카오스토리에 컨텐츠를 포스팅할 수 있는 기능이 포함되어 있다. 이것은 페이스북의 SDK로 페이스북에 컨텐츠를 포스팅하는 기능과 유사한데 이번 글에는 카카오 SDK를 가지고 카카오스토리에 포스팅하는 방법을 소개한다. 블로그에서 [카카오 Kakao SDK로 안드로이드 앱 개발] 이라는 제목으로 카카오 SDK의 사용 방법을 연재하고 있으니 앞서 작성한 &quot;[카카오 Kakao SDK로 안드로이드 앱 개발] 1. 카카오링크 사용하기(kakaolink)&quot; 글을 먼저 읽어보면 툴 설정과 SDK 설정 방법을 참조할 수 있다.</p>

<!--more-->

<h3 id="kakaostory-sample-실행해보기">kakaostory-sample 실행해보기</h3>

<p>카카오 SDK로 안드로이드 앱 개발 첫번째 글을 참조하면 IntelliJ에 카카오 SDK를 설치하는 방법과 카카오 개발자 사이트에 앱을 등록하는 방법에 대해서 이해했을 거라 보고 설명한다. 만약 첫번째 글을 참조하지 않았다면 반드시 첫번째 글을 읽어보길 바란다.</p>

<p>kakaostory-sample을 실행하기 위해서는 다음과 같은 설정이 필요하다. (이에 관련된 설명은 모두 앞 글에 설명이 되어 있다.)
1. 카카오 SDK 다운로드
2. 개발툴에 카카오 SDK 임포트
3. 카카오 개발자 사이트에 앱 등록
4. 앱 키 발급
5. 안드로이드 debug.keystore 기반의 카카오 서비스에 사용하는 key hash 생성 및 카카오 개발자 사이트에 키해시 등록</p>

<p>이렇게 설정이 되어 있다고 가정하고 설명을 진행한다.</p>

<h4 id="1)-kakaostory-sample-프로젝트를-그냥-실행해본다.">1) kakaostory-sample 프로젝트를 그냥 실행해본다.</h4>

<p>kakaostory-sample을 열어서 <code>/res/values/kakao-strings.xml</code> 파일을 열어보면 다음과 같이 이미 <code>kakao_app_key</code>와 <code>kakao_scheme</code> 이 들어 있는데 이렇게 값이 들어 있다고 해서 샘플앱이 실행되는 것은 아니다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_app_key&quot;</span><span class="nt">&gt;</span>0a0e05c7073ff55e402b1468d65d429b<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_scheme&quot;</span><span class="nt">&gt;</span>kakao0a0e05c7073ff55e402b1468d65d429b<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakaostory_host&quot;</span><span class="nt">&gt;</span>kakaostory<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></div>
<p>한번 아무런 수정 없이 실행해보자. 앱을 최초 실행하면 &quot;카카오 계정으로 로그인&quot;하기 버튼이 있는 <code>KakaoStoryeLoginActivity</code>가 실행이 된다.</p>

<p><img src="http://cfile30.uf.tistory.com/image/2335424252F991AE28ACDB" alt=""></p>

<p>현재 kakao_app_key와 kakao_scheme을 수정하지 않은 상태이다. 카카오 계정으로 로그인을 눌러본다. 그러면 다음과 같이 카카오계정으로 로그인하려는 앱에서 접근하는 권한을 허용할거냐는 alert를 보게 된다. 마치 페이스북에서 앱이 페이스북의 권한을 얻는 것과 유사하다. &quot;허용&quot;을 선택한다.</p>

<p><img src="http://cfile8.uf.tistory.com/image/2740E44C52F99229085727" alt=""></p>

<p>이렇게 카카오계정의 접근을 허용하면 다음은 <code>KakaoStoryMainActivity</code>가 열려야하는데 다시 <code>KakaoStoryLoginActivity</code>로 돌아가는 것을 확인할 수 있다.</p>

<p><img src="http://cfile30.uf.tistory.com/image/2335424252F991AE28ACDB" alt=""></p>

<p>어떤 문제로 이와 같은 현상이 발생한 것일까? 화면상에서는 아무런 경고도 없고 이유도 알 수 없기 때문에 우리는 로그를 확인하기로 한다. 안드로이드 로그에서     kakao를 필터하면 kakao의 샘플 코드가 실행되면서 남기는 로그를 볼 수 있다. 밑에 녹색형광색 박스를 살펴보자. <strong>AUTHORIZATION_FAILED</strong>가 발생했고, <strong>APIErrorResult</strong>로 보여주고 있는 것을 확인 할 수 있다. 화면 캡처에서는 보이지 않지만 다음과 같은 메세지를 출력하고 있다.</p>

<p><img src="http://cfile9.uf.tistory.com/image/2511564752F993672F19FE" alt=""></p>
<div class="highlight"><pre><code class="language-text" data-lang="text">APIErrorResult={requestURL=&#39;https://kauth.kakao.com/oauth/token?grant_type=authorization_code&amp;code=uNKn1sPBFmbOp46d_uTR8kkYLgMcg6Fqf5X-jiL-fu6gSnYjZ7Mjjdw77DioVskxdBTV36wQQjQAAAFEHt2s9g&amp;redirect_uri=kakao0a0e05c7073ff55e402b1468d65d429b%3A%2F%2Foauth&amp;client_id=0a0e05c7073ff55e402b1468d65d429b&amp;android_key_hash=fOb%2B%2Bhwpaq64Bn%2FG7q07yd%2B4Jaw%3D&#39;,
errorCode=-777,
errorMessage=&#39;http status =  Unauthorized msg = {&quot;error&quot;:&quot;misconfigured&quot;,&quot;error_description&quot;:&quot;invalid android_key_hash or ios_bundle_id&quot;}&#39;
},
request_type = null
</code></pre></div>
<p>에러 내용을 잘 살펴보면 <code>redirect_uri</code>로 우리가 보았던 <code>kakao_scheme</code>이 포함되어 있고, <code>client_id</code>로 <code>kakao_app_key</code>가 전송되고 있는 것을 확인할 수 있다. 그리고 앞 글에 설명했던 key hash 값이 함께 전송이 되는데, <code>invalid_android_key_hash</code>에러가 발생하고 있다는 것을 확인할 수 있다. 즉, <code>kakao_app_key</code>와 <code>key hash</code>가 맞지 않아서 발생한 문제 때문에 앱에서 정상적인 로그인이 되지 않고 있는 것이다.</p>

<h4 id="2)-kakaostory-sample에-앱키를-등록한다.">2) kakaostory-sample에 앱키를 등록한다.</h4>

<p>우리는 위에서 kakao_app_key와 key hash의 중요성을 알아보았다. 이제 개발자 사이트에 들어가서 앱 키와 키 해시 값을 확인한다. 자신이 등록한 앱의 기본설정을 열어서 앱키와 키 해시 값을 확인하다.</p>

<p><img src="http://cfile23.uf.tistory.com/image/2126AF4852F9970431C2C8" alt=""></p>

<p>확인한 값을 kakaostory-sample 프로젝트를 열어서 <code>/res/values/kakao-strings.xml</code>에 값을 입력한다. <code>kakao_scheme</code>에는 <code>kakao</code>를 앞에 붙이고  앱키를 입력하면 된다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_app_key&quot;</span><span class="nt">&gt;</span>{등록한 앱의 앱키}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_scheme&quot;</span><span class="nt">&gt;</span>kakao{등록한 앱의 앱키}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakaostory_host&quot;</span><span class="nt">&gt;</span>kakaostory<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></div>
<p>이제 다시 디바이스로 빌드해보자. 위에서와 같은 <code>KakaoStoryLoginActivity</code>가 열리게 되고 &quot;카카오톡 계정으로 로그인&quot; 버튼을 누르면 정상적으로 로그인 인증을 마치고 <code>KakaoStoryMainActivity</code> 화면이 나타날 것이다.</p>

<p><img src="http://cfile21.uf.tistory.com/image/2618264852F9986B04489F" alt=""></p>

<p>프로필 버튼을 눌러보자. 그러면 현재 내가 사용하고 있는 카카오스토리의 배경화면과 프로필 화면 그리고 프로필 정보를 가져와서 업데이트한 것을 확인할 수 있다.</p>

<p><img src="http://cfile4.uf.tistory.com/image/2771D54652F9992A114D8C" alt=""></p>

<p>다음은 포스팅 버튼을 눌러보자. 미리 지정한 글을 카카오스토리 내에 포스팅한 것을 확인할 수 있다.</p>

<p><img src="http://cfile23.uf.tistory.com/image/2354343F52F999B61FFE83" alt=""></p>

<p>컨텐츠를 자세히 눌러보면 앱 키가 내가 만든 앱의 키이기 때문에 내가 앱으로 등록한 <strong>sf-kakao-demo</strong>의 앱으로 등록된 것이라는 것을 확인할 수 있다. 다시 말해서 앱 키를 가지고 어떤 앱으로 글을 올렸는지 확인하는 것을 알 수 있다.</p>

<p><img src="http://cfile8.uf.tistory.com/image/22761C4D52F99A4614E202" alt=""></p>

<p>마지막으로 &quot;업로드&quot; 버튼을 눌러보자. 그런데 좀 이상하다. 업로드가 완료 되었다고 하는데 업로드가 되지 않는 것을 확인할 수 있다. 소스코드를 살펴보자. <code>KakaoStoryMainActivity</code>를 열어본다. 그리고 <code>onClickUpload()</code> 메소드를 살펴보자. 카카오스토리에 이미지와 같이 포스팅을 할 경우 카카오스토리 SDK는 다음과 같이 동작을 한다.
1. 파일을 용량을 줄여서 카카오 서버로 전송한다.
2. 전송이 성공적으로 되면 글과 함께 포스팅을 완료한다.</p>

<p>하지만 kakaostory-sample 예제에 2번 항목이 빠져있다. 그래서 <code>onClickPost()</code> 메소드를 업로드가 완료되면 호출할 수 있게 추가한다.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">private</span> <span class="kt">void</span> <span class="nf">onClickUpload</span><span class="o">()</span> <span class="o">{</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="c1">// TODO 갤러리나 카메라 촬영 후 image File을 올리도록</span>
            <span class="n">Bitmap</span> <span class="n">bitmap</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeResource</span><span class="o">(</span><span class="n">getResources</span><span class="o">(),</span> <span class="n">drawable</span><span class="o">.</span><span class="na">post_image</span><span class="o">);</span>
            <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">writeStoryImage</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">bitmap</span><span class="o">));</span>

            <span class="n">KakaoStoryService</span><span class="o">.</span><span class="na">requestUpload</span><span class="o">(</span><span class="k">new</span> <span class="n">MyKakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">KakaoStoryUpload</span><span class="o">&gt;()</span> <span class="o">{</span>
                <span class="nd">@Override</span>
                <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSuccess</span><span class="o">(</span><span class="kd">final</span> <span class="n">KakaoStoryUpload</span> <span class="n">storyProfile</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">imageURL</span> <span class="o">=</span> <span class="n">storyProfile</span><span class="o">.</span><span class="na">getUrl</span><span class="o">();</span>
                    <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="s">&quot;success to upload image&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
                    <span class="n">onClickPost</span><span class="o">();</span>
                <span class="o">}</span>

            <span class="o">},</span> <span class="n">file</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">(),</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
</code></pre></div>
<p>다시 디바이스로 빌드해서 &quot;업로드&quot; 버튼을 눌러보자. 이젠 사진과 함께 <code>onClickPost()</code>가 동작되어 포스팅 예제 글과 함께 업로드가 완료된 것을 확인할 수 있다.</p>

<p><img src="http://cfile26.uf.tistory.com/image/2653103E52F9A20F25DEF9" alt=""></p>

<h3 id="카카오스토리에-글-올리기-직접-구현해보기">카카오스토리에 글 올리기 직접 구현해보기</h3>

<p>위의 예제는 카카오 SDK에 포함된 예제인데 이제 실제 우리가 앱을 개발할 때 어떻게 사용할 수 있는지 자세히 살펴보자.
우리는 기본 프로젝트에 카카오링크를 테스트한 파일을 열어서 수정을 할 것이다. 소스코드는 다음에서 받을 수 있다.
<a href="https://github.com/saltfactory/saltfactory-android-tutorial/tree/kakaolink-demo">https://github.com/saltfactory/saltfactory-android-tutorial/tree/kakaolink-demo</a></p>

<p>테스트로 작성할 클래스는 크게 4가지 이다.
1. <code>SFKakaoLoginActivity</code> : 카카오 SDK로 로그인하는 방법 포함
2. <code>SFKakaoProfileActivity</code> : 카카오스토리에서 Profile 정보를 가져오는 방법 포함
3. <code>SFKakaoPostActivity</code> : 카카오스토리에 사진과 글을 포스팅하는 방법 포함</p>

<h4 id="1)-앱-키수정,-kakaostory_host-추가">1) 앱 키수정, kakaostory_host 추가</h4>

<p>가장 먼저해야할 일은 카카오 개발자 사이트에서 앱 키를 가지고 앱 키를 수정하는 것이다. <code>/res/values/strings.xml</code> 파일을 열어서 다음과 같이 수정한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;resources&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;app_name&quot;</span><span class="nt">&gt;</span>saltfactory 카카오 SDK 데모<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_app_key&quot;</span><span class="nt">&gt;</span>{앱키}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakao_scheme&quot;</span><span class="nt">&gt;</span>kakao{앱키}<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakaolink_host&quot;</span><span class="nt">&gt;</span>kakolink<span class="nt">&lt;/string&gt;</span>
    <span class="nt">&lt;string</span> <span class="na">name=</span><span class="s">&quot;kakaostory_host&quot;</span><span class="nt">&gt;</span>kakaostory<span class="nt">&lt;/string&gt;</span>
<span class="nt">&lt;/resources&gt;</span>
</code></pre></div>
<h4 id="2)-sfkakaologinactivity-추가">2) SFKakaoLoginActivity 추가</h4>

<p>카카오 SDK 로그인을 담당하는 <code>SFKakaoLoginActivity</code> 안드로이드 컴포넌트를 추가한다. 이 <code>SFKakaoLoginActivity</code>는 카카오 SDK의 로그인버튼을 이용해서 로그인하는 방법을 담고 있다.</p>

<p><img src="http://cfile4.uf.tistory.com/image/250B523852FB0BEA2C2F58" alt=""></p>

<p><code>/res/layout/login.xml</code> 파일에 다음 내용을 추가한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
              <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
              <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span> <span class="na">android:padding=</span><span class="s">&quot;20dp&quot;</span><span class="nt">&gt;</span>



    <span class="nt">&lt;com.kakao.widget.LoginButton</span>
            <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_kakao_login&quot;</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
            <span class="na">android:layout_weight=</span><span class="s">&quot;1&quot;</span>
            <span class="na">android:layout_marginBottom=</span><span class="s">&quot;30dp&quot;</span>
            <span class="na">android:layout_marginLeft=</span><span class="s">&quot;20dp&quot;</span>
            <span class="na">android:layout_marginRight=</span><span class="s">&quot;20dp&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div>
<p>위 <code>login.xml</code> 레이아웃을 <code>SFKakaoLoginActivity</code>에 사용할 것이다. 그리고 다음과 같이 <code>SFKakaoLoginActivity</code>를 구현한다. 화면이 나타날 때 <code>login.xml</code> 을 레이아웃으로 적용하고 <code>loginButton</code>에 카카오 세션 콜백을 넣어줘서 로그인 후 세션 검사 후 세션이 존재하면 다음 화면인 MyActivity를 실행하게 하는 로직이다. 이 때 카카오 SDK에서 로그인을 <code>com.kakao.LoginActivity</code>를 내부적으로 열어서 처리한 이후 다시 닫기 때문에 현재 화면이 사라졌다가 다시 나타나는데 <code>onResume()</code>에서 세션 검사를 확인해야한다. 그렇지 않으면 로그인이 완료 되었음에도 불구하고 아무런 일을 할 수 없게 된다.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">net</span><span class="o">.</span><span class="na">saltfactory</span><span class="o">.</span><span class="na">tutorial</span><span class="o">.</span><span class="na">kakaodemo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.Session</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.SessionCallback</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.exception.KakaoException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.widget.LoginButton</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Created by saltfactory@gmail.com</span>
<span class="cm"> * on 2/12/14.</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SFKakaoLoginActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>

    <span class="c1">// 카카오 SDK에 포함된 카카오로그인 버튼 객체</span>
    <span class="kd">private</span> <span class="n">LoginButton</span> <span class="n">loginButton</span><span class="o">;</span>

    <span class="c1">// 카카오 세션콜백</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">SessionCallback</span> <span class="n">sessionCallback</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">SessionCallback</span><span class="o">()</span> <span class="o">{</span>

        <span class="cm">/**</span>
<span class="cm">         * 카카오 세션이 있을 경우 MyActivity를 새로운 intent로 시작한다.</span>
<span class="cm">         */</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSessionOpened</span><span class="o">()</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">SFKakaoLoginActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">MyActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
            <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="n">finish</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="cm">/**</span>
<span class="cm">         * 카카오 세션이 없을 경우</span>
<span class="cm">         * @param exception   close된 이유가 에러가 발생한 경우에 해당 exception.</span>
<span class="cm">         */</span>
        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSessionClosed</span><span class="o">(</span><span class="n">KakaoException</span> <span class="n">exception</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">loginButton</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">VISIBLE</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">};</span>

    <span class="cm">/**</span>
<span class="cm">     * 카카오 SDK를 사용할 경우 카카오 SDK의 com.kakao.LoginActivity를 새로운 intent로 사용해서 로그인을 하는데,</span>
<span class="cm">     * 로그인 처리가 마치고 다시 이 클래스로 돌아오면 onResume()을 호출한다. 화면에서 사라졌다가 다시 나타날때 카카오 세션을 검사하도록 한다.</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onResume</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onResume</span><span class="o">();</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">Session</span><span class="o">.</span><span class="na">initializeSession</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="n">sessionCallback</span><span class="o">))</span> <span class="o">{</span>
            <span class="n">loginButton</span><span class="o">.</span><span class="na">setVisibility</span><span class="o">(</span><span class="n">View</span><span class="o">.</span><span class="na">GONE</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">else</span> <span class="nf">if</span> <span class="o">(</span><span class="n">Session</span><span class="o">.</span><span class="na">getCurrentSession</span><span class="o">().</span><span class="na">isOpened</span><span class="o">())</span> <span class="o">{</span>
            <span class="n">sessionCallback</span><span class="o">.</span><span class="na">onSessionOpened</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>


    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="c1">// login.xml 레이아웃에 안드로이드 로그인 버턴을 정의했다.</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">login</span><span class="o">);</span>

        <span class="n">loginButton</span> <span class="o">=</span> <span class="o">(</span><span class="n">LoginButton</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_kakao_login</span><span class="o">);</span>
        <span class="n">loginButton</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="c1">// 카카오 로그인 버튼에 세션 콜백을 넘겨준다. 세션 콜백은 위에 정의해두었다.</span>
                <span class="n">loginButton</span><span class="o">.</span><span class="na">setLoginSessionCallback</span><span class="o">(</span><span class="n">sessionCallback</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>


<span class="o">}</span>
</code></pre></div>
<p>이렇게 추가한 <code>SFKakaoLoginActivity</code>는 앱이 실행하면 가장 먼저 호출이 될 것이다. <code>AndroidManifest.xml</code> 파일을 열어서 이 컴포넌트를 추가하자. 카카오 SDK는 카카오에서 인증처리를 해야하기 때문에 <code>INTERNET</code> 권한이 필요하고 네트워크 상태를 확인하고, 사진을 가져오거나 저장하기 위해서 <code>STORAGE</code> 권한이 필요하다. 다음은 카카오 SDK가 내부적으로 <code>com.kakao.LoginActivity</code>를 사용하기 때문에 반드시 <code>AndroidManifest</code>에 등록한다. 만약 이 엑티비티를 등록하지 않으면 카카오 로그인 버튼을 아무리 눌러도 동작을 하지 않는다. 카카오 SDK를 사용할 때 빠질 수 없는 것이 앱 키이다. 다시 한번 확인하자. 그리고 이후에 다른 앱에서 앱 링크로 이 앱을 열수 있게 <code>android:scheme</code>에 카카오 스키마를 등록하는데 이 요청을 받을 수 있는 엑티비티 안에 <code>intent-filter</code> 안에 <code>data</code>로 설정한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
          <span class="na">package=</span><span class="s">&quot;net.saltfactory.tutorial.kakaodemo&quot;</span>
          <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
          <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--&lt;uses-sdk android:minSdkVersion=&quot;17&quot;/&gt;--&gt;</span>
    <span class="nt">&lt;uses-sdk</span> <span class="na">android:minSdkVersion=</span><span class="s">&quot;11&quot;</span> <span class="na">android:targetSdkVersion=</span><span class="s">&quot;17&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 필요한 디바이스 권한 --&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;application</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span> <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
                 <span class="na">android:name=</span><span class="s">&quot;com.kakao.GlobalApplication&quot;</span> <span class="na">android:hardwareAccelerated=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK 내부적으로 로그인 처리시 com.kakao.LoginActivity를 열기 때문에 반드시 이 부분을 추가해야한다. --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.LoginActivity&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK의 로그인 버튼을 이용해서 로그인하는 엑티비티--&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoLoginActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;@string/app_name&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:host=</span><span class="s">&quot;@string/kakaostory_host&quot;</span> <span class="na">android:scheme=</span><span class="s">&quot;@string/kakao_scheme&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 카카오 개발자 사이트에 등록한 앱의 앱키 --&gt;</span>
        <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.sdk.AppKey&quot;</span> <span class="na">android:value=</span><span class="s">&quot;@string/kakao_app_key&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/application&gt;</span>

<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<h4 id="3)-myactivity-수정">3) MyActivity 수정</h4>

<p>첫 번째 예제의 <code>MyActivity</code>를 좀 더 다양한 예제를 테스트하기 위해서 다음과 같이 변경했다. &quot;카카오링크&quot;, &quot;카카오스토리 프로파일&quot;, &quot;카카오스토리 포스팅&quot;, &quot;카카오 로그아웃&quot; 버튼을 추가했는데 카카오링크는 첫 번 째 예제에서 소개한 내용이고, 카카오스토리 프로파일은 카카오스토리의 프로파일 내용을 요청하는 <code>SFKakaoStoryProfileActivity</code>를 열게되고, 카카오스토리 포스팅은 카카오스토리로 사진과 글을 포스팅할 수 있는 <code>SFKakaoStoryPostingActivity</code>를 열게 만들었다.</p>

<p><img src="http://cfile26.uf.tistory.com/image/236C715052FB1043029E8B" alt=""></p>

<p><code>/res/layout/mail.xml</code> 을 다음과 같이 수정한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
              <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
              <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- 카카오링크 테스트 버튼 --&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_kakao_link&quot;</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
            <span class="na">android:text=</span><span class="s">&quot;카카오링크 테스트&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 프로파일 테스트 버튼 --&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_kakaostory_profile&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span> <span class="na">android:text=</span><span class="s">&quot;카카오스토리 프로파일&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 포스팅 테스트 버튼 --&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_kakaostory_post&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span> <span class="na">android:text=</span><span class="s">&quot;카카오스토리 포스팅&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오 SDK 로그아웃 버튼 --&gt;</span>
    <span class="nt">&lt;Button</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_kakao_logout&quot;</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
            <span class="na">android:text=</span><span class="s">&quot;로그아웃&quot;</span><span class="nt">/&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div>
<p><code>MyActivity</code>를 열어서 다음과 같이 수정한다. 위의 <code>main.xml</code>을 적용하여 레이아웃을 설정하고 각 버튼마다 <code>onClickListener</code>를 설정하였다. 주의 깊게 사펴볼 것은 바로 카카오 SDK 로그아웃에 관련된 내용이다. 카카오 SDK 사용자 관리는 <code>UserManagement</code> 객체를 사용하는데 로그아웃 메소드를 호출하면서 로그아웃 응답에 대응하는 콜백 구현체를 넘겨주도록 한다.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">net</span><span class="o">.</span><span class="na">saltfactory</span><span class="o">.</span><span class="na">tutorial</span><span class="o">.</span><span class="na">kakaodemo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.Button</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.*</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&quot;saltfactory.net&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="kd">final</span> <span class="n">MyActivity</span> <span class="n">self</span> <span class="o">=</span> <span class="n">MyActivity</span><span class="o">.</span><span class="na">this</span><span class="o">;</span>

        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">main</span><span class="o">);</span>

        <span class="c1">// 카카오링크 테스트 버튼</span>
        <span class="n">Button</span> <span class="n">buttonLink</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_kakao_link</span><span class="o">);</span>
        <span class="n">buttonLink</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">SFKakaoLinkActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="c1">// 카카오스토리 프로파일 테스트 버튼</span>
        <span class="n">Button</span> <span class="n">buttonProfile</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_kakaostory_profile</span><span class="o">);</span>
        <span class="n">buttonProfile</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">SFKakaoStoryProfileActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="c1">// 카카오스토리 포스팅 테스트 버튼</span>
        <span class="n">Button</span> <span class="n">buttonPost</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_kakaostory_post</span><span class="o">);</span>
        <span class="n">buttonPost</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">SFKakaoStoryPostActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">});</span>

        <span class="c1">// 카카오 SDK 로그아웃 버튼</span>
        <span class="n">Button</span> <span class="n">buttonLogout</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_kakao_logout</span><span class="o">);</span>
        <span class="n">buttonLogout</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">UserManagement</span><span class="o">.</span><span class="na">requestLogout</span><span class="o">(</span><span class="k">new</span> <span class="nf">LogoutResponseCallback</span><span class="o">()</span> <span class="o">{</span>
                    <span class="nd">@Override</span>
                    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onSuccess</span><span class="o">(</span><span class="kt">long</span> <span class="n">userId</span><span class="o">)</span> <span class="o">{</span>
                        <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">self</span><span class="o">,</span> <span class="n">SFKakaoLoginActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                        <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
                        <span class="n">finish</span><span class="o">();</span>
                    <span class="o">}</span>

                    <span class="nd">@Override</span>
                    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">APIErrorResult</span> <span class="n">errorResult</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">errorResult</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
                    <span class="o">}</span>
                <span class="o">});</span>
            <span class="o">}</span>
        <span class="o">});</span>


    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>이제 <code>AndroidManifest.xml</code> 파일을 열어서 위 컴포넌트를 추가한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
          <span class="na">package=</span><span class="s">&quot;net.saltfactory.tutorial.kakaodemo&quot;</span>
          <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
          <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--&lt;uses-sdk android:minSdkVersion=&quot;17&quot;/&gt;--&gt;</span>
    <span class="nt">&lt;uses-sdk</span> <span class="na">android:minSdkVersion=</span><span class="s">&quot;11&quot;</span> <span class="na">android:targetSdkVersion=</span><span class="s">&quot;17&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 필요한 디바이스 권한 --&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;application</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span> <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
                 <span class="na">android:name=</span><span class="s">&quot;com.kakao.GlobalApplication&quot;</span> <span class="na">android:hardwareAccelerated=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK 내부적으로 로그인 처리시 com.kakao.LoginActivity를 열기 때문에 반드시 이 부분을 추가해야한다. --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.LoginActivity&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK의 로그인 버튼을 이용해서 로그인하는 엑티비티--&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoLoginActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:host=</span><span class="s">&quot;@string/kakaostory_host&quot;</span> <span class="na">android:scheme=</span><span class="s">&quot;@string/kakao_scheme&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>

        <span class="c">&lt;!-- 테스트 메인 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.MyActivity&quot;</span>
                  <span class="na">android:label=</span><span class="s">&quot;saltfactory 카카오 SDK 데모&quot;</span><span class="nt">/&gt;</span>


        <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 카카오 개발자 사이트에 등록한 앱의 앱키 --&gt;</span>
        <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.sdk.AppKey&quot;</span> <span class="na">android:value=</span><span class="s">&quot;@string/kakao_app_key&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/application&gt;</span>


<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<h4 id="4)-카카오스토리-프로파일을-가져오는-sfkakaostoryprofileactivity-추가.">4) 카카오스토리 프로파일을 가져오는 SFKakaoStoryProfileActivity 추가.</h4>

<p>지금부터 눈여겨 봐야할 것이 바로 카카오 SDK 중에서도 카카오스토리의 기능을 사용할 수 있는 카카오스토리 API 사용법이다. 테스트로 만든 <code>SFKakaoStoryProfileActivity</code>는 크게 ImageView 2개 (프로파일 이미지, 배경화면 이미지)와 TextView 2개(닉네임, 생일)를 레이아웃으로 구성하고 있다.</p>

<p><img src="http://cfile2.uf.tistory.com/image/267BFD4652FB1381128DC0" alt=""></p>

<p>위와 같이 구성하기 위해서 <code>/res/layout/profile.xml</code>을 다음과 같이 추가한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="nt">&lt;RelativeLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
                <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span><span class="nt">&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 대문화면(배경화면) 사진을 보여줄 이미지뷰 --&gt;</span>
    <span class="nt">&lt;ImageView</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_imageview_background&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
               <span class="na">android:layout_height=</span><span class="s">&quot;fill_parent&quot;</span> <span class="na">android:layout_alignParentTop=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 프로파일 사진을 보여줄 이미지뷰--&gt;</span>
    <span class="nt">&lt;ImageView</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_imageview_profile&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;120dp&quot;</span>
               <span class="na">android:layout_height=</span><span class="s">&quot;120dp&quot;</span> <span class="na">android:layout_alignParentTop=</span><span class="s">&quot;true&quot;</span> <span class="na">android:layout_margin=</span><span class="s">&quot;20dp&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 닉네임을 보여줄 텍스트뷰--&gt;</span>
    <span class="nt">&lt;TextView</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_textview_nickname&quot;</span> <span class="na">anadroid:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span> <span class="na">android:text=</span><span class="s">&quot;닉네임 : &quot;</span>
              <span class="na">android:layout_below=</span><span class="s">&quot;@id/sf_imageview_profile&quot;</span> <span class="na">android:layout_marginLeft=</span><span class="s">&quot;10dp&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오스토리 생일을 보여줄 텍스트뷰--&gt;</span>
    <span class="nt">&lt;TextView</span> <span class="na">android:id=</span><span class="s">&quot;@+id/sf_textview_birthday&quot;</span> <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span> <span class="na">android:text=</span><span class="s">&quot;생일 : &quot;</span>
              <span class="na">android:layout_below=</span><span class="s">&quot;@id/sf_textview_nickname&quot;</span> <span class="na">android:layout_marginLeft=</span><span class="s">&quot;10dp&quot;</span><span class="nt">/&gt;</span>


<span class="nt">&lt;/RelativeLayout&gt;</span>
</code></pre></div>
<p><code>SFKakaoStoryProfileActivity</code>를 다음과 같이 추가한다. <code>KakaoStoryProfileActivity</code>는 생성이 될 때 카카오 SDK를 이용해서 카카오스토리 프로파일을 요청해서 그 결과를 레이아웃에 적용하는 내용을 포함하고 있다. 이때 카카오스토리에 프로파일을 요청하기 위해서 <code>KakaoStoryService.requestProfile()</code> 메소드를 요청한다. 이 때 요청응답의 결과를 처리하기 위해서 <code>KakaoStoryResponseHandler</code>구현체를 함께 넘겨주는데 처리가 완료되면 에러가 없을 경우 <code>KakaoStoryProfile</code> 객체로 결과를 받아서 처리할 수 있다.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">net</span><span class="o">.</span><span class="na">saltfactory</span><span class="o">.</span><span class="na">tutorial</span><span class="o">.</span><span class="na">kakaodemo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.app.Application</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Bitmap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.BitmapFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.AsyncTask</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.ImageView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.TextView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.android.volley.toolbox.NetworkImageView</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.w3c.dom.Text</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.InputStream</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URI</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.net.URISyntaxException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Calendar</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.Locale</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Created by saltfactory on 2/12/14.</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SFKakaoStoryProfileActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&quot;saltfactory.net&quot;</span><span class="o">;</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">profile</span><span class="o">);</span>

        <span class="c1">// 카카오스토리 프로파일 사진을 보여줄 이미지뷰</span>
        <span class="kd">final</span> <span class="n">ImageView</span> <span class="n">imageViewProfile</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_imageview_profile</span><span class="o">);</span>
        <span class="c1">// 카카오스토리 배경화면 사진을 보여줄 이미지뷰</span>
        <span class="kd">final</span> <span class="n">ImageView</span> <span class="n">imageViewBackground</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_imageview_background</span><span class="o">);</span>
        <span class="c1">// 카카오스토리 닉네임을 보여줄 텍스트뷰</span>
        <span class="kd">final</span> <span class="n">TextView</span> <span class="n">textViewNickName</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_textview_nickname</span><span class="o">);</span>
        <span class="c1">// 카카오스토리 생일을 보여줄 텍스트뷰</span>
        <span class="kd">final</span> <span class="n">TextView</span> <span class="n">textViewBirthday</span> <span class="o">=</span> <span class="o">(</span><span class="n">TextView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_textview_birthday</span><span class="o">);</span>


        <span class="c1">// 카카오스토리 API 중에 프로파일 요청을 하기 위해서 KakaoStoryService.requestProfile()을 호출한다.</span>
        <span class="c1">// 이 때 결과응답을 처리하 수 있도록 KakaoStoryHttpResponsehandler 구현체를 보내어 요청한다.</span>
        <span class="n">KakaoStoryService</span><span class="o">.</span><span class="na">requestProfile</span><span class="o">(</span><span class="k">new</span> <span class="n">KakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">KakaoStoryProfile</span><span class="o">&gt;()</span> <span class="o">{</span>
            <span class="cm">/**</span>
<span class="cm">             * 카카오 세션의 유저와 같지 않을 때, 즉 카카오스토리 계정으로 로그인 되지 않은 경우</span>
<span class="cm">             */</span>
            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onNotKakaoStoryUser</span><span class="o">()</span> <span class="o">{</span>
                <span class="kd">final</span> <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">SFKakaoStoryProfileActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">SFKakaoStoryLoginActivity</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
                <span class="n">startActivity</span><span class="o">(</span><span class="n">intent</span><span class="o">);</span>
                <span class="n">finish</span><span class="o">();</span>
            <span class="o">}</span>

            <span class="cm">/**</span>
<span class="cm">             * 카카오스토리 requestProfile 요청이 실패하였을 경우</span>
<span class="cm">             * @param errorResult 실패한 원인이 담긴 결과</span>
<span class="cm">             */</span>
            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="n">APIErrorResult</span> <span class="n">errorResult</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">errorResult</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="o">}</span>

            <span class="cm">/**</span>
<span class="cm">             * 카카오스토리 requestProfile 요청을 성공하였을 경우 KakaoStoryProfile 객체를 받아오게 된다.</span>
<span class="cm">             * KakaoStoryProfile 객체 안에 프로파일 이미지, 배경이미지, 닉네임, 생일 정보가 들어 있다.</span>
<span class="cm">             * @param kakaoStoryProfile</span>
<span class="cm">             */</span>
            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSuccess</span><span class="o">(</span><span class="n">KakaoStoryProfile</span> <span class="n">kakaoStoryProfile</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">String</span> <span class="n">nickName</span> <span class="o">=</span> <span class="n">kakaoStoryProfile</span><span class="o">.</span><span class="na">getNickName</span><span class="o">();</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&quot;KakaoStory nickName : &quot;</span> <span class="o">+</span> <span class="n">nickName</span><span class="o">);</span>
                <span class="n">textViewNickName</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;이름 : &quot;</span> <span class="o">+</span> <span class="n">nickName</span><span class="o">);</span>


                <span class="n">String</span> <span class="n">profileImageURL</span> <span class="o">=</span> <span class="n">kakaoStoryProfile</span><span class="o">.</span><span class="na">getProfileImageURL</span><span class="o">();</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&quot;KakaoStory profileImageURL : &quot;</span> <span class="o">+</span> <span class="n">profileImageURL</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">profileImageURL</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">new</span> <span class="nf">DownloadImageTask</span><span class="o">(</span><span class="n">imageViewProfile</span><span class="o">).</span><span class="na">execute</span><span class="o">(</span><span class="n">profileImageURL</span><span class="o">);</span>
                <span class="o">}</span>


                <span class="n">String</span> <span class="n">backgroundURL</span> <span class="o">=</span> <span class="n">kakaoStoryProfile</span><span class="o">.</span><span class="na">getBgImageURL</span><span class="o">();</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">d</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="s">&quot;KakaoStory backgroundURL : &quot;</span> <span class="o">+</span> <span class="n">backgroundURL</span><span class="o">);</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">backgroundURL</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">new</span> <span class="nf">DownloadImageTask</span><span class="o">(</span><span class="n">imageViewBackground</span><span class="o">).</span><span class="na">execute</span><span class="o">(</span><span class="n">backgroundURL</span><span class="o">);</span>
                <span class="o">}</span>


                <span class="n">Calendar</span> <span class="n">birthday</span> <span class="o">=</span> <span class="n">kakaoStoryProfile</span><span class="o">.</span><span class="na">getBirthdayCalendar</span><span class="o">();</span>
                <span class="k">if</span> <span class="o">(</span><span class="n">birthday</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">StringBuilder</span> <span class="n">displayBirthday</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">StringBuilder</span><span class="o">(</span><span class="mi">8</span><span class="o">);</span>
                    <span class="n">displayBirthday</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="n">birthday</span><span class="o">.</span><span class="na">getDisplayName</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">MONTH</span><span class="o">,</span> <span class="n">Calendar</span><span class="o">.</span><span class="na">SHORT</span><span class="o">,</span> <span class="n">Locale</span><span class="o">.</span><span class="na">US</span><span class="o">)).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot; &quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">birthday</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Calendar</span><span class="o">.</span><span class="na">DAY_OF_MONTH</span><span class="o">));</span>

                    <span class="n">KakaoStoryProfile</span><span class="o">.</span><span class="na">BirthdayType</span> <span class="n">birthDayType</span> <span class="o">=</span> <span class="n">kakaoStoryProfile</span><span class="o">.</span><span class="na">getBirthdayType</span><span class="o">();</span>

                    <span class="k">if</span> <span class="o">(</span><span class="n">birthDayType</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                        <span class="n">displayBirthday</span><span class="o">.</span><span class="na">append</span><span class="o">(</span><span class="s">&quot; (&quot;</span><span class="o">).</span><span class="na">append</span><span class="o">(</span><span class="n">birthDayType</span><span class="o">.</span><span class="na">getDisplaySymbol</span><span class="o">()).</span><span class="na">append</span><span class="o">(</span><span class="s">&quot;)&quot;</span><span class="o">);</span>
                    <span class="n">textViewBirthday</span><span class="o">.</span><span class="na">setText</span><span class="o">(</span><span class="s">&quot;생일 : &quot;</span> <span class="o">+</span> <span class="n">displayBirthday</span><span class="o">);</span>
                    <span class="c1">//Log.d(TAG, &quot;KakaoStory birthday : &quot; + displayBirthday);</span>
                <span class="o">}</span>

            <span class="o">}</span>

            <span class="nd">@Override</span>
            <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSessionClosedFailure</span><span class="o">(</span><span class="n">APIErrorResult</span> <span class="n">errorResult</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">errorResult</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
            <span class="o">}</span>
        <span class="o">});</span>

    <span class="o">}</span>


    <span class="cm">/**</span>
<span class="cm">     * 비동기 방식으로 이미지 URL을 가지고 안드로이드 레이아웃에 등록한 ImageView에 사진을 로드 시키는 구현체</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">class</span> <span class="nc">DownloadImageTask</span> <span class="kd">extends</span> <span class="n">AsyncTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Void</span><span class="o">,</span> <span class="n">Bitmap</span><span class="o">&gt;</span> <span class="o">{</span>
        <span class="n">ImageView</span> <span class="n">bmImage</span><span class="o">;</span>

        <span class="kd">public</span> <span class="nf">DownloadImageTask</span><span class="o">(</span><span class="n">ImageView</span> <span class="n">bmImage</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">this</span><span class="o">.</span><span class="na">bmImage</span> <span class="o">=</span> <span class="n">bmImage</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="n">Bitmap</span> <span class="nf">doInBackground</span><span class="o">(</span><span class="n">String</span><span class="o">...</span> <span class="n">urls</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">String</span> <span class="n">urldisplay</span> <span class="o">=</span> <span class="n">urls</span><span class="o">[</span><span class="mi">0</span><span class="o">];</span>
            <span class="n">Bitmap</span> <span class="n">mIcon11</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="k">try</span> <span class="o">{</span>
                <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="na">net</span><span class="o">.</span><span class="na">URL</span><span class="o">(</span><span class="n">urldisplay</span><span class="o">).</span><span class="na">openStream</span><span class="o">();</span>
                <span class="n">mIcon11</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeStream</span><span class="o">(</span><span class="n">in</span><span class="o">);</span>
            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="s">&quot;Error&quot;</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
            <span class="o">}</span>
            <span class="k">return</span> <span class="n">mIcon11</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onPostExecute</span><span class="o">(</span><span class="n">Bitmap</span> <span class="n">result</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">bmImage</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">result</span><span class="o">);</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>이제 <code>AndroidManifest.xml</code> 파일을 수정한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
          <span class="na">package=</span><span class="s">&quot;net.saltfactory.tutorial.kakaodemo&quot;</span>
          <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
          <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--&lt;uses-sdk android:minSdkVersion=&quot;17&quot;/&gt;--&gt;</span>
    <span class="nt">&lt;uses-sdk</span> <span class="na">android:minSdkVersion=</span><span class="s">&quot;11&quot;</span> <span class="na">android:targetSdkVersion=</span><span class="s">&quot;17&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 필요한 디바이스 권한 --&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;application</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span> <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
                 <span class="na">android:name=</span><span class="s">&quot;com.kakao.GlobalApplication&quot;</span> <span class="na">android:hardwareAccelerated=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK 내부적으로 로그인 처리시 com.kakao.LoginActivity를 열기 때문에 반드시 이 부분을 추가해야한다. --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.LoginActivity&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK의 로그인 버튼을 이용해서 로그인하는 엑티비티--&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoLoginActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:host=</span><span class="s">&quot;@string/kakaostory_host&quot;</span> <span class="na">android:scheme=</span><span class="s">&quot;@string/kakao_scheme&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>

        <span class="c">&lt;!-- 테스트 메인 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.MyActivity&quot;</span>
                  <span class="na">android:label=</span><span class="s">&quot;saltfactory 카카오 SDK 데모&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오스토리 프로파일 테스트 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoStoryProfileActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;카카오스토리 프로파일 &quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 카카오 개발자 사이트에 등록한 앱의 앱키 --&gt;</span>
        <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.sdk.AppKey&quot;</span> <span class="na">android:value=</span><span class="s">&quot;@string/kakao_app_key&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/application&gt;</span>


<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<h4 id="5)-카카오스토리로-사진과-글을-포스팅하는-sfkakaostorypostactivity-추가">5) 카카오스토리로 사진과 글을 포스팅하는 SFKakaoStoryPostActivity 추가</h4>

<p>카카오 SDK의 카카오스토리 API 테스트의 마지막 엑티비티인 이 객체는 사진첩에서 사진을 선택해서 글을 입력 받아 그 글을 카카오스토리에 올리는 엑티비티이다.</p>

<p><img src="http://cfile8.uf.tistory.com/image/2663E43852FB1B5E2F1966" alt=""></p>

<p><code>res/layout/post.xml</code> 파일을 다음 내용으로 추가한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="nt">&lt;LinearLayout</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
              <span class="na">android:orientation=</span><span class="s">&quot;vertical&quot;</span>
              <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
              <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span> <span class="na">android:weightSum=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>


    <span class="nt">&lt;RelativeLayout</span>
            <span class="na">android:layout_width=</span><span class="s">&quot;match_parent&quot;</span>
            <span class="na">android:layout_height=</span><span class="s">&quot;match_parent&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- 카카오스토리에 포스팅할 내용을 적는 글상자 --&gt;</span>
        <span class="nt">&lt;EditText</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;fill_parent&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;200dp&quot;</span>
                <span class="na">android:inputType=</span><span class="s">&quot;textMultiLine|textNoSuggestions&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/sf_edittext_content&quot;</span> <span class="na">android:layout_alignParentRight=</span><span class="s">&quot;true&quot;</span>
                <span class="na">android:layout_alignParentEnd=</span><span class="s">&quot;true&quot;</span>
                <span class="na">android:layout_alignParentLeft=</span><span class="s">&quot;true&quot;</span> <span class="na">android:layout_alignParentStart=</span><span class="s">&quot;true&quot;</span>
                <span class="na">android:layout_alignParentTop=</span><span class="s">&quot;true&quot;</span> <span class="na">android:gravity=</span><span class="s">&quot;top&quot;</span> <span class="na">android:autoText=</span><span class="s">&quot;false&quot;</span>
                <span class="na">android:autoLink=</span><span class="s">&quot;none&quot;</span> <span class="na">android:scrollHorizontally=</span><span class="s">&quot;false&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 내 앨범에서 선택한 사진을 미리보는 이미지뷰 --&gt;</span>
        <span class="nt">&lt;ImageView</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;40dp&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;40dp&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/sf_imageview_thumb&quot;</span>
                <span class="na">android:layout_alignBottom=</span><span class="s">&quot;@+id/sf_button_post&quot;</span> <span class="na">android:layout_alignParentLeft=</span><span class="s">&quot;true&quot;</span>
                <span class="na">android:layout_alignParentStart=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오스토리에 포스팅하는 버튼 --&gt;</span>
        <span class="nt">&lt;Button</span>
                <span class="na">android:layout_width=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:layout_height=</span><span class="s">&quot;wrap_content&quot;</span>
                <span class="na">android:text=</span><span class="s">&quot;포스팅&quot;</span>
                <span class="na">android:id=</span><span class="s">&quot;@+id/sf_button_post&quot;</span>
                <span class="na">android:layout_below=</span><span class="s">&quot;@+id/sf_edittext_content&quot;</span> <span class="na">android:layout_alignParentRight=</span><span class="s">&quot;true&quot;</span>
                <span class="na">android:layout_alignParentEnd=</span><span class="s">&quot;true&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;/RelativeLayout&gt;</span>
<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div>
<p>다음은 <code>SFKakaoStoryPostActivity</code> 파일을 구현하여 추가한다. 카카오스토리 포스팅 과정은 다음과 같다. 카카오스토리에 사진을 전송하기 위해서 사진의 사이즈를 조절해서 카카오스토리에 업로드하면 정상적으로 업로드가 완료된 이후 업로드한 이미지 경로를 가지는 객체를 반환해준다. 그러면 카카오스토리에 포스팅하는 메소드를 가지고 앞에서 업로드에 성공해서 받은 이미지 경로와 글 내용을 카카오스토리 파라미터 빌드를 사용해서 파라미터를 만들어서 카카오스토리에 포스팅하게 되는 과정으로 처리된다.</p>
<div class="highlight"><pre><code class="language-java" data-lang="java"><span class="kn">package</span> <span class="n">net</span><span class="o">.</span><span class="na">saltfactory</span><span class="o">.</span><span class="na">tutorial</span><span class="o">.</span><span class="na">kakaodemo</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">android.app.Activity</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Context</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.content.Intent</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.database.Cursor</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.Bitmap</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.graphics.BitmapFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.net.Uri</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.os.Bundle</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.provider.MediaStore</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.util.Log</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.view.View</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">android.widget.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.kakao.helper.Logger</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>

<span class="cm">/**</span>
<span class="cm"> * Created by saltfactory@gmail.com</span>
<span class="cm"> * on 2/12/14.</span>
<span class="cm"> */</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SFKakaoStoryPostActivity</span> <span class="kd">extends</span> <span class="n">Activity</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">String</span> <span class="n">TAG</span> <span class="o">=</span> <span class="s">&quot;saltfactory.net&quot;</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">RESULT_LOAD_IMAGE</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span>

    <span class="c1">// 사진 앨범에서 선택한 사진을 미리 보여주는 이미지뷰</span>
    <span class="kd">private</span> <span class="n">ImageView</span> <span class="n">imageView</span><span class="o">;</span>
    <span class="c1">// 사진 앨범에서 선택한 사진을 저장할 비트맵</span>
    <span class="kd">private</span> <span class="n">Bitmap</span> <span class="n">bitmapSelectedPhoto</span><span class="o">;</span>
    <span class="c1">// 카카오스토리에 글을 포스팅하기 위한 글상자</span>
    <span class="kd">private</span> <span class="n">EditText</span> <span class="n">editText</span><span class="o">;</span>
    <span class="c1">// 카카오스토리로 포스팅하기 위한 버튼</span>
    <span class="kd">private</span> <span class="n">Button</span> <span class="n">button</span><span class="o">;</span>


    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>

        <span class="n">setContentView</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">post</span><span class="o">);</span>

        <span class="n">imageView</span> <span class="o">=</span> <span class="o">(</span><span class="n">ImageView</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_imageview_thumb</span><span class="o">);</span>
        <span class="n">button</span> <span class="o">=</span> <span class="o">(</span><span class="n">Button</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_button_post</span><span class="o">);</span>
        <span class="n">editText</span> <span class="o">=</span> <span class="o">(</span><span class="n">EditText</span><span class="o">)</span> <span class="n">findViewById</span><span class="o">(</span><span class="n">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">sf_edittext_content</span><span class="o">);</span>

        <span class="c1">// 엑티비티가 실행하면 사진을 선택할 수 있도록 사집첩 앨범을 열도록 한다.</span>
        <span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">Intent</span><span class="o">(</span><span class="n">Intent</span><span class="o">.</span><span class="na">ACTION_PICK</span><span class="o">,</span> <span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">EXTERNAL_CONTENT_URI</span><span class="o">);</span>
        <span class="n">startActivityForResult</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="n">RESULT_LOAD_IMAGE</span><span class="o">);</span>

        <span class="c1">// 카카오스토리로 포스팅하는 버튼의 클릭리스너 등록</span>
        <span class="n">button</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="n">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="n">View</span> <span class="n">view</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">try</span> <span class="o">{</span>
                    <span class="c1">// 사진첩 앨범에서 선택한 사진을 카카오스토리에 올리기 위한 사이즈를 조절하고 그 파일을 업로드에 사용한다.</span>
                    <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">writeStoryImage</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">bitmapSelectedPhoto</span><span class="o">));</span>
                    <span class="n">KakaoStoryService</span><span class="o">.</span><span class="na">requestUpload</span><span class="o">(</span><span class="k">new</span> <span class="n">MyKakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">KakaoStoryUpload</span><span class="o">&gt;()</span> <span class="o">{</span>
                        <span class="cm">/**</span>
<span class="cm">                         * 카카오스토리에 사진 파일 업로드가 완료하면 이 메소드가 자동적으로 호출되어지는데</span>
<span class="cm">                         * 이때 사진 파일 업로드한 이미지 경로를 가지고 KakaoStoryPostParamBuilder로 파라미터를 설정해서 글 내용과 함께 포스팅을 요청한다.</span>
<span class="cm">                         * @param resultObj 성공한 결과</span>
<span class="cm">                         */</span>
                        <span class="nd">@Override</span>
                        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSuccess</span><span class="o">(</span><span class="n">KakaoStoryUpload</span> <span class="n">resultObj</span><span class="o">)</span> <span class="o">{</span>
                            <span class="n">String</span> <span class="n">imageURL</span> <span class="o">=</span> <span class="n">resultObj</span><span class="o">.</span><span class="na">getUrl</span><span class="o">();</span>
                            <span class="n">String</span> <span class="n">storyPostText</span> <span class="o">=</span> <span class="n">editText</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>

                            <span class="kd">final</span> <span class="n">KakaoStoryPostParamBuilder</span> <span class="n">postParamBuilder</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">KakaoStoryPostParamBuilder</span><span class="o">(</span><span class="n">storyPostText</span><span class="o">,</span> <span class="n">KakaoStoryPostParamBuilder</span><span class="o">.</span><span class="na">PERMISSION</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">);</span>
                            <span class="k">if</span> <span class="o">(</span><span class="n">imageURL</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span>
                                <span class="n">postParamBuilder</span><span class="o">.</span><span class="na">setImageURL</span><span class="o">(</span><span class="n">imageURL</span><span class="o">);</span>
                            <span class="n">Bundle</span> <span class="n">parameters</span> <span class="o">=</span> <span class="n">postParamBuilder</span><span class="o">.</span><span class="na">build</span><span class="o">();</span>

                            <span class="n">KakaoStoryService</span><span class="o">.</span><span class="na">requestPost</span><span class="o">(</span><span class="k">new</span> <span class="n">MyKakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;()</span> <span class="o">{</span>
                                <span class="nd">@Override</span>
                                <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSuccess</span><span class="o">(</span><span class="n">Void</span> <span class="n">resultObj</span><span class="o">)</span> <span class="o">{</span>
                                 <span class="c1">//   Toast.makeText(getApplicationContext(), &quot;success to post on KakaoStory&quot;, Toast.LENGTH_SHORT).show();</span>
                                    <span class="n">SFKakaoStoryPostActivity</span><span class="o">.</span><span class="na">super</span><span class="o">.</span><span class="na">onBackPressed</span><span class="o">();</span>
                                <span class="o">}</span>
                            <span class="o">},</span> <span class="n">parameters</span><span class="o">);</span>
                        <span class="o">}</span>
                    <span class="o">},</span> <span class="n">file</span><span class="o">);</span>
                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">IOException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                    <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">e</span><span class="o">.</span><span class="na">getLocalizedMessage</span><span class="o">());</span>
                <span class="o">}</span>


            <span class="o">}</span>
        <span class="o">});</span>
    <span class="o">}</span>


    <span class="cm">/**</span>
<span class="cm">     * 사진 앱범을 열어서 사진을 선택하고 닫으면 이 메소드가 호출 된다.</span>
<span class="cm">     * 파일을 카카오스토리에 올리기 전에 썸네일 이미지로 imageView에 보여주게 한다.</span>
<span class="cm">     * @param requestCode</span>
<span class="cm">     * @param resultCode</span>
<span class="cm">     * @param data</span>
<span class="cm">     */</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onActivityResult</span><span class="o">(</span><span class="kt">int</span> <span class="n">requestCode</span><span class="o">,</span> <span class="kt">int</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onActivityResult</span><span class="o">(</span><span class="n">requestCode</span><span class="o">,</span> <span class="n">resultCode</span><span class="o">,</span> <span class="n">data</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(</span><span class="n">requestCode</span> <span class="o">==</span> <span class="n">RESULT_LOAD_IMAGE</span> <span class="o">&amp;&amp;</span> <span class="n">resultCode</span> <span class="o">==</span> <span class="n">RESULT_OK</span> <span class="o">&amp;&amp;</span> <span class="kc">null</span> <span class="o">!=</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Uri</span> <span class="n">selectedImage</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getData</span><span class="o">();</span>
            <span class="n">String</span><span class="o">[]</span> <span class="n">filePathColumn</span> <span class="o">=</span> <span class="o">{</span><span class="n">MediaStore</span><span class="o">.</span><span class="na">Images</span><span class="o">.</span><span class="na">Media</span><span class="o">.</span><span class="na">DATA</span><span class="o">};</span>

            <span class="n">Cursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">getContentResolver</span><span class="o">().</span><span class="na">query</span><span class="o">(</span><span class="n">selectedImage</span><span class="o">,</span>
                    <span class="n">filePathColumn</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="kc">null</span><span class="o">);</span>
            <span class="n">cursor</span><span class="o">.</span><span class="na">moveToFirst</span><span class="o">();</span>

            <span class="kt">int</span> <span class="n">columnIndex</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getColumnIndex</span><span class="o">(</span><span class="n">filePathColumn</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
            <span class="n">String</span> <span class="n">picturePath</span> <span class="o">=</span> <span class="n">cursor</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">columnIndex</span><span class="o">);</span>
            <span class="n">cursor</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>

            <span class="n">bitmapSelectedPhoto</span> <span class="o">=</span> <span class="n">BitmapFactory</span><span class="o">.</span><span class="na">decodeFile</span><span class="o">(</span><span class="n">picturePath</span><span class="o">);</span>
            <span class="n">imageView</span><span class="o">.</span><span class="na">setImageBitmap</span><span class="o">(</span><span class="n">bitmapSelectedPhoto</span><span class="o">);</span>

        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">.</span><span class="na">onBackPressed</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>


    <span class="cm">/**</span>
<span class="cm">     * 카카오스토리에 사진파일을 전송하기 위해서 사이즈를 변경하는 메소드</span>
<span class="cm">     * @param context</span>
<span class="cm">     * @param bitmap</span>
<span class="cm">     * @return</span>
<span class="cm">     * @throws IOException</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">writeStoryImage</span><span class="o">(</span><span class="kd">final</span> <span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="kd">final</span> <span class="n">Bitmap</span> <span class="n">bitmap</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="kd">final</span> <span class="n">File</span> <span class="n">diskCacheDir</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">File</span><span class="o">(</span><span class="n">context</span><span class="o">.</span><span class="na">getCacheDir</span><span class="o">(),</span> <span class="s">&quot;story&quot;</span><span class="o">);</span>

        <span class="k">if</span> <span class="o">(!</span><span class="n">diskCacheDir</span><span class="o">.</span><span class="na">exists</span><span class="o">())</span>
            <span class="n">diskCacheDir</span><span class="o">.</span><span class="na">mkdirs</span><span class="o">();</span>

        <span class="kd">final</span> <span class="n">String</span> <span class="n">file</span> <span class="o">=</span> <span class="n">diskCacheDir</span><span class="o">.</span><span class="na">getAbsolutePath</span><span class="o">()</span> <span class="o">+</span> <span class="n">File</span><span class="o">.</span><span class="na">separator</span> <span class="o">+</span> <span class="s">&quot;temp_&quot;</span> <span class="o">+</span> <span class="n">System</span><span class="o">.</span><span class="na">currentTimeMillis</span><span class="o">()</span> <span class="o">+</span> <span class="s">&quot;.jpg&quot;</span><span class="o">;</span>

        <span class="n">OutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
        <span class="k">try</span> <span class="o">{</span>
            <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nf">BufferedOutputStream</span><span class="o">(</span><span class="k">new</span> <span class="nf">FileOutputStream</span><span class="o">(</span><span class="n">file</span><span class="o">),</span> <span class="mi">8</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">);</span>
            <span class="n">bitmap</span><span class="o">.</span><span class="na">compress</span><span class="o">(</span><span class="n">Bitmap</span><span class="o">.</span><span class="na">CompressFormat</span><span class="o">.</span><span class="na">JPEG</span><span class="o">,</span> <span class="mi">100</span><span class="o">,</span> <span class="n">out</span><span class="o">);</span>
        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">out</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
            <span class="o">}</span>
        <span class="o">}</span>

        <span class="k">return</span> <span class="n">file</span><span class="o">;</span>
    <span class="o">}</span>


    <span class="cm">/**</span>
<span class="cm">     * 카카오스토리에 Http 요청을한 이후 응답받는 결과에 따라 동작하게 하는 구현체</span>
<span class="cm">     * @param &lt;T&gt;</span>
<span class="cm">     */</span>
    <span class="kd">private</span> <span class="kd">abstract</span> <span class="kd">class</span> <span class="nc">MyKakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="kd">extends</span> <span class="n">KakaoStoryHttpResponseHandler</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="o">{</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onHttpSessionClosedFailure</span><span class="o">(</span><span class="kd">final</span> <span class="n">APIErrorResult</span> <span class="n">errorResult</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">Log</span><span class="o">.</span><span class="na">e</span><span class="o">(</span><span class="n">TAG</span><span class="o">,</span> <span class="n">errorResult</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onNotKakaoStoryUser</span><span class="o">()</span> <span class="o">{</span>
            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="s">&quot;not KakaoStory user&quot;</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onFailure</span><span class="o">(</span><span class="kd">final</span> <span class="n">APIErrorResult</span> <span class="n">errorResult</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">final</span> <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="s">&quot;MyKakaoStoryHttpResponseHandler : failure : &quot;</span> <span class="o">+</span> <span class="n">errorResult</span><span class="o">;</span>
            <span class="n">Logger</span><span class="o">.</span><span class="na">getInstance</span><span class="o">().</span><span class="na">d</span><span class="o">(</span><span class="n">message</span><span class="o">);</span>
            <span class="n">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">message</span><span class="o">,</span> <span class="n">Toast</span><span class="o">.</span><span class="na">LENGTH_LONG</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div>
<p>마지막으로 <code>AndroidManifest.xml</code> 파일에 위 엑티비티를 등록한다.</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="nt">&lt;manifest</span> <span class="na">xmlns:android=</span><span class="s">&quot;http://schemas.android.com/apk/res/android&quot;</span>
          <span class="na">package=</span><span class="s">&quot;net.saltfactory.tutorial.kakaodemo&quot;</span>
          <span class="na">android:versionCode=</span><span class="s">&quot;1&quot;</span>
          <span class="na">android:versionName=</span><span class="s">&quot;1.0&quot;</span><span class="nt">&gt;</span>
    <span class="c">&lt;!--&lt;uses-sdk android:minSdkVersion=&quot;17&quot;/&gt;--&gt;</span>
    <span class="nt">&lt;uses-sdk</span> <span class="na">android:minSdkVersion=</span><span class="s">&quot;11&quot;</span> <span class="na">android:targetSdkVersion=</span><span class="s">&quot;17&quot;</span><span class="nt">/&gt;</span>

    <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 필요한 디바이스 권한 --&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.INTERNET&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.ACCESS_NETWORK_STATE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;uses-permission</span> <span class="na">android:name=</span><span class="s">&quot;android.permission.READ_EXTERNAL_STORAGE&quot;</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;application</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span> <span class="na">android:icon=</span><span class="s">&quot;@drawable/ic_launcher&quot;</span>
                 <span class="na">android:name=</span><span class="s">&quot;com.kakao.GlobalApplication&quot;</span> <span class="na">android:hardwareAccelerated=</span><span class="s">&quot;true&quot;</span><span class="nt">&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK 내부적으로 로그인 처리시 com.kakao.LoginActivity를 열기 때문에 반드시 이 부분을 추가해야한다. --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.LoginActivity&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK의 로그인 버튼을 이용해서 로그인하는 엑티비티--&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoLoginActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;@string/sf_app_name&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;intent-filter&gt;</span>
                <span class="nt">&lt;action</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.action.MAIN&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;category</span> <span class="na">android:name=</span><span class="s">&quot;android.intent.category.LAUNCHER&quot;</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;data</span> <span class="na">android:host=</span><span class="s">&quot;@string/kakaostory_host&quot;</span> <span class="na">android:scheme=</span><span class="s">&quot;@string/kakao_scheme&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/intent-filter&gt;</span>
        <span class="nt">&lt;/activity&gt;</span>

        <span class="c">&lt;!-- 테스트 메인 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.MyActivity&quot;</span>
                  <span class="na">android:label=</span><span class="s">&quot;saltfactory 카카오 SDK 데모&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오스토리 프로파일 테스트 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoStoryProfileActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;카카오스토리 프로파일 &quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오스토리 포스팅 테스트 엑티비티 --&gt;</span>
        <span class="nt">&lt;activity</span> <span class="na">android:name=</span><span class="s">&quot;.SFKakaoStoryPostActivity&quot;</span> <span class="na">android:label=</span><span class="s">&quot;카카오스토리 포스팅&quot;</span><span class="nt">/&gt;</span>

        <span class="c">&lt;!-- 카카오 SDK를 사용하기 위해서 카카오 개발자 사이트에 등록한 앱의 앱키 --&gt;</span>
        <span class="nt">&lt;meta-data</span> <span class="na">android:name=</span><span class="s">&quot;com.kakao.sdk.AppKey&quot;</span> <span class="na">android:value=</span><span class="s">&quot;@string/kakao_app_key&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/application&gt;</span>


<span class="nt">&lt;/manifest&gt;</span>
</code></pre></div>
<p>이제 카카오스토리 테스트에 관한 모든 설정이 완료되었다. 카카오스토리 포스팅을 테스트해보자. 앱을 디바이스에 빌드하고 난 이후 로그인 버튼을 클릭한다.</p>

<p><img src="http://cfile4.uf.tistory.com/image/250B523852FB0BEA2C2F58" alt=""></p>

<p>그러면 카카오계정으로 로그인하려는 앱에서 접근 권한을 허용하는 문구가 나온다. 허용을 선택한다.</p>

<p><img src="http://cfile28.uf.tistory.com/image/26445B3E52FB1F500AF173" alt=""></p>

<p>그러면 테스트를 위해 추가한 MyActivity가 실행된다.</p>

<p><img src="http://cfile26.uf.tistory.com/image/236C715052FB1043029E8B" alt=""></p>

<p>카카오스토리 포스팅 버튼을 눌러보자. 그러면 카카오에 글을 등록하기 이전에 먼저 앨번에서 사진을 선택할 수 있게 사진첩 앨범이 열리는 것을 확인할 수 있다.</p>

<p><img src="http://cfile26.uf.tistory.com/image/271C184552FB36D1233E03" alt=""></p>

<p>사진을 선택하고 글상자에 글을 입력한다.</p>

<p><img src="http://cfile27.uf.tistory.com/image/251BF53D52FB36FA3E81EE" alt=""></p>

<p>포스팅 버튼을 클릭해서 실제 포스팅이 완료 되었는지 확인한다.</p>

<p><img src="http://cfile3.uf.tistory.com/image/221CA83752FB371D283237" alt=""></p>

<h2 id="결론">결론</h2>

<p>이번 카카오 SDK의 가장 핵심 기능은 카카오스토리에 사진과 글을 포스팅할 수 있는 기능이 아닌가 생각된다. 페이스북은 오래전에 페이스북 SDK로 다른 앱에서 컨텐츠를 포스팅할 수 있는 기능을 지원했기 때문에 여러가지 페이스북과 연동되는 앱이 많이 개발되었다. 이번 카카오 SDK에서 카카오스토리로 컨텐츠를 포스팅할 수 있는 기능을 제공하기 때문에 카카오 서비스와 연동되는 앱이 더욱 많아 질 것으로 예상된다.</p>

<h2 id="소스코드">소스코드</h2>

<ul>
<li><a href="https://github.com/saltfactory/saltfactory-android-tutorial/releases/tag/kakaostory-demo">https://github.com/saltfactory/saltfactory-android-tutorial/releases/tag/kakaostory-demo</a></li>
</ul>

<h2 id="참고">참고</h2>

<ol>
<li><a href="https://developers.kakao.com/docs">https://developers.kakao.com/docs</a></li>
</ol>

<h2 id="연구원-소개">연구원 소개</h2>

<ul>
<li>작성자 : <a href="http://about.me/saltfactory">송성광</a> 개발 연구원</li>
<li>블로그 : <a href="http://blog.saltfactory.net">http://blog.saltfactory.net</a></li>
<li>이메일 : <a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
<li>트위터 : <a href="https://twitter.com/saltfactory">@saltfactory</a></li>
<li>페이스북 : <a href="https://facebook.com/salthub">https://facebook.com/salthub</a></li>
<li>연구소 : <a href="http://www.hibrain.net">하이브레인넷</a> 부설연구소</li>
<li>연구실 : <a href="http://dblab.changwon.ac.kr">창원대학교 데이터베이스 연구실</a></li>
</ul>

  </article>

  
  
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    
      var disqus_shortname = 'saltfactorynet';
    
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

  
</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <!-- <h2 class="footer-heading">saltfactory's series</h2> -->

    <div class="footer-col-1 column">
      <ul>
        <li><a href="http://saltfactory.net">www.saltfactory.net</a></li>
        <li><a href="http://blog.saltfactory.net">blog.saltfactory.net</a></li>
        <li><a href="mailto:saltfactory@gmail.com">saltfactory@gmail.com</a></li>
      </ul>
    </div>

    <div class="footer-col-2 column">
      <ul>
        <li>
          <a href="https://github.com/saltfactory">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
  <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
  c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
  c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
  c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
  C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
  c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
  c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
  c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
  c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
</svg>

            </span>
            <span class="username">saltfactory</span>
          </a>
        </li>

        <li>
          <a href="https://twitter.com/saltfactory">
            <span class="icon twitter">
              <svg version="1.1" class="twitter-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
   viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
  <path fill="#C2C2C2" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
  c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27
  c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767
  c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206
  C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271
  c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469
  c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
</svg>

            </span>
            <span class="username">saltfactory</span>
          </a>
        </li>

        <li>
          <a href="https://facebook.com/saltfactory">
            <span class="icon facebook">
          		<svg class="facebook-icon-svg" viewBox="0 0 60 60" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns">
    <path d="M0.112290344,30 C0.112290344,13.4314567 13.3426506,0 29.663129,0 C45.9836073,0 59.2139676,13.4314567 59.2139676,30 C59.2139676,46.5685433 45.9836073,60 29.663129,60 C13.3426506,60 0.112290344,46.5685433 0.112290344,30 Z M0.112290344,30" fill="#C2C2C2" sketch:type="MSShapeGroup"></path>
	<path d="M32.1341457,46.3196729 L32.1341457,29.9980891 L36.5657565,29.9980891 L37.1530406,24.3735809 L32.1341457,24.3735809 L32.141675,21.5584604 C32.141675,20.091502 32.2787707,19.3054722 34.351206,19.3054722 L37.1216686,19.3054722 L37.1216686,13.6803271 L32.6894304,13.6803271 C27.3655995,13.6803271 25.491749,16.4088187 25.491749,20.9972835 L25.491749,24.3742179 L22.1732173,24.3742179 L22.1732173,29.998726 L25.491749,29.998726 L25.491749,46.3196729 L32.1341457,46.3196729 Z M32.1341457,46.3196729" id="Path" fill="#FFFFFF" sketch:type="MSShapeGroup"></path>
</svg>
		
        	</span>
        	<span class="username">salthub</span>
			</a>
        </li>

      </ul>
    </div>

    <div class="footer-col-3 column">
      <p class="text"></p>
    </div>

  </div>

</footer>


	<script src="/series/assets/javascripts/jekyll-img-converter.js"></script>
    </body>
</html>
