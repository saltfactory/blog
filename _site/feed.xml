<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>saltfactory&#39;s series</title>
    <description></description>
    <link>http://saltfactory.net/series/</link>
    <atom:link href="http://saltfactory.net/series/feed.xml" rel="self" type="application/rss+xml" />
    <pubDate>Tue, 11 Nov 2014 16:44:12 +0900</pubDate>
    <lastBuildDate>Tue, 11 Nov 2014 16:44:12 +0900</lastBuildDate>
    <generator>Jekyll v2.4.0</generator>
    
      <item>
        <title>mark2html을 이용하여 Markdown 파일을 HTML 파일로 변환</title>
        <description>&lt;h2 id=&quot;mark2html@v.0.0.5&quot;&gt;&lt;a href=&quot;mailto:mark2html@v.0.0.5&quot;&gt;mark2html@v.0.0.5&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/saltfactory/mark2html&quot;&gt;mark2html&lt;/a&gt; &lt;strong&gt;&lt;em&gt;0.0.5&lt;/em&gt;&lt;/strong&gt; 버전은 &lt;a href=&quot;http://jekyllrb.com/&quot;&gt;Jekyll&lt;/a&gt;의 &lt;a href=&quot;http://jekyllrb.com/docs/frontmatter/&quot;&gt;front matter&lt;/a&gt; 가 포함된 Markdown 파일에서 front matter를 skip하고 렌더링 할 수 있는 옵션 &lt;code&gt;-skip-front-matter&lt;/code&gt;를 추가 하였다.&lt;/p&gt;

&lt;h2 id=&quot;jekyll&quot;&gt;Jekyll&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;http://wolfslittlestore.be/wp-content/uploads/2013/07/jekyll.png&quot; alt=&quot;jekyll&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://jekyllrb.com&quot;&gt;Jekyll&lt;/a&gt;은 static website(blog) 프레임워크이다.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Jekyll은 static website(blog)를 만들 때 &lt;strong&gt;&lt;em&gt;Markdown&lt;/em&gt;&lt;/strong&gt; 파일을 사용해서 HTML 페이지를 만든다.  &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;다시 말해서 Jekyll은 Markdown만 있으면 웹 사이트와 블로그를 서비스를 쉽게 만들 수 있다는 말이다. 더이상 기존의 웹 프로그램을 하듯 HTML을 생성할 필요도 없고, 데이터베이스 연결을 고민할 필요가 없다. 단순하게 Markdown으로 글을 작성하면 Jekyll 안에서 자동으로 static HTML 파일이 생성이 되기 때문이다. Jekyll은 GitHub에서 공식적으로 &lt;a href=&quot;https://pages.github.com/&quot;&gt;GitHub Pages&lt;/a&gt;를 만드는 방법에 소개를 하면서 더욱 유명해지기 시작했다. &lt;a href=&quot;http://en.wikipedia.org/wiki/GitHub&quot;&gt;GitHub&lt;/a&gt;는 Ruby로 만들어져 있고 Jekyll 역시 Ruby로 만들어져 있기 때문에 Jekyll로 만든 디렉토리를 모두 GitHub 저장소에 올려두고 push를 하는 것 만으로 쉽게 GitHub를 이용한 웹사이트나 블로그를 만들 수 있다. Jekyll로 GitHub site를 사용해서 웹 서비스를 만드는 방법은 이 후에 자세히 포스팅 할 예정이다.&lt;/p&gt;

&lt;h2 id=&quot;front-matter&quot;&gt;Front Matter&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;http://jekyllrb.com/docs/frontmatter/&quot;&gt;Front Matter&lt;/a&gt;는 Jekyll이 Makrdown을 해석할때 사용하는 메타정보를 표현하는 것으로 Markdown 파일이 시작하는 첫 부분에 &lt;a href=&quot;http://en.wikipedia.org/wiki/YAML&quot;&gt;YAML&lt;/a&gt; 포멧으로 작성된 것이다. front matter는 &lt;code&gt;---&lt;/code&gt;으로 시작해서 &lt;code&gt;---&lt;/code&gt;를 끝으로 이 사이에 정보를 YAML 포멧으로 저장한다.&lt;/p&gt;

&lt;p&gt;예를 들면 다음과 같이 Markdown 파일이 시작하는 첫 부분에 front matter를 추가하는 것이다. 아래 내용은 Jekyll이 자동으로 category에 맞는 디렉토리에 파싱된 HTML을 post 라는 레이아웃으로 저장할 것이다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;---
layout : post
category : articles
tags : [mark2html, node, markdown]
title : mark2html 버전 0.0.5 업그레이드 소개
---
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이것은 Markdown의 표준 마커업이 아니다. Jekyll이나 다른 서비스에서 적용할 수 있는 문법으로 기본적인 Markdown 파서는 front matter를 해석하지 못하는 문제가 발생한다.&lt;/p&gt;

&lt;h2 id=&quot;-skip-front-matter-옵션&quot;&gt;-skip-front-matter 옵션&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;a href=&quot;mailto:mark2html@0.0.5&quot;&gt;mark2html@0.0.5&lt;/a&gt;&lt;/em&gt;&lt;/strong&gt; 에서는 Jekyll에서 생성하여 사용하는 front matter가 포함된 Markdown 파일을 HTML 으로 변환하기 위해서 &lt;code&gt;-skip-front-matter&lt;/code&gt; 옵션을 추가하였다. 이 옵션을 사용하면 Jekyll에 사용하고 있는 Markdown을 HTML으로 변환할 때 front matter를 생략하고 나머지 Markdown 내용만 변환할 수 있다.
사용 방법은 다음과 같다.&lt;/p&gt;

&lt;h3 id=&quot;명령어-옵션으로-사용할-때&quot;&gt;명령어 옵션으로 사용할 때&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;mark2html&lt;/code&gt; 명령어가 없다면 npm으로 설치한다.
&lt;code&gt;
npm install -g mark2html
&lt;/code&gt;
Markdown 파일에 front matter가 포함되어 있다면 &lt;code&gt;mark2html&lt;/code&gt; 명령어에 &lt;code&gt;-skip-front-matter&lt;/code&gt; 옵션을 함께 사용한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mark2html -skip-front-matteer -s /Users/saltfactory/blogs/blog.saltfactory.net/posts/2014-08-25-mark2html-v.0.0.5-upgrade.md
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;node-모듈료-사용할-때&quot;&gt;node 모듈료 사용할 때&lt;/h3&gt;

&lt;p&gt;모듈을 찾을 수 없다면 로컬 모듈로 &lt;code&gt;mark2html&lt;/code&gt;을 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install mark2html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;mark2html.convert()&lt;/code&gt;를 사용때 적용하는 옵션에 &lt;code&gt;skipFrontMatter&lt;/code&gt;를 &lt;code&gt;true&lt;/code&gt;로 지정한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mark2html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mark2html&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/Users/saltfactory/blogs/blog.saltfactory.net/posts/2014-08-25-mark2html-v.0.0.5-upgrade.md&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;destDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/User/saltfactory/DropBox/Blog/output&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;skipFrontMatter&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;mark2html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;결론&quot;&gt;결론&lt;/h2&gt;

&lt;p&gt;현재 blog는 Tistory 기반으로 사용하고 있지만 이 서비스는 Markdown을 사용하기에 적합하지는 않기 때문에 GitHub pages를 사용하여 블로그를 이전하려고 준비하고 있다. mark2html은 Markdown 파일을 Tistory에 포스팅하기 위해서 만들게 된 변환 모듈인데 이 것을 Jekyll에서 생성한 Markdown에 적용을 할 때, front matter 때문에 문제가 발생하였다. 지금은 Jekyll를 사용하여 GitHub를 만들어가고 있기 때문에 front matter가 저장된 Markdown들이 많이 있다. 이것을 표준 Markdown 형태로 변환해서 mark2html으로 HTML을 만들어서 Tistory에 올리기 위해서 mark2html에 &lt;code&gt;-skip-front-matter&lt;/code&gt; 옵션을 추가하였다. 이 기능을 추가하고 난 이후 이젠 Jekyll에서 Markdown을 사용하여 static page를 만들기도 하고 특별한 작업없이 사용한 Markdown을 기존의 표준 Markdown으로 Archive 하는데 동일하게 사용할 수 있게 되었다.&lt;/p&gt;

&lt;h2 id=&quot;참고&quot;&gt;참고&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;http://jekyllrb.com/docs/frontmatter/&quot;&gt;http://jekyllrb.com/docs/frontmatter/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/saltfactory/mark2html&quot;&gt;https://github.com/saltfactory/mark2html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/15207069/remove-yaml-header-from-markdown-file&quot;&gt;http://stackoverflow.com/questions/15207069/remove-yaml-header-from-markdown-file&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Tue, 05 Aug 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/mark2html/mark2html-v.0.0.5-upgrade.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/mark2html/mark2html-v.0.0.5-upgrade.html</guid>
        
        
        <category>mark2html</category>
        
      </item>
    
      <item>
        <title>Markdown 파일을 HTML 파일로 변환할 때 IMG 사이즈 변환</title>
        <description>&lt;h2 id=&quot;mark2html@0.0.4&quot;&gt;&lt;a href=&quot;mailto:mark2html@0.0.4&quot;&gt;mark2html@0.0.4&lt;/a&gt;&lt;/h2&gt;

&lt;p&gt;mark2html을 &lt;strong&gt;&lt;em&gt;0.0.4&lt;/em&gt;&lt;/strong&gt;버전으로 업그레이드 했다. 이번 업데이트에는 Makrdown에서 HTML으로 변환할 때 이미지의 크기 등 style을 적용할 수 있는 기능이 추가 되었다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://saltfactory.net/mark2html&quot;&gt;mark2html&lt;/a&gt;은 현재 개발되고 있는 사이드 프로젝트이다. Markdown을 사용하여 Tistory 블로그에 포스팅을 하기 위해서 시작된 이 프로젝트는 틈틈히 업데이트를 하고 있다. 이전 블로그들은 모두 스타일이 적용된 HTML으로 되어 있기 때문에 Markdown의 속성을 사용할 수도 없고, 다른 곳에 이전할 때도 기존의 HTML으로 작성된 포스팅과 Markdown을 사용하여 포스팅하는 글의 이질감을 느껴야한다. 그래서 시간이 날 때마다 Markdown으로 작성하지 않은 포스팅을 Markdown으로 변환해서 저장하는 작업을 하고 있다.&lt;/p&gt;

&lt;h2 id=&quot;기존-html-문서를-markdown으로-변환할때-문제점&quot;&gt;기존 HTML 문서를 Markdown으로 변환할때 문제점&lt;/h2&gt;

&lt;p&gt;Markdown을 사용해서 HTML 문서를 만들어내지 않은 기존의 HTML 문서를 가지고 Markdown으로 변환하는데는 몇가지 문제점이 있다.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;기존의 HTML에서 Markdown이 변환할 때의 약속된 HTML태그를 찾기 어렵다.&lt;/em&gt;&lt;/strong&gt; : 예를 들어, &lt;code&gt;### 제목&lt;/code&gt; 이라고 Markdown으로 작성을 하면 이 문자열은 &lt;code&gt;&amp;lt;h3&amp;gt;제목&amp;lt;/h3&amp;gt;&lt;/code&gt;로 변환이 된다. 하지만 기존 WYSIWYG을 사용해서 제목을 지정하거나 글자 크기를 변경했다면 &lt;code&gt;&amp;lt;p style=&amp;quot;font-size:24pt;&amp;quot;&amp;gt;제목&amp;lt;/p&amp;gt;&lt;/code&gt;와 같은 형태로 저장이 되어 있기 때문에 Markdown과 HTML 간의 변환을 위한 약속된 태그를 사용해서 변경할 없다. 그래서 사람이 copy &amp;amp; paste 를 할 수 밖에 없다. ~만약 기존의 문서를 Markdown으로 변환해서 사용하려면 빨리 마이그레이션하길 권한다. 포스팅이 꽤 많아져서 Markdown으로 변환하는데 시간이 많이 걸릴거라 생각된다.~&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Markdown은 이미지 사이즈를 정할 수 없다&lt;/em&gt;&lt;/strong&gt; : Markdown은 이미지의 &lt;code&gt;src&lt;/code&gt;,&lt;code&gt;alt&lt;/code&gt;,&lt;code&gt;title&lt;/code&gt; 속성만 지정할 수 있기 때문에 기존에 포스팅에 이미지가 특별한 사이즈로 지정했을때 이것을 Markdown으로 변경하면 이미지 사이즈를 특별하게 지정할 수 없게 된다. 반대로 Markdonw에서 이미지를 나타낼때 특정 사이즈로 변경하고 싶을 경우 css로 global하게 지정할 수 밖에 없다.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;img-style-지정-필요&quot;&gt;IMG style 지정 필요&lt;/h2&gt;

&lt;p&gt;Markdown을 사용해서 이미지를 표현하려고 하는데 Markdown이 이미지 사이즈를 지정할 수 없기 때문에 큰 이미지를 그대로 HTML에 나타나서 어려움이 발생했다. &lt;strong&gt;Retina MacBook Pro&lt;/strong&gt;를 사용하고 있는데 레티나에서 스크린 캡쳐를 하게되면 보통 이미지보다 2배가 커진다. 레티나 아이폰도 마찬가지 이다. &lt;code&gt;320px&lt;/code&gt;로 표현하면 충분한데 캡쳐 받은 이미지가 &lt;code&gt;640px&lt;/code&gt;이기 때문에 컨텐츠에 엄청 크게 이미지가 나타나버린다. 그래서 Markdown에서 이미지를 표현할 때 Markdown 문법에 틀리지 않으면서 style을 추가하면 좋겠다는 생각이 들었다.&lt;/p&gt;

&lt;h2 id=&quot;img-속성&quot;&gt;IMG 속성&lt;/h2&gt;

&lt;p&gt;HTML의 &lt;code&gt;IMG&lt;/code&gt; 태그의 속성은 &lt;code&gt;src&lt;/code&gt;, &lt;code&gt;alt&lt;/code&gt;, &lt;code&gt;title&lt;/code&gt;을 가지고 있다.
- &lt;strong&gt;&lt;em&gt;src&lt;/em&gt;&lt;/strong&gt; : 이미지의 URI 소스 값이다.
- &lt;strong&gt;&lt;em&gt;alt&lt;/em&gt;&lt;/strong&gt; : 이미지가 나타나지 않는 경우 이미지를 설명하는 텍스트이다. 이미지가 나타나지 않을 때 alt가 나타난다. 이 값은 이미지가 나타나는 경우에 화면에 나타나지 않는다.
- &lt;strong&gt;&lt;em&gt;title&lt;/em&gt;&lt;/strong&gt; : 이미지에 마우스를 올리면 나타나는 이미지의 타이틀 값이다.&lt;/p&gt;

&lt;p&gt;Markdown에서 위의 이미지 속성을 표현하기 위해서는 다음과 같은 문법을 따른다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;![아이폰화면 이미지](http://cfile23.uf.tistory.com/image/222B154153A3916F292543 &amp;quot;아이폰화면&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이 문법은 HTML 코드로 변환되면 다음과 같이 변환이 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://cfile23.uf.tistory.com/image/222B154153A3916F292543&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;alt=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;아이폰화면 이미지&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;아이폰화면&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://cfile23.uf.tistory.com/image/222B154153A3916F292543&quot; alt=&quot;아이폰화면 이미지&quot; title=&quot;아이폰화면&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;code&gt;img&lt;/code&gt; 속성중에 &lt;code&gt;alt&lt;/code&gt; 값은 이미지가 나타나는한 화면에 나타나지 않고 이미지를 설명하는 값이다. 그래서 Markdown을 작성할 때 &lt;code&gt;alt&lt;/code&gt; 값에 &lt;code&gt;style&lt;/code&gt; 값을 넣어서 사용하기로 했다.&lt;/p&gt;

&lt;h3 id=&quot;alt-값에-style-속성-추가하기&quot;&gt;ALT 값에 style 속성 추가하기&lt;/h3&gt;

&lt;p&gt;위에 나타나는 이미지는 아이폰5에서 캡쳐한 사진의 실제 크기이다. 그럼 &lt;code&gt;img&lt;/code&gt;의 &lt;code&gt;alt&lt;/code&gt;값을 넣고 표현해보자. 다음과 같이 Markdown의 이미지의 &lt;code&gt;alt&lt;/code&gt;를 표현하는 공간에 &lt;code&gt;{}&lt;/code&gt;를 사용해서 style 값을 지정했다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;![아이폰화면 이미지 {width:320px;}](http://cfile23.uf.tistory.com/image/222B154153A3916F292543 &amp;quot;아이폰화면&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;&lt;a href=&quot;http://saltfactory.net/mark2html&quot;&gt;mark2html&lt;/a&gt;@0.0.4&lt;/em&gt;&lt;/strong&gt; 버전에서는 &lt;code&gt;-imageStyle&lt;/code&gt; 옵션값이 추가되었다. 명령어 옵션은 &lt;code&gt;-style&lt;/code&gt;이다. 다음과 같이 옵션 값에 &lt;code&gt;imageStyle&lt;/code&gt;을
추가하거나 command 라인에 &lt;code&gt;-style&lt;/code&gt;옵션을 추가하면 ALT에 포함된 스타일 값을 가지고 렌더링을 한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;imageStyle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그러면 다음과 같이 HTML 코드로 변환이 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;img&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://cfile23.uf.tistory.com/image/222B154153A3916F292543&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;style=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;width:320px;&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;alt=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;아이폰화면 이미지&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;title=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;아이폰화면&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://cfile23.uf.tistory.com/image/222B154153A3916F292543&quot; alt=&quot;아이폰화면 이미지 {width:320px;}&quot; title=&quot;아이폰화면&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;결론&quot;&gt;결론&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;IMG&lt;/code&gt;에서 &amp;#39;alt&amp;#39; 속성은 화면에 이미지가 나타나지 않을 경우 이미지를 설명하는 속성이다. 이 이미지의 속성에 이미지의 &lt;code&gt;style&lt;/code&gt;에 관한 설명을 추가하는 것은 의미적으로도 이미지를 더욱 잘 설명하는 것이라 생각했다. 그리고 Markdown에는 이미지에 대한 설명이 있고 HTML으로 변환이 되었을때 이미지에 스타일이 적용되면서 alt는 속성을 제외한 문자열만 나타나도록 했다. Markdown을 HTML으로 변환하는데 크게 불편함은 없지만 현재 Retina Display를 사용하는 경우 이미지의 크기 때문에 문제가 발생해서 &lt;a href=&quot;mailto:mark2html@0.0.4&quot;&gt;mark2html@0.0.4&lt;/a&gt; 버전에서는 &lt;code&gt;-imageStyle&lt;/code&gt; 옵션을 추가하게 되었다.&lt;/p&gt;

&lt;h1 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Tue, 29 Jul 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/mark2html/mark2html-v.0.0.4-upgrade.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/mark2html/mark2html-v.0.0.4-upgrade.html</guid>
        
        
        <category>mark2html</category>
        
      </item>
    
      <item>
        <title>mark2html을 이용하여 Markdown 파일을 HTML 파일로 변환</title>
        <description>&lt;h1 id=&quot;mark2html-소개&quot;&gt;mark2html 소개&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;http://saltfactory.net/mark2html/&quot;&gt;mark2html&lt;/a&gt;는 Markdown 파일을 html 파일로 변환시켜주는 모듈이자 작은 프로그램이다. makr2html을 사용하여 HTML으로 변화할 때 Markdown에 포함된 이미지 파일을 HTML 파일의 경로에 함께 복하하거나 이미지를 datauri로 변환시켜 포함시켜주는 기능을 가지고 있다. mark2html은  Node.js 프로그램에 상용할 수 있는 모듈과 명령어로 사용할 수 있게 CLI 설치가 가능하다. HTML 입력을 요구하는 블로그에 Markdown 파일을 포스팅할 때 mark2html을 유용하게 사용할 수 있다.&lt;/p&gt;

&lt;h2 id=&quot;mark2html-개발-배경&quot;&gt;mark2html 개발 배경&lt;/h2&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;makr2html&lt;/em&gt;&lt;/strong&gt;를 개발하게 된 이유는 개인적으로 진행하고 있는 &lt;strong&gt;&lt;em&gt;Markdown으로 Tistory 블로그 포스팅하기&lt;/em&gt;&lt;/strong&gt; 를 위해서 만들어졌다. github를 사용할 일이 많아지면서 Markdown 문서를 작성할 일이 많아졌는데 그러면서 Markdown이 문서를 작성하는데 정말 편리한 포멧이라는 것을 알게 되었다.
그래서 Markdown을 사용하여 Tistory에 글을 작성하려고 하는데 몇가지 문제점 때문에 단순하게 사용할수는 없다는 결론을 내렸다.&lt;/p&gt;

&lt;p&gt;Tistory에서 Markdown을 작성하면 다음과 같은 문제를 겪게 된다.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Markdown 에디터가 없다&lt;/strong&gt; : &lt;a href=&quot;http://tumblr.com&quot;&gt;Tumblr&lt;/a&gt;에서는 웹에서 글을 작성할 때 Markdown 에디터를 통해서 글을 작성할 수 있다.
그렇기 때문에 사용자는 웹에서 HTML를 변경하지 않고 Markdown 마커를 가지고 바로 글을 작성할 수 있다.
하지만 Tistory는 WYSIWYG 에디터를 사용하기 때문에 HTML 입력을 사용한다.
이러한 이유 때문에 Markdown을 WYSIWYG이 아닌 HTML 모드로 입력을 하게되면 일반 plan text로 저장이 되어 버린다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;Client-side JavaScript Markdown rendering Library 필요&lt;/strong&gt; : Tistory는 Daum editor를 사용하고 있는데 Markdown 문서를 WYSIWYG이 아닌 html 모드로 입력하게 되면 화면에 나타날때 Markdown 문서가 HTML으로 변환되지 않은 plan text가 바로 나타나버리게 된다. 그래서 서버가 아닌 브라우저에서 나타날때 HTML 코드로 변화시키는 client-side javascript markdown rendering library가 필요하다. 예를 들어 &lt;a href=&quot;https://github.com/chjj/marked&quot;&gt;marked&lt;/a&gt; 와 같은 라이브러리를 사용해야한다. 이것은 네트워크로 JavaScript 라이브러리 덩어리를 다운받게 해야한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;preloaded meta open graph property&lt;/strong&gt; : Tistory는 &lt;a href=&quot;http://ogp.me/&quot;&gt;open graph&lt;/a&gt; 지원을 위해서 웹 페이지가 열릴 때 해당 글의 내용을 미리 &lt;code&gt;&amp;lt;meta name=&amp;quot;og:&amp;quot;&amp;gt;&lt;/code&gt;로 만들고 웹 페이지를 렌더링하는데 이러한 이유 때문에 html 모드에서 Markdown 형식으로 글을 작성하고 Client-side에서 HTML 문서로 렌더링을 하게되면 open graph에 사용하는 meta 정보들이 Markdown의 마커들이 붙어 있는채 만들어져 버리는 문제가 발생한다.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;HTML 모드로 작성하면 파일 업로드를 할 수 없다&lt;/strong&gt; : Tistory에서 Markdown으로 글을 작성해서 올리려면 html 모드로 글을 작성해야하는데 이 모드에서는 파일 업로드를 할 수 없는 문제가 있다. Tistory에서는 Daum editor를 사용해야지만 사진을 올릴 수 있기 때문에 Markdown에 필요한 이미지들은 모두 외부링크로 해야하는 문제가 있다.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;이러한 이유 때문에 Markdown을 사용해서 Tistory에 글을 올리려고 한다면 로컬에서 Markdown을 HTML으로 변화시키고 변화시킨 HTML 코드를 포스팅해야 한다는 결론을 내렸다. 하지만 기존의  Makrkdown 렌더링 모듈은 일반적인 기능만 가지고 있었다. Tistory에 Markdown으로 글을 작성할때는 html 모드로 작성해야하고 HTML 모드로 작성하면 이미지를 업로드할 수 없기 때문에 문서 안의 이미지들을 파일이 아닌 datauri로 변경해서 렌더링하는 기능이 필요했는데 이런 기능을 가지고 있는 모듈은 없어서 &lt;strong&gt;&lt;em&gt;mark2html&lt;/em&gt;&lt;/strong&gt; 모듈을 직접 만들기로 했다.&lt;/p&gt;

&lt;h2 id=&quot;mark2html-특징&quot;&gt;mark2html 특징&lt;/h2&gt;

&lt;p&gt;mark2html은 다음과 같은 특징이 있다.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Markdown 파일을 HTML 파일로 변환한다.&lt;/li&gt;
&lt;li&gt;파일 변환할 때 파일 안에 포함되어 있는 이미지 파일을 HTML 파일이 만들어지는 곳으로 복사한다.&lt;/li&gt;
&lt;li&gt;파일을 변환할 때 파일 안에 포함되어 있는 이미지 파일을 HTML 파일을 만들 때 datauri로 변환해서 만든다.&lt;/li&gt;
&lt;li&gt;Markdown 파일 안에 포함되어 있는 이미지 파일을 datauri로 변환해서 적용된 Markdown 파일을 HTML 파일이 만들어지는 곳에 함께 복사본을 만든다.&lt;/li&gt;
&lt;li&gt;Node.js 모듈과 CLI(Command Line Interface)를 지원한다.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;mark2html-내부-모듈&quot;&gt;mark2html 내부 모듈&lt;/h2&gt;

&lt;p&gt;가장 처음 한 일은 Markdown 렌더링할 때 필요한 모듈을 찾는 것이였다. Markdown parser 모듈을 찾을 때 &lt;a href=&quot;https://help.github.com/articles/github-flavored-markdown&quot;&gt;Github Flavored Markdown&lt;/a&gt;을 지원하는 모듈을 찾았다. GFM(Github Flavoed Markdown)은 기존의 Markdown의 부족한 포멧을 github에서 지원하는 문법인데 사용하는 대부분의 Markdown 문서들이 GFM를 사용하고 있기 때문이였다.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/chjj/marked&quot;&gt;marked&lt;/a&gt;:  Markdown parser와 compiler 모듈이다. 이 모듈은 다른 markdown과 달리 lexer 인터페이스를 제공한다. 실제 mark2html에서 이 모듈을 사용해 custom 하게 HTML 코드를 만드는 모듈을 따로 만들었다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/rvagg/node-pygmentize-bundled&quot;&gt;pygmentize-bundle&lt;/a&gt;: GMF의 syntax highlight를 렌더링하기 위한 모듈이다. github에서는 &lt;a href=&quot;http://pygments.org&quot;&gt;pygments&lt;/a&gt;를 사용해서 Markdown 안에 있는 code block을 코드를 syntax highlighing을 적용하는데 Node.js 모듈 중에서 pygments를 사용할 수 있게 wrapping한 것이 이 모듈이다.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://highlightjs.org&quot;&gt;highight.js&lt;/a&gt;: Node.js의 강점이 JavaScript 라이브러리를 사용할 수 있는 것이데, 좀 더 화려한 syntax highlighting style을 사용하기 위해서 pygments 뿐만아니라 highight.js를 사용할 수 있게 이 모듈을 사용했다.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;mark2html-사용방법&quot;&gt;mark2html 사용방법&lt;/h2&gt;

&lt;p&gt;mark2html은 크게 Node.js 모듈로 사용하는 방법과 CLI로 사용하는 방법이 있다.&lt;/p&gt;

&lt;h3 id=&quot;node.js-모듈로-사용하기&quot;&gt;Node.js 모듈로 사용하기&lt;/h3&gt;

&lt;p&gt;mark2html을 사용하려는 프로젝트 안에서 &lt;code&gt;npm&lt;/code&gt;으로 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install mark2html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;설치가 완료되면 &lt;code&gt;require&lt;/code&gt;를 사용해서 모듈을  로드하고 mark2html에 필요한 옵션을 지정해서 &lt;code&gt;mark2html.convert(options)&lt;/code&gt;를 한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;mark2html&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mark2html&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/Users/saltfactory/Dropbox/Blog/posts/2014-07-28-test-mark2html.md&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Markdown 파일경로&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;destDir&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/Users/saltfactory/Dropbox/Blog/output&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//HTML 파일이 복사되는 디렉토리 경로&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;imageCopy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Makrkdown 파일에 포함된 이미지를 destDir에 복사&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;datauri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//HTML을 생성할 때 Markdown 파일 안의 이미지를 datauri로 변환해서 생성&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;markdownCopy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;//Markdown 파일도 destDir에 함께 복사&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;markdownDatauri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;c1&quot;&gt;//Markdown 파일을 복사할 때 파일안의 이미지를 datauri로 변환해서 복사&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;highlight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;    &lt;span class=&quot;c1&quot;&gt;//pygments로 syntax highlighting, 1:pygments, 2:hightlight.js&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;mark2html&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;convert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;cli-사용하기&quot;&gt;CLI 사용하기&lt;/h3&gt;

&lt;p&gt;mark2html을 CLI로 사용하기 위해서는 &lt;code&gt;npm install -g&lt;/code&gt;로 설치를 하고 터미널에서 &lt;code&gt;mark2html&lt;/code&gt; 명령어를 사용하면 된다. &lt;code&gt;mark2html&lt;/code&gt; 명령어를 사용할 때도 옵션을 지정할 수 있다. 자세한 옵션은 &lt;a href=&quot;https://github.com/saltfactory/mark2html#mark2html-%EB%AA%85%EB%A0%B9%EC%96%B4-%EC%98%B5%EC%85%98&quot;&gt;명령어 옵션&lt;/a&gt;을 참조하면 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install -g mark2html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;mark2html -s /Users/saltfactory/Dropbox/Blog/posts/2014-07-28-test-mark2html.md \
-d /Users/saltfactory/Dropbox/Blog/output \
-img -md -datauri -mdatauri -code 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;글로벌-옵션-설정&quot;&gt;글로벌 옵션 설정&lt;/h3&gt;

&lt;p&gt;mark2html은 옵션을 사용해서 Markdown 파일을 HTML으로 변환 시킨다. 하지만 매번 같은 옵션을 사용하려고 옵션 값을 변수에 지정하거나 명령어 옵션을 사용하면 불편함을 느낄 것이다. 그래서 컴퓨터에서 사용할 수 있는 글로벌 옵션 설정 파일을 만들어서 기본적인 옵션을 추가해 두면 된다.&lt;/p&gt;

&lt;p&gt;글로벌 옵션 설정 파일은 &lt;code&gt;$HOME/.mark2html.json&lt;/code&gt; 에 다음과 같이 저장할 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;destDir&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;/Users/saltfactory/Dropbox/Blog/output&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;subDir&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;imageCopy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;datauri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;markdownCopy&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;markdownDatauri&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;highlight&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;글로벌 옵션 설정 파일을 만들어둔 상태에서 옵션을 추가적으로 사용할 수 있다. 만약 글로벌 옵션 설정 파일이 있는데 추가적으로 옵션을 사용하게 되면 없는 옵션은 추가가 될 것이고, 파일에 존재하는 옵션이 있다면 추가적으로 사용한 옵션값이 적용이 될 것이다.&lt;/p&gt;

&lt;h2 id=&quot;결론&quot;&gt;결론&lt;/h2&gt;

&lt;p&gt;mark2html은 Markdown 파일을 HTML 파일로 만들어주는 모듈이다. &lt;code&gt;npm&lt;/code&gt; 글로벌 설치를 하면 &lt;code&gt;mark2html&lt;/code&gt; 명령어를 사용할 수 있다. mark2html은 단순히 Markdown 파일을 HTML으로 변환 시키는 것 뿐만 아니라 Markdown 파일안에 포함되어 있는 이미지를 처리할 수 있는 기능이 가지고 있다. 파일 안에 존재하는 이미지를 destDir에 복사하거나 이미지 파일을 사용하지 못하는 사이트에 datauri로 변환 시키는 기능도 포함하고 있다.
지금 이 글도 mark2html을 사용해서 Markdown으로 작성된 문서를 HTML으로 변환시켜 포스팅 될 것이다. Tistory에 글을 작성할 때 Markdown을 사용하기 위해서는 HTML 모드로 편집기를 사용해야하는데, 이때 이미지를 첨부할 수 없는 문제가 있다. 이때 mark2html을 사용해서 HTML으로 변환할 때 이미지를 datauri로 만들어서 HTML 파일 안에 포함시키면 된다. mark2html은 아직 개발단계이지만 Markdown을 사용해서 Tistory나  HTML 입력 모드를 지원하는 블로그에 글을 포스팅하고 싶을때 사용하면 유용할 것으로 생각된다.&lt;/p&gt;

&lt;h1 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Mon, 28 Jul 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/mark2html/using-mark2html.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/mark2html/using-mark2html.html</guid>
        
        
        <category>mark2html</category>
        
      </item>
    
      <item>
        <title>passport-tistory와 express를 사용하여 Tistory 인증 구현</title>
        <description>&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;&lt;a href=&quot;https://github.com/saltfactory/passport-tistory&quot;&gt;passport-tistory&lt;/a&gt;를 사용하여 Node.js 로 Tistory 오픈 API를 사용하는 방법을 소개한다. passport-tistory는 Node.js로 만들어진 Tistory 오픈 API 인증모듈이다.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;passport-tistory?&quot;&gt;passport-tistory?&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/saltfactory/passport-tistory&quot;&gt;passport-tistory&lt;/a&gt; 는 passort의 많은 인증 strategy의 하나로 OAuth 2.0 기반의 인증방식을 사용하여 Tistory의 인증과정을 간단하게 처리할 수 있는 Tistory 오픈 API 인증모듈이다. passport-node의 구현 방법과 설명에 대해서는 “&lt;a href=&quot;http://blog.saltfactory.net/249&quot;&gt;passport-tistory Node.js Tistory 인증 모듈&lt;/a&gt;” 포스팅 했었다.&lt;/p&gt;

&lt;p&gt;이번 포스팅에서는 Node.js로 웹 서비스를 만들때 passport-tistory를 사용하여 인증을 처리와 Tistory 오픈 API를 사용할 수 있는 방법에 대해서 소개하려고 한다.&lt;/p&gt;

&lt;h2 id=&quot;tistory-client-등록&quot;&gt;Tistory Client 등록&lt;/h2&gt;

&lt;p&gt;다른 API를 제공하는 서비스와 마찬가지로 Tistory도 Application을 관리할 수 있는 Dashboard를 제공하고 있다. 다른 서비스들과 다르게 Tistory는 Application을 &lt;strong&gt;&lt;em&gt;클라이언트&lt;/em&gt;&lt;/strong&gt; 라는 이름을 사용하고 있다. 오픈 API를 사용하기 위해서는 먼저 클라이언트로 등록을 해야한다. &lt;a href=&quot;http://www.tistory.com/guide/api/manage/register&quot;&gt;클라이언트 등록&lt;/a&gt; 을 하고 난 이후 만들어진 클라이언트를 관리하기 위해서는 &lt;a href=&quot;http://www.tistory.com/guide/api/manage/list&quot;&gt;클라이언트 관리&lt;/a&gt; 에서 만들어진 클라이언트를 관리할 수 있다.&lt;/p&gt;

&lt;p&gt;API에 관련해서는 두가지 문서를 제공하고 있는데 다음 링크에서 확인할 수 있다.
* &lt;a href=&quot;http://www.tistory.com/guide/api/index&quot;&gt;오픈 API 가이드&lt;/a&gt;
* &lt;a href=&quot;http://www.tistory.com/guide/api/oauth&quot;&gt;인증 가이드&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;이 포스팅에서는 passport-tistory를 상용하는 예제를 만들기 위해서 클라이언트를 하나 만들것이다. 이름은 TistoryAPIDemo로 새로운 &lt;a href=&quot;http://www.tistory.com/guide/api/manage/register&quot;&gt;클라이언트 등록&lt;/a&gt;을 하자.&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;필드명&lt;/th&gt;
&lt;th&gt;값&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;서비스 명&lt;/td&gt;
&lt;td&gt;TistoryAPIDemo&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;설명&lt;/td&gt;
&lt;td&gt;Tistory 오픈 API 사용 Demo&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;로고등록&lt;/td&gt;
&lt;td&gt;로고이미지 파일 경로&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;서비스 URL&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;http://127.0.0.1:3000&quot;&gt;http://127.0.0.1:3000&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;서비스 형태&lt;/td&gt;
&lt;td&gt;웹&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;서비스 권한&lt;/td&gt;
&lt;td&gt;읽기/쓰기&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CallBack 경로&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;http://127.0.0.1:3000/auth/tistory/callback&quot;&gt;http://127.0.0.1:3000/auth/tistory/callback&lt;/a&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;클라이언트를 등록하면 Client ID와 Secrete Key가 발급되는데 이 두가지 값을 &lt;code&gt;passport-tistory&lt;/code&gt;로 인증할 때 사용할 것이다.&lt;/p&gt;

&lt;h2 id=&quot;express-웹-프로젝트-생성&quot;&gt;express 웹 프로젝트 생성&lt;/h2&gt;

&lt;p&gt;OAuth 2.0 인증은 웹에서 인증하는 방법을 사용하기 때문에 반드시 웹 브라우저가 필요하고 웹 서비스를 사용해야한다.
간단하게 passport-tistory를 테스트하기 위해서 express를 사용해서 웹 프로젝트를 만들어보자. express는 npm으로 설치할 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install -g express
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 express 어플리케이션을 간단하게 만들어주는 express-generator를 설치하자 express-generator는 버전에 맞는 것을 설치하기 위해서 @version 옵션을 추가한다. 우리는 express4 버전으로 테스트를 하기 때문에 @4 를 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install -g express-generator@4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;express와 express-generator 설치가 모두 마쳤으면 express 프로젝트를 생성하고 생성한 디렉토리로 이동한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;express /tmp/TistoryAPIDemo &amp;amp;&amp;amp; cd /tm/TistoryAPIDemo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;프로젝트가 생성되면 dependences 모듈들을 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;express 프로젝트를 만들고 필요한 모듈을 모두 설치했으면 프로젝트 서버를 실행해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;bin/www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;서버가 실행되면 브라우저에서 &lt;a href=&quot;http://127.0.0.1:3000&quot;&gt;http://127.0.0.1:3000&lt;/a&gt; 을 열어보자. 다음과 같은 화면이 나타나면 정상적으로 express로 간단한 웹 프로젝트를 시작할 준비를 마쳤다.&lt;/p&gt;

&lt;h2 id=&quot;pasport-tistory-모듈-추가&quot;&gt;pasport-tistory 모듈 추가&lt;/h2&gt;

&lt;p&gt;프로젝트 디렉토리 안에는 패키지관리를 위한 package.json 파일이 존재할 것이다. 이 파일을 열어서 다음과 같이 &lt;code&gt;passport-tistory&lt;/code&gt; 모듈을 추가하자.
&lt;code&gt;passport-tistory&lt;/code&gt;모듈을 express의 미들웨어로 사용하기 위해서는 &lt;code&gt;express-session&lt;/code&gt;과 &lt;code&gt;passport&lt;/code&gt;이 추가적으로 필요하다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;name&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;TistoryAPIDemo&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;version&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;0.0.1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;private&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;scripts&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;start&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;node ./bin/www&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;express&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~4.2.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;static-favicon&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.0.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;morgan&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.0.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;cookie-parser&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.0.1&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;body-parser&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.0.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;debug&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.7.4&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;jade&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.3.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;quot;express-session&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;~&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;1.6.5&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.2.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport-tistory&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.1.0&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;package.json 을 저장하고 &lt;code&gt;npm install&lt;/code&gt; 명령어로 새로 추가한 &lt;strong&gt;&lt;em&gt;passport-tistory&lt;/em&gt;&lt;/strong&gt;를 설치한다.
&lt;code&gt;
npm intstall
&lt;/code&gt;&lt;/p&gt;

&lt;h2 id=&quot;라우팅-설정&quot;&gt;라우팅 설정&lt;/h2&gt;

&lt;p&gt;express의 사용방법은 이 포스팅에서 자세하게 설명하지는 않는다 만약 express를 처음 사용하는 개발자는 &lt;a href=&quot;http://expressjs.com/guide.html&quot;&gt;express 가이드&lt;/a&gt; 를 꼭 살펴보기 바란다.&lt;/p&gt;

&lt;p&gt;express는 routing 설정을 &lt;code&gt;app.js&lt;/code&gt;에 하게 되는데 우리는 다음과 같은 routing을 설정할 것이다. express4 부터는 기본적인 view engine이 jade를 사용하고 있다. 다음 표에 routing과 관련된 view 파일을 설명한다.&lt;/p&gt;

&lt;table&gt;&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;routing&lt;/th&gt;
&lt;th&gt;method&lt;/th&gt;
&lt;th&gt;설명&lt;/th&gt;
&lt;th&gt;view 파일&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;/&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;&lt;a href=&quot;http://127.0.0.1:3000/&quot;&gt;http://127.0.0.1:3000/&lt;/a&gt; URL로 요청이 들어올 때, 만약 로그인이 되어 있으면 profile 정보를 가져와서 보여준다&lt;/td&gt;
&lt;td&gt;index.jade&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/account&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;/account URL로 요청이 들어올 때, profile 정보를 가져와서 보여준다&lt;/td&gt;
&lt;td&gt;account.jade&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/login&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;Tistory Login을 할 수 있는 페이지를 보여준다&lt;/td&gt;
&lt;td&gt;login.jade&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/logout&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;로그 아웃을 하고 / URL로 돌아간다&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/auth/tistory&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;Tistory 인증 페이지를 호출한다&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;/auth/tistory/callback&lt;/td&gt;
&lt;td&gt;GET&lt;/td&gt;
&lt;td&gt;Tistory 인증 후 callback 되는 URL로 인증이 성공적으로 이루어지면 / URL로 돌아간다&lt;/td&gt;
&lt;td&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;

&lt;p&gt;위의 라우팅을 &lt;code&gt;app.js&lt;/code&gt; 에 다음과 같이 기술할 수 있다. routing에 관련된 특별한 프로세스를 제외하고 단순히 URL 요청이 들어오면 view 과 연결되는 부분을 정의했다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// app.use(&amp;#39;/&amp;#39;, routes);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// app.use(&amp;#39;/users&amp;#39;, users);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;index&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/account&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;account&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;login&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/logout&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;logout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/auth/tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// Titsory 인증 페이지로 이동&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/auth/tistory/callback&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;view-파일&quot;&gt;view 파일&lt;/h2&gt;

&lt;p&gt;express의 기본 view engine은 &lt;a href=&quot;http://jade-lang.com/api/&quot;&gt;jade&lt;/a&gt; 를 사용한다. jade에 대한 설명은 이 포스팅에서는 하지 않기 때문에 &lt;a href=&quot;http://jade-lang.com/api/&quot;&gt;jade 가이드&lt;/a&gt; 문서를 찾아보기 바란다.
jade는 HTML의 복잡한 태그를 단순화시켰고 태그의 계층구조를 들여쓰기로 표현한다. 뿐만 아니라 인터폴레이션이 가능하고 모델을 분리해서 뷰에서 모델객체를 접근할 수 있도록 설계되어져 있다.
우리는 routing에서 필요한 뷰 파일을 만들것이다. 단순히 정보를 출력하는 목적으로 스타일은 제외하였다. 뷰 파일은 모두 다음과 같이 필요하다.
프로젝트 디렉토리 안에 &lt;code&gt;views/&lt;/code&gt; 라는 디렉토리 안에 다음과 같이 &lt;code&gt;.jade&lt;/code&gt; 파일을 생성한다.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;layout.jade&lt;/code&gt;는 뷰의 전체 레이아웃을 담당한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jade&quot; data-lang=&quot;jade&quot;&gt;&lt;span class=&quot;c&quot;&gt;// filename: layout.jade&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;doctype&lt;/span&gt; html
&lt;span class=&quot;nt&quot;&gt;html&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;head&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;title&lt;/span&gt; Passport-Tistory Example
  &lt;span class=&quot;nt&quot;&gt;body&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;if&lt;/span&gt; !user
      &lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;) Home
        | |
        &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;) Log in
    &lt;span class=&quot;nt&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;) Home
        | |
        &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/account&amp;#39;&lt;/span&gt;) Account
        | |
        &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/logout&amp;#39;&lt;/span&gt;) Logout

    &lt;span class=&quot;nt&quot;&gt;block&lt;/span&gt; content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;index.jade&lt;/code&gt;는 로그인이 되면 사용자의 정보를 출력한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jade&quot; data-lang=&quot;jade&quot;&gt;&lt;span class=&quot;c&quot;&gt;// filename : index.jade&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;extends&lt;/span&gt; layout

&lt;span class=&quot;nt&quot;&gt;block&lt;/span&gt; content
    &lt;span class=&quot;nt&quot;&gt;if&lt;/span&gt; (!user)
        &lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt; Welcome! Please Login.
    &lt;span class=&quot;nt&quot;&gt;else&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;h2&lt;/span&gt; Hello &amp;quot;&lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;account.jade&lt;/code&gt;는 로그인된 사용자의 정보를 출력한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jade&quot; data-lang=&quot;jade&quot;&gt;&lt;span class=&quot;c&quot;&gt;// filename : account.jade&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;extends&lt;/span&gt; layout
&lt;span class=&quot;nt&quot;&gt;block&lt;/span&gt; content
    &lt;span class=&quot;nt&quot;&gt;p&lt;/span&gt; Username: &lt;span class=&quot;si&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;login.jade&lt;/code&gt;는 tistory로 로그인하는 인증창으로 연결할 수 있는 링크를 출력한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-jade&quot; data-lang=&quot;jade&quot;&gt;&lt;span class=&quot;c&quot;&gt;// filename : login.jade&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;extends&lt;/span&gt; layout
&lt;span class=&quot;nt&quot;&gt;block&lt;/span&gt; content
    &lt;span class=&quot;nt&quot;&gt;a&lt;/span&gt;(&lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;#39;/auth/tistory&amp;#39;&lt;/span&gt;) Login with Tistory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;passport-tistory-설정&quot;&gt;passport-tistory 설정&lt;/h2&gt;

&lt;p&gt;&lt;code&gt;app.js&lt;/code&gt;에 라우팅 설정이 끝나면 &lt;code&gt;passport&lt;/code&gt;가 제공하는 인증과 세션을 사용하기 위해서 &lt;code&gt;passport&lt;/code&gt;를 함께 &amp;#39;require&amp;#39;한다.
&lt;code&gt;passport-tistory&lt;/code&gt;의 설정을 진행한다. 우리는 앞에서 &lt;code&gt;package.json&lt;/code&gt;에 passport-tistory를 추가해서 npm으로 설치를 완료했다.
&lt;code&gt;passport-tistory&lt;/code&gt;에서 우리가 사용할 것은 Strategy 이기 때문에 다음과 같이 &lt;code&gt;require&lt;/code&gt;를 할 때 &lt;code&gt;Strategy&lt;/code&gt;를 사용할 수 있게 한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;express&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;express&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// passport-tistory 설정&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음은 Tistory 클라이언트를 추가하면서 발급받은 Client ID와 Secrete Key 그리고 클라이언트의 Callback URL을 지정한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// passport-tistory 설정&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Tistory 클라이언트 인증키&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_ID&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;2b0f4314438b5cfcb4a7e682cc9d5af7&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_SECRET&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;2b0f4314438b5cfcb4a7e682cc9d5af78ef8bbc96622d6088e078d88513e0db62e66c8cc&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_CALLBACK&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;http://127.0.0.1:3000/auth/tistory/callback&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음은 &lt;code&gt;passport&lt;/code&gt;와 express의 연결 작업을 하자. &lt;code&gt;passport&lt;/code&gt;를 상요하여 인증이 마치면 session을 사용하는데
&lt;code&gt;passport-tistory&lt;/code&gt;를 express의 미들웨어로 사용하기 위해서는 &lt;code&gt;passport&lt;/code&gt;의 세션을 express에서 사용하기 위해
&lt;code&gt;express-session&lt;/code&gt; 모듈이 필요하다. 그리고 &lt;code&gt;express-sesion&lt;/code&gt;과 &lt;code&gt;passport&lt;/code&gt;를 express의 미들웨어로 사용할 수 있게 &lt;code&gt;app.use()&lt;/code&gt;로 등록한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;session&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;express-session&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;secret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;mysecret&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;saveUninitialized&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;resave&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}));&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;initialize&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;session&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;());&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 &lt;code&gt;passport&lt;/code&gt;에서 &lt;code&gt;passport-tistory&lt;/code&gt;를 사용할 수 있게하는 설정을 한다. &lt;code&gt;passport&lt;/code&gt;는 인증처리가 마치면 자동으로 Profile을 가지고 user 정보를 만든다.
우리는 &lt;code&gt;passport&lt;/code&gt;에 &lt;code&gt;passport-tistory&lt;/code&gt;의 Strategy를 사용하기 위해서 &lt;code&gt;passport.use()&lt;/code&gt;로 &lt;code&gt;TistoryStrategy&lt;/code&gt;를 사용한다.
우리는 로그인 페이지에서 &lt;strong&gt;&lt;em&gt;Login with Tistory&lt;/em&gt;&lt;/strong&gt; 링크를 누르면 Tistory의 인증 페이지로 인증처리를 요청할 것이다.
요청이 마치면 우리가 Client를 등록할 때 함께 등록한 Client CallbackURL로 결과를 callback하고 인증처리가 마치면 access_token을 획득해서 블로그 정보를 가져온다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;serializeUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;user&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;deserializeUser&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;obj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;clientID&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_ID&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;clientSecret&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_SECRET&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;callbackURL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TISTORY_CLIENT_CALLBACK&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;refreshToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// access_token을 확인하기 위해서 다음 코드를 입력했다.&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;accessToken: &amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;nextTick&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/auth/tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;authenticate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;// Tistory 인증 페이지로 이동&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;app&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/auth/tistory/callback&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;passport&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;authenticate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;failureRedirect&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/login&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}),&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;req&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;redirect&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;요약&quot;&gt;요약&lt;/h2&gt;

&lt;p&gt;위의 과정을 간략하게 요약하면 다음과 같은 과정으로 진행했다.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Tistory 사이트에서 Tistory Open API를 사용할 새로운 Client를 등록하여 Client ID와 Secrete Key를 발급 받는다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;express&lt;/code&gt;와 &lt;code&gt;express-generator&lt;/code&gt; 를 npm으로 global 모드(&lt;code&gt;npm install -g&lt;/code&gt;)로 설치한다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;express-generator&lt;/code&gt; 명령어로 express 웹 프로젝트를 생성한다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;package.json&lt;/code&gt; 에 필요한 모듈을 기술하고 &lt;code&gt;npm install&lt;/code&gt;로 설치한다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;app.js&lt;/code&gt;의 라우팅을 설정한다.&lt;/li&gt;
&lt;li&gt;express에서 라우팅에 매칭하는 view 파일들을 만든다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;app.js&lt;/code&gt;에 &amp;#39;passport&amp;#39;와 &amp;#39;express-session&amp;#39;을 미들웨어로 사용할 수 있게 &lt;code&gt;app.use()&lt;/code&gt;로 등록한다.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;passport&lt;/code&gt;에 &lt;code&gt;passport-express&lt;/code&gt;를 상용할 수 있게 설정한다.&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;실험결과&quot;&gt;실험결과&lt;/h2&gt;

&lt;p&gt;위의 과정이 모두 마치면 다음과 같이 express 프로젝트의 서버를 실행하여 테스트를 해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;node bin/www
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:3000&quot;&gt;http://127.0.0.1:3000&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile4.uf.tistory.com/image/2635054653D0C929103F26&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.43 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:3000/login&quot;&gt;http://127.0.0.1:3000/login&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile4.uf.tistory.com/image/26014C3C53D0C92924E126&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.46 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:300/login&quot;&gt;http://127.0.0.1:300/login&lt;/a&gt; 에서 &lt;strong&gt;&lt;em&gt;Login with Tistory&lt;/em&gt;&lt;/strong&gt; 링크를 눌렀을 때&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile26.uf.tistory.com/image/263FC93453D0C9293A4B9B&quot; alt=&quot;Screen Shot 2014-07-18 at 10.07.48 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile30.uf.tistory.com/image/254D4C4353D0C92922FC37&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.49 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;Tistory에서 클라이언트 인증이 모두 마치고 다시 callback URL로 돌아왔을 때,&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile9.uf.tistory.com/image/27244B3953D0C9293358B7&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.52 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:3000/account&quot;&gt;http://127.0.0.1:3000/account&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile2.uf.tistory.com/image/2309B13C53D0C92A1B4A04&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.56 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:3000/logout&quot;&gt;http://127.0.0.1:3000/logout&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile22.uf.tistory.com/image/2746824353D0C92A31DCB9&quot; alt=&quot;Screen Shot 2014-07-18 at 9.54.43 AM.png&quot;&gt;&lt;/p&gt;

&lt;p&gt;실험이 이상없이 진행되면 이제부터 access_token 를 획득하였기 때문에 Tistory 오픈 API를 사용할 수 있다. 획득한 access_token은 &lt;code&gt;app.js&lt;/code&gt;에 &lt;code&gt;passport.use()&lt;/code&gt; 의 콜백함수에서 확인할 수 있다.
access_token을 가지고 Tistory 오픈 API를 사용하는 방법은 다음 포스팅에서 소개하겠다.&lt;/p&gt;

&lt;h1 id=&quot;결론&quot;&gt;결론&lt;/h1&gt;

&lt;p&gt;오픈 API를 사용하기 전에 항성 거쳐야할 과정이 바로 OAuth 인증이다. 만약 개인이 OAuth 인증 과정을 처리하는 프로그램을 작성한다면 아주 복잡한 과정을 프로그램으로 구현해야한다.
Node.js에서는 프로그램을 정말 간결하게 만들어줄 수 있는 획기적인 모듈들이 많은데 &lt;code&gt;passort&lt;/code&gt; 라는 모듈이 그러하다. &lt;code&gt;passport&lt;/code&gt;는 복잡한 인증과정을 추상적으로 상용할 수 있는 방법을 제공한다.
패스워드 인증부터 OAuth 1.0, 1.0a 그리고 2.0 까지 거의 모든 인증방법을 추상화하여 만들어 두었다. 그리고 서비스의 인증는 서비스마다 조금씩 다르기 때문에 &lt;code&gt;Strategy&lt;/code&gt;를 사용하는 개념으로 만들어서
여러가지 다른 서비스의 &lt;code&gt;Strategy&lt;/code&gt;를 사용하여 인증할 수 있게 만들어 두었다. 그래서 &lt;code&gt;passport&lt;/code&gt;를 사용하는 &lt;code&gt;Strategy&lt;/code&gt;가 약 140개가 넘는다.&lt;/p&gt;

&lt;p&gt;Tistory 역시 오픈 API를 사용하기 위해서 OAuth 2.0 인증을 처리해야하는데 &lt;code&gt;passport&lt;/code&gt;를 사용하여 인증할 수 있는 Strategy를 &lt;a href=&quot;https://github.com/saltfactory/passport-tistory&quot;&gt;passport-tistory&lt;/a&gt;라는 이름으로 구현하였다.
그리고 &lt;code&gt;passport-tistory&lt;/code&gt;는 express로 웹서비스를 개발할 때 미들웨어로 사용하여 인증 과정을 간단하게 처리할 수 있다는 것을 이번 포스팅에서 소개했다.
&lt;code&gt;passport-tistory&lt;/code&gt; 는 현재 &lt;code&gt;0.1.0&lt;/code&gt; 버전이지만 꽤 안정적이고 앞으로도 지속적으로 업데이트를 할 예정이다. Node.js로 Tistory 어플리케이션을 만들거나,
Tistory의 오픈 API를 사용하기 위해서 OAuth 2.0 인증 후 access_token을 획득하고자 하는 개발자와 연구원들에게 도움이 되길 바란다.&lt;/p&gt;

&lt;h1 id=&quot;참고자료&quot;&gt;참고자료&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.saltfactory.net/249&quot;&gt;http://blog.saltfactory.net/249&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.outsider.ne.kr/829&quot;&gt;http://blog.outsider.ne.kr/829&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/outsideris/passport-me2day&quot;&gt;https://github.com/outsideris/passport-me2day&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/rotoshine/passport-kakao&quot;&gt;https://github.com/rotoshine/passport-kakao&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/visionmedia/express&quot;&gt;https://github.com/visionmedia/express&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 16 Jul 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/passport-tistory/using-passport-tistory-in-express.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/passport-tistory/using-passport-tistory-in-express.html</guid>
        
        
        <category>passport-tistory</category>
        
      </item>
    
      <item>
        <title>Tistory 오픈 API 인증 모듈 passport-tistory 소개</title>
        <description>&lt;h1 id=&quot;passport-tistory&quot;&gt;passport-tistory&lt;/h1&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;passport-tistory 는 Node.js 어플리케이션을 만들거나 티스토리 오픈 API 인증을 처리하는데 쉽고 편리하게 도와주는 인증처리 모듈이다.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/saltfactory/passport-tistory&quot;&gt;passport-tistory&lt;/a&gt;는 npm을 사용하여 설치할 수 있다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install passport-tistory
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Tistory는 오픈 API를 제공하고 있다. 오픈 API를 사용하면 다양한 어플리케이션을 만들거사 서비스를 만들수 있기 때문에 개발자들은 오픈 API를 사용하고 싶어 한다. 하지만 오픈 API를 사용할때, 가정 먼저 걸림돌이 되는 것이 바로 인증 문제인다. 여러 사람이 사용하는 오픈 API는 보안문제 때문에 password 인증으로 할 수 없기 때문에 이젠 오픈 API의 인증에는 거의 표준이 되어 버리는 OAuth 인증을 사용하고 있다. Tistory 또한 OAuth 인증을 사용하는데 OAuth2.0 을 사용하고 있다.&lt;/p&gt;

&lt;h2 id=&quot;oauth-2.0&quot;&gt;OAuth 2.0&lt;/h2&gt;

&lt;p&gt;오픈 API 의 인증에 표준화인 OAuth2.0을 Tistory에서도 인증처리를 하기 위해서 사용하고 있다. &lt;a href=&quot;http://oauth.net/2/&quot;&gt;OAuth 2.0&lt;/a&gt;의 스펙은 &lt;a href=&quot;http://tools.ietf.org/html/rfc6749&quot;&gt;rfc6794&lt;/a&gt;에 정의가 되어 있다. 한국어로 쉽게 설명이 되어 있는 곳이 있는데 &lt;a href=&quot;https://twitter.com/tebica&quot;&gt;@tebica&lt;/a&gt; 님께서 작성하신 &lt;a href=&quot;http://earlybird.kr/1584&quot;&gt;OAUTH 2.0 - OPEN API 인증을 위한 만능 도구상자&lt;/a&gt; 글을 읽어보면 OAuth 인증에 관한 전반적인 이해와 2.0에 대해서 쉽게 이해할 수 있다.&lt;/p&gt;

&lt;h2 id=&quot;passport&quot;&gt;Passport&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;data:image/png;base64,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&quot; alt=&quot;passport-log&quot;&gt;&lt;/p&gt;

&lt;p&gt;Node.js의 모듈은 편리한 모듈가 참 많이 있다. 그 중에서 인증을 처리하기 위해서 가장 유명한 모듈인  &lt;a href=&quot;http://passportjs.org&quot;&gt;Passport&lt;/a&gt; 를 사용하면 local 인증부터 OAuth 인증까지 쉽게 구현할 수 있다. 더구나 passport는 140개 이상의 인증 strategy가 만들어져 있다. 여기에는 국내 개발자분들이 만들어 놓은 strategy도 있다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://twitter.com/Outsideris&quot;&gt;@Outsideris&lt;/a&gt; 님께서 만드신 &lt;a href=&quot;https://github.com/outsideris/passport-me2day&quot;&gt;passport-me2day&lt;/a&gt;는 me2day 서비스의 인증을 처리하기 위한 strategy 이고 &lt;a href=&quot;http://twitter.com/rotoshine&quot;&gt;@rotoshine&lt;/a&gt;님께서 만드신 &lt;a href=&quot;https://github.com/rotoshine/passport-kakao&quot;&gt;passport-kakao&lt;/a&gt; 는 kaka 서비스의 인증을 처리하기 위한 strategy 이다.&lt;/p&gt;

&lt;h1 id=&quot;passport-tistory-strategy-구현&quot;&gt;passport-tistory Strategy 구현&lt;/h1&gt;

&lt;p&gt;Passport는 모듈을 상속받아서 상세 구현을 할 수 있게 설계가 되어 있다. passport- 로 시작하는 모듈은 모두 Passport의 Strategy를 상속받아서 만들어진 것들이다.&lt;/p&gt;

&lt;h2 id=&quot;passport-oauth2&quot;&gt;passport-oauth2&lt;/h2&gt;

&lt;p&gt;OAuth2.0 인증을 처리하기 위해서 이미 passport-oauth2 strategy가 만들어져 있다. 그래서 OAuth2.0 인증을 처리하기 위해서 기본적으로 passport-oauth2를 상속받아서 서비스에 맞게 수정해주면 된다.&lt;/p&gt;

&lt;h2 id=&quot;package.json&quot;&gt;package.json&lt;/h2&gt;

&lt;p&gt;우리는 passport와 passport-oauth2 모듈이 필요하기 때문에 package.json을 다음과 같이 생성하였다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.2.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport-oauth2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.1.2&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;전체 소스는 github에서 &lt;a href=&quot;https://github.com/saltfactory/passport-tistory/blob/master/package.json&quot;&gt;package.json&lt;/a&gt; 확인할 수 있다.&lt;/p&gt;

&lt;h2 id=&quot;strategy.js-구현&quot;&gt;strategy.js  구현&lt;/h2&gt;

&lt;h3 id=&quot;passort-oauth2-상속&quot;&gt;passort-oauth2 상속&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/saltfactory/passport-tistory/blob/master/lib/passport-tistory/strategy.js&quot;&gt;strategy.js&lt;/a&gt;는 passport-oauth2를 상속받아서 구현할 수 있기 때문에 TistoryStrategy를 OAuth2Strategy를 상속받아서 만들었다. strategy를 상속받는 코드는 다음과 같이 &lt;code&gt;util.inherits()&lt;/code&gt;를 사용하면 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-oauth2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./profile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * TistoryStrategy 생성자&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @constructor&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// passport-oauth2 상속&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inherits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Expose `TistoryStrategy`.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;  
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;passport-aouth2의-인증처리-함수-호출&quot;&gt;passport-aouth2의 인증처리 함수 호출&lt;/h3&gt;

&lt;p&gt;passport-oauth2 모듈이 이미 OAuth 2.0 인증 프로세스를 구현해두었기 때문에 우리는 OAuth2Strategy의 인증처리하는 함수를 바로 호출하면 된다. 이것은 다음과 같이 &lt;code&gt;OAuth2Strategy.call()&lt;/code&gt;을 호출하면 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-oauth2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * TistoryStrategy 생성자&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @constructor&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// passport-oauth2 상속&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inherits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Expose `TistoryStrategy`.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;options-재정의&quot;&gt;options 재정의&lt;/h3&gt;

&lt;p&gt;passport-aouth2를 상속받아서 인증처리하는 함수를 사용할 수 있지만 인증처리를 위한 URL은 다시 정의를 해야한다.&lt;/p&gt;

&lt;p&gt;OAuth 2.0에는 인증처리를 위해서 크게 3가지 URL이 필요하다.
1. authorizationURL - 인증요청을 하는 URL
2. tokenURL - 최초 사용자 인증 후 어플리케이션에서 사용할 access_token을 요청하는 URL
3. callbackURL - OAuth 2.0의 인증 처리후 요청할 callback URL 이다.&lt;/p&gt;

&lt;p&gt;우리는 Tistory의 인증 API에 정의한 URL을 그대로 사용할 수 있게 했다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-oauth2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * TistoryStrategy 생성자&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @constructor&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;oauthHost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://www.tistory.com&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;authorizationURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;authorizationURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;oauthHost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/oauth/authorize&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt;  &lt;span class=&quot;nx&quot;&gt;oauthHost&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;/oauth/access_token&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;customHeaders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;customHeaders&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;customHeaders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;customHeaders&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;userAgent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;c1&quot;&gt;// 인증처리 호출&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// passport-oauth2 상속&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inherits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Expose `TistoryStrategy`.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;oauth2의-함수-override&quot;&gt;OAuth2의 함수 Override&lt;/h1&gt;

&lt;p&gt;보통은 passport-oauth2 을 상속받아서 OAuth 2.0 인증을 처리하기 위해서는 위의 코드로 되지만
Tistory의 인증은 access_token을 획득하기 위해서 access_key를 얻을 수 있는 페이지로 한번더 redirect를 한다는 것을 알게 되었다.
passport-oauth2는 oauth 모듈을 사용하는데 oauth2의 인증처리 루틴을 모두 http 모듈의 request를 사용해서 POST로 전송하는 것을 알게되었다.
이렇게 oauth 모듈의 post 처리와 Tistory의 redirect는 access_token을 획득할 때 301 moved permanently explained 에러를 발생하는 것을 확인했다.
소스 코드를 분석한 결과 passport-oauth에서 사용하고 있는 oauth2의 &lt;code&gt;_chooseHttpLibrary&lt;/code&gt;와 &lt;code&gt;getOAuthAccessToken&lt;/code&gt; 함수를 override 하였다.&lt;/p&gt;

&lt;h3 id=&quot;follow-redirects와-querystring-모듈-설치&quot;&gt;follow-redirects와 querystring 모듈 설치&lt;/h3&gt;

&lt;p&gt;우리는 redirect 문제를 해결하기 위해서 &lt;code&gt;follow-redirects&lt;/code&gt; 모듈을 설치할 것이고 redirect following은 GET으로만 사용할 수 있기 때문에 POST의 body로 요청한 것을 GET의 query string으로 변경하기 위해서 &lt;code&gt;querystring&lt;/code&gt; 모듈을 설치할 것이다.
이 두가지를 설치하기 위해서 &lt;code&gt;package.json&lt;/code&gt; 파일을 다음과 같이 수정한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-json&quot; data-lang=&quot;json&quot;&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;nt&quot;&gt;&amp;quot;dependencies&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.2.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;passport-oauth2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;~1.1.2&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;follow-redirects&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.0.3&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;quot;querystring&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;~0.2.0&amp;quot;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;
  &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;oauth2._choosehttplibrary()-함수-재정의&quot;&gt;oauth2._chooseHttpLibrary() 함수 재정의&lt;/h3&gt;

&lt;p&gt;&lt;code&gt;oauth2._chooseHttpLibrary()&lt;/code&gt;함수는 http나 https 요청을 처리하기 위해서 http 라이브리를 정의하는 함수이 이다.
우리가 지금 가지고 있는 문제는 redirect 문제 인데 이 문제를 해결하기 위해서 우리는 기존의 &lt;code&gt;require(&amp;#39;http&amp;#39;)&lt;/code&gt;를 사용하지 않고 redirect 페이지를 follow할 수 있는 follow-redirect 모듈로 교체할 것이다.&lt;/p&gt;

&lt;h3 id=&quot;oauth2.getoauthaccesstoken()-함수-재정의&quot;&gt;oauth2.getOAuthAccessToken() 함수 재정의&lt;/h3&gt;

&lt;p&gt;passport-oauth2에서 access_token을 획득하기 위해서 사용하고 있는 &lt;code&gt;oauth2.getOAuthAccessToken()&lt;/code&gt; 함수는 POST로 동작하고 있다. 하지만 http.request로 요청했을 때 page redirect된 것을 follow하기 위해서는 POST를 사용하면 안된다.
즉, page redirect following은 GET으로만 가능하다. 그래서 우리는 &lt;code&gt;oauth2.getOAuthAccessToken()&lt;/code&gt; 함수 안에서 POST의 body를 만드는 부분은 querystring으로 변경해서 url querystring을 만들어서 GET으로 request를 요청하는 것으로 교체하였다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;./profile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;querystring&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;querystring&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-oauth2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;follow-redirects&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;follow-redirects&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_oauth2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_chooseHttpLibrary&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;parsedUrl&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http_library&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;https&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;parsedUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;protocol&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;!=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;https:&amp;quot;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;http_library&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;http_library&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_oauth2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;getOAuthAccessToken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{};&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_id&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_clientId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;client_secret&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_clientSecret&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;codeParam&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;grant_type&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;?&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;refresh_token&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;code&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;codeParam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;code&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;


    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_getAccessTokenUrl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;?&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;querystring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;stringify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{},&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;response&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
      &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// As of http://tools.ietf.org/html/draft-ietf-oauth-v2-07&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// responses should be in JSON&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// .... However both Facebook + Github currently use rev05 of the spec&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// and neither seem to specify a content-type correctly in their response headers :(&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// clients of these services will suffer a *minor* performance cost of the exception&lt;/span&gt;
          &lt;span class=&quot;c1&quot;&gt;// being thrown&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;querystring&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;access_token&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;refresh_token&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;refresh_token&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;delete&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;refresh_token&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
        &lt;span class=&quot;nx&quot;&gt;callback&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;access_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;refresh_token&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;results&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// callback results =-=&lt;/span&gt;
      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h1 id=&quot;passport-tistory-profile-구현&quot;&gt;passport-tistory Profile 구현&lt;/h1&gt;

&lt;p&gt;passport는 인증처리 후 user의 정보를 가져올 수 있는 루틴이 포함되어 있는데 바로 &lt;code&gt;userProfile&lt;/code&gt;을 사용하는 것이다.
&lt;a href=&quot;https://github.com/saltfactory/passport-tistory/blob/master/lib/passport-tistory/profile.js&quot;&gt;profile.js&lt;/a&gt;는 쉽게 생각하면 일종의 User의 정보를 담아두는 Model 이다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Parse profile.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @param {Object|String} json&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @return {Object}&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @api private&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;string&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;typeof&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;provider&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;



  &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;profile.js를 생성하면 strategy.js에 require하여 profile을 바로 사용할 수 있다.
strategy의 인증처리가 끝나면 인증후 획득한 access_key를 가지고 자동적으로 userProfile을 수행하여 API로 얻어온 user 정보를 저장하게 된다.
보통은 User 값을 가져오는 API를 동작하지만 Tistory API에서는 User 정보를 가져오는 API가 없다. 그래서 블로그 정보를 얻어오는 URL을 userProfile에 사용하게 했다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;passport-oauth2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * TistoryStrategy 생성자&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * @constructor&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;// 인증처리 호출&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;verify&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;name&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tistory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_userProfileURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;https://www.tistory.com/apis/blog/info?output=json&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// passport-oauth2 상속&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;inherits&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;OAuth2Strategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

  &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Tistory 블로그 정보를 얻는다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * 사용자 정보를 성공적으로 조회하면 아래의 object가 done 콜백함수 호출과 함꼐 넘어간다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;prototype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;userProfile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;accessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_oauth2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_userProfileURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;accessToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;res&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;InternalOAuthError&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;failed to fetch user profile&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;));&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;JSON&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;userId&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;userId&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tistory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_raw&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;body&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;_json&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;json&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

      &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;profile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;nx&quot;&gt;done&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Expose `TistoryStrategy`.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;TistoryStrategy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;우리는 Tistory의 OAuth 2.0 인증을 처리하기 위해서 TistoryStrategy와 Profile을 만들었다.
그럼 이렇게 만든 passport-tistory 인증모듈을 어디에 어떻게 사용할 수 있는지는 다음 포스팅에서 알아보기로 하겠다.
직접 express로 웹 프로젝트를 만들고 passport-tistory를 사용해서 인증을 완료한 뒤에 Tistory의 오픈 API를 사용하는 예제를 포스팅할 예정이다.&lt;/p&gt;

&lt;h1 id=&quot;결론&quot;&gt;결론&lt;/h1&gt;

&lt;p&gt;난생 처음으로 conributor가 되었다. 항상 Node.js 개발을 하면서 모듈을 가져와서 사용하기만 했는데 언젠가 한번 내가 직접 등록하고 싶다고 생각했는데 Tistory 오픈 API를 사용할 일이 생겨서 이번 기회에 npm 으로 배포할 수 있게 되었다.
아직 0.1.0 버전으로 병아리 패키지이다. 하지만 처음으로 conributor가 된 것에 스스로 감동하고 있다. 그리고 앞으로는 개인적으로 만들어서 사용한 모듈을 될 수 있는한 오류 없이 문서화해서 배포할 수 있게 구현할 예정이다.&lt;/p&gt;

&lt;p&gt;passport-tistory 를 구현하는데 처음에는 생각보다 쉽지 않았다. 우선 oauth2.js의 동작하는 방법을 알아야했고, Tistory에서 access_token을 획득하는데 있어서 &lt;strong&gt;301 moved permanently explained&lt;/strong&gt; 에러를 해결하는데 꽤 많은 시간을 보냈다.
이 시간동안에 module과 module.exports 개념을 알게 되었고, 뿐만 아니라 &lt;em&gt;http redirect following&lt;/em&gt; 이라는 개념도 알게 되었다.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;배우는 것보다 가르치는 것이 더 많이 배우는 기회가 된다.&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;라고 가르쳐주신 교수님의 말씀이 생각난다. 연구원으로 살면서 앞으로도 더 많은 모듈을 만들어서 배포할 수 있는 contributor가 되려고 노력하고 싶다.&lt;/p&gt;

&lt;h1 id=&quot;참고자료&quot;&gt;참고자료&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jaredhanson/passport&quot;&gt;https://github.com/jaredhanson/passport&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.outsider.ne.kr/829&quot;&gt;http://blog.outsider.ne.kr/829&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/outsideris/passport-me2day&quot;&gt;https://github.com/outsideris/passport-me2day&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/rotoshine/passport-kakao&quot;&gt;https://github.com/rotoshine/passport-kakao&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/olalonde/follow-redirects&quot;&gt;https://github.com/olalonde/follow-redirects&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/Gozala/querystring&quot;&gt;https://github.com/Gozala/querystring&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/visionmedia/express&quot;&gt;https://github.com/visionmedia/express&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h1 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Wed, 16 Jul 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/passport-tistory/create-passport-tistory.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/passport-tistory/create-passport-tistory.html</guid>
        
        
        <category>passport-tistory</category>
        
      </item>
    
      <item>
        <title>PhoneGap(Cordova) 앱 푸시 (Push Notification) 알람서비스 APN, GCM 구현</title>
        <description>&lt;p&gt;&lt;img src=&quot;http://cfile8.uf.tistory.com/image/276B443353A1528A2F8CBA&quot; alt=&quot;phonegap&quot;&gt;&lt;/p&gt;

&lt;p&gt;하이브리드 앱 개발은 웹 리소스와 네이티브 리소스를 함께 사용하는 개발 방법이다. 하이브리드 앱은 보통 UI를 웹 리소스로 만들기 때문에 디바이스가 가지는 특정한 기능을 핸들링하지 못한다. PhoneGap(Cordova)는 plugin을 사용해서 웹 리소스와 네이티브 리소스간 서로 통신하여 사용할 수 있도록 설계되어 있고 이 plugin을 사용해서 디바이스가 가지는 특정하는 기능을 웹 리소스에서 핸들링할 수 있다. 이번 포스팅에서는 모바일 앱 개발을 할 때 복잡하고 어렵지만 반드시 필요한 기능중에 하나인 알림 서비스를 PhoneGap(Cordova)에서 어떻게 구현할 수 있는지를 소개한다.&lt;/p&gt;

&lt;h2 id=&quot;phonegap(cordova)-프로젝트-생성하기&quot;&gt;PhoneGap(Cordova) 프로젝트 생성하기&lt;/h2&gt;

&lt;p&gt;우선 알림(푸시)서비스를 테스트하기 위해서 PhoneGap이나 Cordova 프로젝트를 생성한다. PhoneGap이나 Cordova는 동일한 plugin을 함께 사용할 수 있기 때문에 어떤 프로젝트로 만들어도 상관없다. PhoneGap 프로젝트를 만드는 것은 이 글을 참조하면 된다. (&lt;a href=&quot;http://blog.saltfactory.net/228&quot;&gt;http://blog.saltfactory.net/228&lt;/a&gt;)&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap create sf-phonegap-demo -n SF-PhoneGap-Demo -i net.saltfactory.tutorial.phonegapdemo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;pushplugin-플러그인-사용하기&quot;&gt;PushPlugin 플러그인 사용하기&lt;/h2&gt;

&lt;p&gt;PhoneGap(Cordova)에는 공식적으로 지원하는 plugin 들이 있고 이것들은 cordova 리파지토리에서 &lt;code&gt;phonegap plugin add&lt;/code&gt; 명령으로 바로 다운받아서 PhoneGap 프로젝트에서 설치해서 사용할 수 있다. 예를 들어, &lt;strong&gt;&lt;em&gt;org.apache.cordova.device&lt;/em&gt;&lt;/strong&gt; 플러그인을 설치하기 위해서는 다음과 같이 하면 된다.
&lt;code&gt;
phonegap local plugin add org.apache.cordova.device
&lt;/code&gt;
하지만 third party 플러그인이나 cordova 리파지토리에 저장되지 않은 플러그인은 URI(플러그인 위치)를 지정하여 설치할 수 있다. PhoneGap 플러그인 설치는 다음 글을 참조하면 된다. (&lt;a href=&quot;http://blog.saltfactory.net/233&quot;&gt;http://blog.saltfactory.net/233&lt;/a&gt;). 직접 plugin을 개발하여 프로젝트에 설치할 때는 다음 글을 참조하면 된다. (&lt;a href=&quot;http://blog.saltfactory.net/235&quot;&gt;http://blog.saltfactory.net/235&lt;/a&gt;, &lt;a href=&quot;http://blog.saltfactory.net/236&quot;&gt;http://blog.saltfactory.net/236&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;PhoneGap은 하이브리드 앱 개발 플랫폼이고 웹 리소스와 네이티브 리소스간 서로 통신을 하기 위해서 plugin을 만들어서 사용하는데, 알림(푸시)에 관한 plugin은 &lt;a href=&quot;https://github.com/phonegap-build/PushPlugin&quot;&gt;PushPlugin&lt;/a&gt;으로 제공하고 있다. 이 플러그인은 Android, iOS, WP8, Amazon Fire OS 의 알림을 모두 지원한다. 우리는 그 중에서 iOS와 Android에서 사용하는 방법을 살펴볼 것이다. 우선 &lt;strong&gt;&lt;em&gt;com.phonegap.plugins.PushPlugin&lt;/em&gt;&lt;/strong&gt;을 설치하자. PhoneGap 프로젝트를 설치한 디렉토리 안에서 다음 명령어를 실행하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap local plugin add https://github.com/phonegap-build/PushPlugin.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://cfile1.uf.tistory.com/image/2159184053A243712F4536&quot; alt=&quot;install push plugin&quot;&gt;
위 명령어를 실행하고 난 다음에 plugins 디렉토리에 &lt;strong&gt;&lt;em&gt;com.phonegap.plugins.PushPlugin&lt;/em&gt;&lt;/strong&gt;이 설치 되는 것을 확인할 수 있을 것이다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile9.uf.tistory.com/image/270E354053A24406049781&quot; alt=&quot;pluugins list&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;phonegap-ios-플랫폼-pushplugin-사용하기&quot;&gt;PhoneGap iOS 플랫폼 PushPlugin 사용하기&lt;/h2&gt;

&lt;p&gt;다음은 iOS 플랫폼을 추가해보자. cordova를 이용하면 다음과 같이 추가할 수 있다.
&lt;code&gt;
cordova platform add ios
&lt;/code&gt;
phonegap을 이용하면 다음과 같이 추가할 수 있다.
&lt;code&gt;
phonegap build ios
&lt;/code&gt;
&lt;img src=&quot;http://cfile21.uf.tistory.com/image/2643B74653A2459F0A6CAC&quot; alt=&quot;create ios platform&quot;&gt;
PhoneGap 프로젝트에 iOS 플랫폼이 추가되면 위와 같이 &lt;strong&gt;&lt;em&gt;platforms/&lt;/em&gt;&lt;/strong&gt; 디렉토리 밑에 &lt;strong&gt;&lt;em&gt;ios/&lt;/em&gt;&lt;/strong&gt; 디렉토리가 만들어지고 Xcode 프로젝트가 생성되는 것을 확인할 수 있다. Xcode 프로젝트를 열어보자 그리고 애플 개발자 사이트에서 프로비저닝 파일을 만들고 Xcode 프로젝트의 Code Sign을 변경해준다. 자세한 설명은 다음 글을 참조하자. (&lt;a href=&quot;http://blog.saltfactory.net/215&quot;&gt;http://blog.saltfactory.net/215&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;PushPlugin을 사용하기 위해서는 &lt;strong&gt;&lt;em&gt;config.xml&lt;/em&gt;&lt;/strong&gt;에 &lt;code&gt;feature&lt;/code&gt;를 추가해야한다. 다음과 같이 config.xml을 수정하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&amp;#39;1.0&amp;#39; encoding=&amp;#39;utf-8&amp;#39;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;widget&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;net.saltfactory.tutorial.phonegapdemo&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1.0.0&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.w3.org/ns/widgets&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:gap=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://phonegap.com/ns/1.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;SF-PhoneGap-Demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;
        Hello World sample application that responds to the deviceready event.
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;author&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;email=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;saltfactory@gmail.com&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://blog.saltfactory.net&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        SungKwang Song
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;
... (생략) ...

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;access&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;origin=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;*&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;PushPlugin&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ios-package&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;PushPlugin&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/feature&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/widget&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;변경된 사항을 플랫폼 프로젝트에 반영되게 &lt;code&gt;cordova prepare&lt;/code&gt;를 사용하여 업데이트한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;cordova prepare
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음은 index.html 에 JavaScript 코드를 다음과 같이 추가하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    Copyright (c) 2012-2014 Adobe Systems Incorporated. All rights reserved.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;);&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    you may not use this file except in compliance with the License.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    You may obtain a copy of the License at&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    http://www.apache.org/licenses/LICENSE-2.0&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    Unless required by applicable law or agreed to in writing, software&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    distributed under the License is distributed on an &amp;quot;AS IS&amp;quot; BASIS,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    See the License for the specific language governing permissions and&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    limitations under the License.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;format-detection&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;telephone=no&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;viewport&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;css/index.css&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Hello World&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;PhoneGap&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;deviceready&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;blink&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;event listening&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Connecting to Device&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;event received&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Device is Ready&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;phonegap.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;js/index.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// app.initialize();&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * tokenHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param result&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 디바이스 토큰핸들러 콜백함수.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 푸시 서비스를 활성화 하였을 때, window.plugins.pushNotification.register 메소드가 실행되면서 디바이스 토큰을 가져와서 출력한다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 만약에 푸시 서버로 디바이스 토큰을 보내야할 경우 이 함수 안에서 서버로 디바이스 토큰을 전송하면 된다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tokenHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;deviceToken:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * errorHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param err&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 에러 핸들러 콜백 함수.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;error:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;


            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * successHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param result&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 디바이스로 푸시 메세지를 받았을 때 뱃지처리 이후 호출하는 콜백함수&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;successHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;result:&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * onNotificationAPN&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param event&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 디바이스로 푸시 메세지를 받을 때 호출되는 콜백함수 window.plugins.pushNotification.register 옵션 설정에서 ecb의 이름에 매칭된다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onNotificationAPN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 alert 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;navigator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 sound 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Media&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;snd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 bage 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;badge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setApplicationIconBadgeNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;successHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;badge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;// 디바이스가 ready가 될때 실행될 수 있도록 이벤트 리스너에 등록한다.&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;deviceready&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;

              &lt;span class=&quot;c1&quot;&gt;// PushPlugin을 설치했다면 window.plugins.pushNotification.register를 이용해서 iOS 푸시 서비스를 등록한다.&lt;/span&gt;
              &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;badge&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 뱃지 기능을 사용한다.&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;sound&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 사운드를 사용한다.&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;alert&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// alert를 사용한다.&lt;/span&gt;
                &lt;span class=&quot;s2&quot;&gt;&amp;quot;ecb&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;onNotificationAPN&amp;quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 디바이스로 푸시가 오면 onNotificationAPN 함수를 실행할 수 있도록 ecb(event callback)에 등록한다.&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;index.html을 수정하고 플랫폼에 적용하기 위해서는 &lt;code&gt;corodva prepare&lt;/code&gt; 나 &lt;code&gt;phonegap build&lt;/code&gt;를 사용해서 웹 리소스를 플랫폼 프로젝트에 반영한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap build ios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 아이폰 디바이스를 USB로 연결하고 phonegap run을 실행시켜서 아이폰에 앱을 실행시켜보자. 푸시서비스는 디바이스 토큰을 획득해야하기 때문에 simulator에서는 테스트할 수 없다. 반드시 디바이스를 연결해서 실행시켜야한다.
&lt;code&gt;
phonegap run ios
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;만약 console.log를 확인하고 싶을 때, phonegap run을 실행시키면 console.log를 터미널에서 확인할 수 없다. 이럴 경우는 PhoneGap 프로젝트 안에 있는 platforms/ios 안에 있는 Xcode 프로젝트를 열어서 Xcode에서 빌드하고 실행하면 된다. 그리고 console.log를 Xcode의 로그 화면에서 출력하기 위해서는 웹 리소스의 console.log를 터미널로 로깅하기 위해서 wrapping한 &lt;strong&gt;&lt;em&gt;org.apache.cordova.console&lt;/em&gt;&lt;/strong&gt; 플러그인을 설치해야한다.
&lt;code&gt;
phonegap local plugin add org.apache.cordova.console
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;이제 Xcode 에서 아이폰 디바이스를 빌드하고 실행시켜보자. 최초 앱이 실행하면 앱에서 푸시서비스를 허용 할 것인지 물어보게 되는데 푸시서비스를 허용하도록 OK를 선택한다. 만약 빌드하는데 aps_entitlement 에러가 만나게 되면 code sign이 제대로 매칭되지 않았기 때문이기 때문에 provisioning 파일을 잘 생성해서 적용하고 있는지 확인할 필요가 있다.
&lt;img src=&quot;http://cfile8.uf.tistory.com/image/22095F4B53A2A6A22E8CAC&quot; alt=&quot;아이폰 푸시허용 {width:320px}&quot; title=&quot;아이폰 푸시 허용&quot;&gt;&lt;/p&gt;

&lt;p&gt;푸시 서비스를 허용하고 난 다음에는 우리가 index.html에 작성한 readydevice 이벤트 리스너가 동작하게 된다. 우리는 여기서 &lt;strong&gt;&lt;em&gt;window.plugins.pushnotification.register&lt;/em&gt;&lt;/strong&gt;를 실행하게 만들었고 이 메소드가 동작하면 디바이스 토큰을 획득해서 console.log를 출력하게 하였다. Xcode에서 실행한 결과는 다음 그림과 같다. 아래 그림을 확대해서 보면 deviceToken에 아이폰 디바이스 토큰 값이 출력되는 것을 확인할 수 있다. 푸시서버에서 아이폰으로 푸시 메세지를 보내기 위해서는 이 디바이스 토큰 값을 푸시 서버로 전송해야한다.
&lt;img src=&quot;http://cfile21.uf.tistory.com/image/264D6A3353A38838310AC4&quot; alt=&quot;디바이스토큰 획득&quot; title=&quot;디바이스 토큰 획득&quot;&gt;&lt;/p&gt;

&lt;p&gt;푸시서버로 디바이스토큰을 저장했다고 가정하고 푸시 서비스에서 푸시 메세지를 보내는 코드를 작성해보자. Node.js로 푸시 서비스를 구현하는 방법은 다음 글에 자세하게 설명하고 있다. (&lt;a href=&quot;http://blog.saltfactory.net/215&quot;&gt;http://blog.saltfactory.net/215&lt;/a&gt;)
간단하게 다시 설명하면 Node.js로 푸시 서비스를 구현하기 위해서는 &lt;strong&gt;&lt;em&gt;node-apn&lt;/em&gt;&lt;/strong&gt; 모듈을 사용하면 애플 푸시 프로바이더를 쉽게 구현할 수 있다. 먼저 node-apn 모듈을 npm으로 설치하자.
&lt;code&gt;
npm install apn
&lt;/code&gt;
그리고 apn에서 푸시 프로바이더로 애플 푸시 서버로 푸시 메세지를 전송하기 위해서 필요한 aps_development.cer 파일과 Certifiacates.p12 파일을 만든다. 이 파일을 만드는 방법은 (&lt;a href=&quot;http://blog.saltfactory.net/215&quot;&gt;http://blog.saltfactory.net/215&lt;/a&gt;) 글을 참조하기 바란다.
두 파일을 apn 모듈에서 사용하기 위해서는 .pem 파일로 변경해야하는데 다음과 같이 openssl 명령어로 만들 수 있다. 이 방법 또한 위에서 링크한 글을 참조하면 된다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;openssl x509 -in aps_development.cer -inform DER -outform PEM -out aps_development.pem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;openssl pkcs12 -in Certificates.p12 -out Certificates-dev.pem -nodes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;인증 파일도 모두 준비가 되었고 이제 푸시를 보내는 코드를 다음과 같이 만든다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Created by saltfactory on 6/20/14.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * filename : ios_pushprovider.js&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;apn&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;apn&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;process&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;DEBUG&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;apn&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;production&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;gateway&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gateway.sandbox.push.apple.com&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;cert&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../keys/phonegapdemo/aps_development.pem&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// aps_development.cert 파일을 .pem 파일로 변경한 경로&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;../keys/phonegapdemo/Certificates-dev.pem&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Certificates.p12 파일을 .pem 파일로 변경한 경로&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;passphrase&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;secret&amp;quot;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;};&lt;/span&gt;


&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;apnConnection&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;apn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Connection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;options&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;


&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;deviceToken&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;21a1efbdc6ccf6d6e1...02e1300c9&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 디바이스토큰 문자열&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;myDevice&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;apn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;deviceToken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;note&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;apn&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;expiry&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;Math&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;floor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;now&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3600&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Expires 1 hour from now.&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;badge&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//note.sound = &amp;quot;ping.aiff&amp;quot;;&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;PhoneGap 푸시 테스트&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;//note.payload = {&amp;#39;messageFrom&amp;#39;: &amp;#39;Caroline&amp;#39;};&lt;/span&gt;

&lt;span class=&quot;nx&quot;&gt;apnConnection&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;note&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;myDevice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Node.js로 만든 간단한 ios push provider 코드이다. 이 코드를 실행시켜보자. 잠시 후 다음 그림과 같이 아이폰으로 푸시 메세지가 전송된 것을 확인할 수 있다.
&lt;img src=&quot;http://cfile23.uf.tistory.com/image/222B154153A3916F292543&quot; alt=&quot;아이폰 백그라운드 푸시 {width:320px}&quot; title=&quot;아이폰 백그라운드 푸시&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile26.uf.tistory.com/image/243FAE4153A39171120092&quot; alt=&quot;아이폰 슬립모드 푸시 {width:320px}&quot; title=&quot;아이폰 슬립모드 푸시&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile3.uf.tistory.com/image/263A3E4153A39171194A95&quot; alt=&quot;아이폰 노티피케이션 센터 {width:320px}&quot; title=&quot;아이폰 노티피케이션 센터&quot;&gt;&lt;/p&gt;

&lt;p&gt;푸시 프로바이더에서 badge 값을 3으로 지정하여 푸시 메세지를 보냈다. 우리는 PhoneGap 프로젝트에서 PushPlugin을 설정하면서 onNotificationAPN에 뱃지값을 어플리케이션에 반영할 수 있도록 코드를 작성하였기 때문에 뱃지가 앱에 표현되는 것을 확인할 수 있다. 위 결과는 앱이 백그라운드로 실행되고 있을 때나 앱이 실행되지 않았을 때 푸시 메세지가 왔을 때의 결과이다. 만약 앱이 실행되고 있을 때 푸시 메세지가 오면 onNotificationAPN에서 지정한 callback을 화면에서 실행할 것이다. index.html 코드에서 앱이 실행되고 있을 때 푸시 메세지에서 alert 값이 있을 경우에 &lt;strong&gt;&lt;em&gt;navigator.notification.alert&lt;/em&gt;&lt;/strong&gt;를 실행하라고 했는데 이것은 PhoneGap의 &lt;strong&gt;&lt;em&gt;org.apache.cordova.dialogs&lt;/em&gt;&lt;/strong&gt; 플러그인을 설치하고 alert dialog를 보이게 하는 메소드를 호출하는 것이다. PhoneGap 프로젝트에 &lt;strong&gt;&lt;em&gt;org.apache.cordova.dialogs&lt;/em&gt;&lt;/strong&gt; 플러그인을 설치하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap local plugin add org.apache.cordova.dialogs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 PhoneGap 프로젝트에 플러그인 리소스들이 적용될 수 있게 다시 &lt;code&gt;cordova prepare&lt;/code&gt; 나 &lt;code&gt;phonegap build&lt;/code&gt;를 다시 실행한다.
&lt;code&gt;
phonegap build ios
&lt;/code&gt;
다시 디바이스에 앱을 빌드해서 실행시켜보자. 앱이 백그라운드가 아니라 실행되고 있을 때 우리가 작성한 푸시 프로바이더에서 다시 푸시 메세지를 보내어보자. 그러면 다음 그림과 같이 앱이 실행되고 있을 때, 푸시 메세지가 왔을 경우 alert dialog가 보여지는 것을 확인할 수 있다.
&lt;img src=&quot;http://cfile2.uf.tistory.com/image/2242CE4A53A393A71B2F6F&quot; alt=&quot;안드로이드 푸시 알림 {width:320px}&quot; title=&quot;안드로이드 푸시 알림&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;phonegap-android-pushplugin-사용하기&quot;&gt;PhoneGap android PushPlugin 사용하기&lt;/h2&gt;

&lt;p&gt;위에서 iOS 플랫폼에서 PushPlugin을 사용해서 푸시 서비스를 구현하는 방법을 살펴봤는데 이번에는 android 플랫폼에서 PushPlugin을 사용해서 푸시 서비스를 구현하는 방법을 살펴보자.&lt;/p&gt;

&lt;p&gt;애플에서 푸시를 위해서 provisioning 파일을 생성한것 같이 구글의 GCM을 이용해서 알림 서비스를 구현하기 위해서는 Google Console에서 구글 GCM 서비스를 하기 위한 프로젝트를 생성해야한다. 자세한 방법은 다음 글을 참조한다. (&lt;a href=&quot;http://blog.saltfactory.net/216&quot;&gt;http://blog.saltfactory.net/216&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;먼저 PhoneGap 프로젝트에서 안드로이드 플랫폼을 추가한다.
&lt;code&gt;
phonegap build android
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;만약 cordova 프로젝트라면 다음과 같이 안드로이드 플랫폼을 추가한다.
&lt;code&gt;
cordova platform add android
&lt;/code&gt;
가장 먼저 해야할 것은 iOS에서 설정과 동일하게 config.xml에 다음과 같이 feature를 추가한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-xml&quot; data-lang=&quot;xml&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;?xml version=&amp;#39;1.0&amp;#39; encoding=&amp;#39;utf-8&amp;#39;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;widget&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;net.saltfactory.tutorial.phonegapdemo&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;version=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;1.0.0&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://www.w3.org/ns/widgets&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;xmlns:gap=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://phonegap.com/ns/1.0&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;name&amp;gt;&lt;/span&gt;SF-PhoneGap-Demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/name&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;description&amp;gt;&lt;/span&gt;
        Hello World sample application that responds to the deviceready event.
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/description&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;author&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;email=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;saltfactory@gmail.com&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://blog.saltfactory.net&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        SungKwang Song
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/author&amp;gt;&lt;/span&gt;

... (생략) ...
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;access&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;origin=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;*&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;feature&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;PushPlugin&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;ios-package&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;PushPlugin&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;param&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;android-package&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;value=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;com.plugin.gcm.PushPlugin&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/feature&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/widget&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;하이브리드 앱은 하나의 웹 자원으로 여러가지 플랫폼에 사용을 한다. 그래서 index.html에 작성한 JavaScript 코드에 다음을 추가한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;&amp;lt;!--&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    Copyright (c) 2012-2014 Adobe Systems Incorporated. All rights reserved.&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    Licensed under the Apache License, Version 2.0 (the &amp;quot;License&amp;quot;);&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    you may not use this file except in compliance with the License.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    You may obtain a copy of the License at&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    http://www.apache.org/licenses/LICENSE-2.0&lt;/span&gt;

&lt;span class=&quot;c&quot;&gt;    Unless required by applicable law or agreed to in writing, software&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    distributed under the License is distributed on an &amp;quot;AS IS&amp;quot; BASIS,&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    See the License for the specific language governing permissions and&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;    limitations under the License.&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;--&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;format-detection&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;telephone=no&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;viewport&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;css/index.css&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Hello World&lt;span class=&quot;nt&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;app&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&amp;gt;&lt;/span&gt;PhoneGap&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;id=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;deviceready&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;blink&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;event listening&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Connecting to Device&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;nt&quot;&gt;&amp;lt;p&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;event received&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Device is Ready&lt;span class=&quot;nt&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;phonegap.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!--&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;js/index.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;--&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;type=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;c1&quot;&gt;// app.initialize();&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * tokenHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param result&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 디바이스 토큰핸들러 콜백함수.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 푸시 서비스를 활성화 하였을 때, window.plugins.pushNotification.register 메소드가 실행되면서 디바이스 토큰을 가져와서 출력한다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 만약에 푸시 서버로 디바이스 토큰을 보내야할 경우 이 함수 안에서 서버로 디바이스 토큰을 전송하면 된다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;tokenHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;deviceToken:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * errorHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param err&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 에러 핸들러 콜백 함수.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;error:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * successHandler&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param result&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 디바이스로 푸시 메세지를 받았을 때 뱃지처리 이후 호출하는 콜백함수&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;successHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;result:&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * onNotificationAPN&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param event&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * iOS 디바이스로 푸시 메세지를 받을 때 호출되는 콜백함수, window.plugins.pushNotification.register 옵션 설정에서 ecb의 이름에 매칭된다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onNotificationAPN&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 alert 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;navigator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 sound 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;snd&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Media&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;snd&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

              &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지에 bage 값이 있을 경우&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;badge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;setApplicationIconBadgeNumber&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;successHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;badge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * onNotificationGCM&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * @param e&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             *&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             * 안드로이드 디바이스로 푸시 메세지를 받을 때 호출되는 함수, window.plugins.pushNotification.register 옵션에 설정에서 ecb의 이름에 매칭된다.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;             */&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;onNotificationGCM&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;event&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;registered&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 안드로이드 디바이스의 registerID를 획득하는 event 중 registerd 일 경우 호출된다.&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;registerID:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;regid&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;message&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 안드로이드 디바이스에 푸시 메세지가 오면 호출된다.&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                  &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;foreground&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지가 왔을 때 앱이 실행되고 있을 경우&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;soundfile&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;soundname&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;sound&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
                    &lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;my_media&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;Media&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;/android_asset/www/&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;soundfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;nx&quot;&gt;my_media&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;play&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지가 왔을 때 앱이 백그라운드로 실행되거나 실행되지 않을 경우&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;coldstart&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지가 왔을 때 푸시를 선택하여 앱이 열렸을 경우&lt;/span&gt;
                      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;알림 왔을 때 앱이 열리고 난 다음에 실행 될때&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지가 왔을 때 앱이 백그라운드로 사용되고 있을 경우&lt;/span&gt;
                      &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;앱이 백그라운드로 실행될 때&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

                  &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

                  &lt;span class=&quot;nx&quot;&gt;navigator&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;notification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;payload&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;error&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 푸시 메세지 처리에 에러가 발생하면 호출한다.&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;error:&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;msg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;default&amp;#39;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;
                &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;알수 없는 이벤트&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;c1&quot;&gt;// 디바이스가 ready가 될때 실행될 수 있도록 이벤트 리스너에 등록한다.&lt;/span&gt;
            &lt;span class=&quot;nb&quot;&gt;document&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;addEventListener&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;deviceready&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(){&lt;/span&gt;
              &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;platform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

              &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;platform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;toUpperCase&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ANDROID&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;){&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;successHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;senderID&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;45219...&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// Google GCM 서비스에서 생성한 Project Number를 입력한다.&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;ecb&amp;quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;onNotificationGCM&amp;quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 디바이스로 푸시가 오면 onNotificationGCM 함수를 실행할 수 있도록 ecb(event callback)에 등록한다.&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;c1&quot;&gt;// PushPlugin을 설치했다면 window.plugins.pushNotification.register를 이용해서 iOS 푸시 서비스를 등록한다.&lt;/span&gt;
                &lt;span class=&quot;nb&quot;&gt;window&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;plugins&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;pushNotification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;register&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;tokenHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;errorHandler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;badge&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 뱃지 기능을 사용한다.&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;sound&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 사운드를 사용한다.&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;alert&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// alert를 사용한다.&lt;/span&gt;
                  &lt;span class=&quot;s2&quot;&gt;&amp;quot;ecb&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&amp;quot;onNotificationAPN&amp;quot;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 디바이스로 푸시가 오면 onNotificationAPN 함수를 실행할 수 있도록 ecb(event callback)에 등록한다.&lt;/span&gt;
                &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
              &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

            &lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;PhoneGap  프로젝트에서 디바이스의 플랫폼을 알기 위해서는 org.apache.cordova.device 플러그인이 필요하다. 이 플러그인을 설치하자.
&lt;code&gt;
phonegap local plugin add org.apache.cordova.device
&lt;/code&gt;
그리고 Media를 사용하기 위해서는 org.apache.cordova.media 플러그인이 필요하다.
&lt;code&gt;
phonegap local plugin add org.apache.cordova.media
&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;PhoneGap 프로젝트에서 android 앱에 푸시 서비스를 구현하기 위한 준비는 모두 끝났다.
모든 자원을 안드로이드 플랫폼에 적용하기 위해서 cordova prepare를 실행하던지 &lt;code&gt;phonegap build&lt;/code&gt;를 실행한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap build android
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;안드로이드 디바이스를 연결하고 eclipse나 IntelliJ를 이용하여 PhoneGap의 안드로이드 프로젝트를 열어서 실행해보자. 안드로이드 디바이스로 빌드하고 실행하면 우리가 앞에서 window.plugin.pushnotification.register에 안드로이드 senderID를 등록한 것을 가지고 GCM에 사용할 수 있는 디바이스의 유일한 registerID를 획득한 것을 확인할 수 있다.
&lt;img src=&quot;http://cfile27.uf.tistory.com/image/211DC43453A3B5CC3648F7&quot; alt=&quot;registerID&quot;&gt;&lt;/p&gt;

&lt;p&gt;이제 안드로이드 디바이스로 푸시를 보낼 GCM 서버를 Node.js로 만들어보자. GCM 서버에 필요한 인증절차와 구축 방법은 다음 글을 참조하면 된다.(&lt;a href=&quot;http://blog.saltfactory.net/216&quot;&gt;http://blog.saltfactory.net/216&lt;/a&gt;). 이 포스팅에서는 간단하게 GCM 서버로 안드로이드 디바이스로 푸시를 전송하는 예제를 설명한다. GCM 서버를 구축하기 위해서는 Google Console에서 안드로이드 GCM 프로젝트를 만들고 server API key를 만들어서 사용한다. 그리고 Node.js로 GCM 서버를 만들기 위해서는 &lt;strong&gt;&lt;em&gt;node-gcm&lt;/em&gt;&lt;/strong&gt; 모듈을 사용한다. server API key 를 만드는 방법은 (&lt;a href=&quot;http://blog.saltfactory.net/216)%EA%B8%80%EC%9D%84&quot;&gt;http://blog.saltfactory.net/216)글을&lt;/a&gt; 참조한다. node-gcm 모듈을 npm으로 설치하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install node-gcm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다음은 android_gcm_provider.js 파일을 다음과 같이 만들어서 저장한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-javascript&quot; data-lang=&quot;javascript&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Created by saltfactory on 6/20/14.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * filename : android_gcm_provider.js&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gcm&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;node-gcm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// create a message with default values&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gcm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// or with object values&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gcm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;collapseKey&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;PhoneGapDemo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;delayWhileIdle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;timeToLive&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;title&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PhoneGap 푸시 테스트&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;PhoneGap 푸시 메세지&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;nx&quot;&gt;msgcnt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;gcm&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;Sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;AIzaSyBH...&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// 구글 프로젝트에 등록한 GCM 서비스에서 만든 server API key를 입력한다.&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;registrationIds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[];&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;registrationIds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;APA91...&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;// PhoneGap 프로젝트의 안드로이드 프로젝트에서 획득한 registerID를 입력한다. 이 registerID를 이용하여 안드로이드 디바이스에 푸시를 전송한다.&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/**&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; * Params: message-literal, registrationIds-array, No. of retries, callback-function&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; **/&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;sender&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;send&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;message&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;registrationIds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;err&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;result&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;});&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;node-gcm 모듈로 Node.js 기반의 안드로이드 GCM 서버를 간단히 만들 수 있다. 위 코드를 실행하면 안드로이드 다음 그림과 같이 디바이스로 푸시가 전송 되는 것을 확인할 수 있다.
&lt;img src=&quot;http://cfile26.uf.tistory.com/image/24628B3C53A3B84E3039C1&quot; alt=&quot;안드로이드 백그라운 알림 {width:320px;}&quot; title=&quot;안드로이드 백그라운 알림&quot;&gt;
&lt;img src=&quot;http://cfile25.uf.tistory.com/image/217DF53C53A3B850073864&quot; alt=&quot;안드로이드 대시보드 {width:320px;}&quot; title=&quot;안드로이드 대시보드&quot;&gt;
&lt;img src=&quot;http://cfile1.uf.tistory.com/image/27688D3C53A3B85128CD8D&quot; alt=&quot;안드로이드 알림 {width:320px;}&quot; title=&quot;안드로이드 알림&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;결론&quot;&gt;결론&lt;/h2&gt;

&lt;p&gt;최근 모바일 앱 개발에서 푸시(알림)서비스는 반드시 필요한 기능중에 하나이다. 고객들은 푸시 서비스를 지원하는 앱을 사용하길 원하고 있다. 하이브리드 앱은 웹 리소스와 네이티브 리소스를 함께 사용하여 단일 웹 리소스로 여러 디바이스에 동일한 기능을 구현할 수 있다. PhoneGap에서는 웹 리소스로 네이티브 기능을 제어하기 위해서 plugin을 만들어서 사용하는데 모바일의 푸시 서비스 구현하기 위해 네이티브 자원을 사용할 수 있도록 &lt;strong&gt;&lt;em&gt;PushPlugin&lt;/em&gt;&lt;/strong&gt;을 만들어서 배포하고 있다. PushPlugin을 사용하면 웹 리소스를 이용하여 디바이스의 토큰 정보나 registerID를 획득할 수 있고, 푸시 메세지가 디바이스로 전송되었을 때, 웹 리소스를 이용하여 푸시 받은 정보를 디바이스에 적용할 수 있다. 만약에 PushPlugin을 사용하지 않는다면 각 플랫폼마다 웹 리소스가 네이티브 리소스를 제어하기 위해서 복잡한 코드를 어렵게 작성해야하지만 PhoneGap(Cordova)의 PushPlugin을 사용하면 간단하게 푸시 서비스를 지원하는 하이브리드 앱을 만들 수 있다.&lt;/p&gt;

&lt;p&gt;그리고 Node.js의 &lt;strong&gt;&lt;em&gt;node-apn&lt;/em&gt;&lt;/strong&gt;과 &lt;strong&gt;&lt;em&gt;node-gcm&lt;/em&gt;&lt;/strong&gt; 모듈을 사용해서 PhoneGap(Cordova)에서 획득한 디바이스 정보를 가지고 쉽게 푸시를 발송할 수 있는 프로바이더 서버를 쉽게 만들 수 있는 것도 확인했다. 이제 하이브리드 앱을 만들때 더이상 푸시서비스를 어떻게 만들어야할지 걱정할 필요가 없을 것이다. 좀 더 네이티브에 가까운 서비스를 웹 리소스로 제어할 수 있으니 UI를 담당하는 웹 리소스를 가지고 푸시 서비스를 쉽게 만들 수 있을 것이다.&lt;/p&gt;

&lt;h1 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h1&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Fri, 20 Jun 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/hybridapp/create-hybird-app-push-notification-apn-gcm.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/hybridapp/create-hybird-app-push-notification-apn-gcm.html</guid>
        
        
        <category>hybridapp</category>
        
      </item>
    
      <item>
        <title>PhoneGap(Cordova) 외부 링크(a link) 새창으로 열기</title>
        <description>&lt;p&gt;&lt;img src=&quot;http://tricedesigns.com/presentations/dreamforce/native-like%20phonegap%20apps/assets/phonegap_flow.png&quot; alt=&quot;phonegap&quot;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://phonegap.com&quot;&gt;PhoneGap&lt;/a&gt; (&lt;a href=&quot;http://cordova.apache.org&quot;&gt;Cordova&lt;/a&gt;) 는 &lt;strong&gt;하이브리드 앱 개발 플랫폼&lt;/strong&gt;이다. 모바일 앱 개발을 할 때 하이브리드 앱이라고 하면 통상 웹 자원과 네이티브 자원을 함께 사용해서 앱을 개발하는 것을 의미한다. PhoneGap은 UI 및 사용자의 이벤트를 HTML 나 JavaScript로 처리를 한다. 이 말은 다시말하면 PhoneGap은 내장 &lt;strong&gt;&lt;em&gt;WebView&lt;/em&gt;&lt;/strong&gt;를 사용하고 WebView 안에 웹 자원을 사용하여 개발을 한다는 것이다. PhoneGap에서 웹 자원은 로컬 HTML, CSS, 그리고 JavaScript를 사용한다. 웹뷰에서 HTML으로 UI를 만들때 페이지 전환을 링크를 사용한다. 이 때 앱 안에 링크를 사용할 때 다음과 같은 문제를 가진다.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;HTML 파일 안에 a 링크로 외부로 연결하는 코드가 있으면 사용자는 이것을 선택하면 http 주소로 location을 변경하면서 PhoneGap의 UI가 모두 사라져 버리는 문제가 있다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;다시 말해서 앱 안에 &lt;code&gt;&amp;lt;a href=&amp;quot;http://blog.saltfactory.net&amp;quot;&amp;gt;blog&amp;lt;/a&amp;gt;&lt;/code&gt; 라는 링크가 앱 안에 있을 때 이 링크를 누르는 순간 새로운 창이 나나타는 것이 아니라 동작하던 앱의 화면은 사라지고 WebView는 블로그 페이지로 가득차버리는 문제가 발생한다. 예제로 PhoneGap 프로젝트를 만들어보자.&lt;/p&gt;

&lt;p&gt;프로젝트 이름은 &lt;strong&gt;sf-phonegap-demo&lt;/strong&gt;라고 만들어보자. 처음 PhoneGap으로 프로젝트를 만든다면 &lt;a href=&quot;http://blog.saltfactory.net/228&quot;&gt;[PhoneGap 하이브리드 앱 개발] #1. PhoneGap과 Node.js로 하이브리드 앱 개발환경 구축하기&lt;/a&gt; 글을 참조하여 만든다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap create sf-phonegap-demo -n Sf-PhoneGap-Demo -i net.saltfactory.tutorial.phonegapdemo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;우리는 UI를 &lt;a href=&quot;http://ionicframework.com&quot;&gt;Ionic Framework&lt;/a&gt;를 이용해서 만들것이다. PhoneGap은 &lt;code&gt;build&lt;/code&gt;를 할 경우 자동으로 www 디렉토리 안에 있는 웹 자원을 각 플랫폼으로 복사하기 때문에 우리가 사용할 라이브러리를 &lt;code&gt;www/lib&lt;/code&gt; 로 넣어둘 것이다. 우리는 웹 라이브러리를 &lt;a href=&quot;http://bower.io&quot;&gt;bower&lt;/a&gt;를 이용해서 설치할 것이다. 컴퓨터에 &lt;code&gt;bower&lt;/code&gt; 명령어가 설치되지 않았으면 &lt;code&gt;npm&lt;/code&gt;을 이용해서 bower를 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;npm install -g bower
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;bower&lt;/code&gt;를 설치하고 난 이후 bower의 컴포넌트 들의 설치 디렉토리를 &lt;code&gt;www/lib&lt;/code&gt;로 지정하기 위해서 다음과 같이 &lt;code&gt;.bowerrc&lt;/code&gt;를 만든다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;vi .bowerrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;{
  &amp;quot;directory&amp;quot;: &amp;quot;www/lib&amp;quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 bower를 이용하여 ionic을 설치해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;bower install driftyco/ionic-bower
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;bower로 설치가 끝나면 &lt;code&gt;www/lib&lt;/code&gt; 안에 다음과 같이 라이브러리들이 설치된 것을 확인할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile7.uf.tistory.com/image/247CDC4D53993C3032203E&quot; alt=&quot;after install ionic using bower&quot;&gt;&lt;/p&gt;

&lt;p&gt;이제 테스트를 위해서 www/index.html 파일을 다음과 같이 수정한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;viewport&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lib/ionic/css/ionic.css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lib/ionic/js/dist/js/ionic.bundle.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;angular&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;SFApp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ionic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ng-app=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;SFApp&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bar bar-header bar-positive&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;a link demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

      &lt;span class=&quot;nt&quot;&gt;&amp;lt;ion-content&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;has-header&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;padding=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://blog.saltfactory.net&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Go saltfactor&amp;#39;s blog&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/ion-content&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;

&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;프로젝트를 만들고 ios 플랫폼을 만들어보자&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap build ios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 테스트를 위해 작성한 앱을 iOS 시뮬레이터로 실행해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap run ios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;실행을 해보면 아래 그림과 같이 ionic framework 안에 링크가 하나 있는 앱이 실행이 될 것이다. 이젠 링크를 클릭해보자. 어떻게 되는가? &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;a 링크는 우리가 만든 앱을 사라지게 만들어버리고 a 링크가 가지고 있는 URL로 화면이 변경되어 버려 PhoneGap으로 만든 앱이 사라져 버리고 WebView에 새로운 사이트가 가득차 버리게 되는 문제가 발생한다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile8.uf.tistory.com/image/2748EB4553993D393A709B&quot; alt=&quot;simple page with in a link {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile8.uf.tistory.com/image/252BC94553993D3B2A7414&quot; alt=&quot;change new page after click link {width:320px;}&quot;&gt;&lt;/p&gt;

&lt;p&gt;그럼 PhoneGap 으로 하이브리드 앱을 만들때 컨텐츠 안에 a 링크가 있을 경우 어떻게 대처해야할까? &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;보통 a 링크는 다른 사이트로 이동을 시키기 위해서 많이 사용하기 때문에 링크를 모바일이 가지고 있는 기본 브라우저로 새롭게 열게하면 된다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;inappbrowser-플러그인을-사용&quot;&gt;InAppBrowser 플러그인을 사용&lt;/h2&gt;

&lt;p&gt;PhoneGap에서 새로운 브라우저를 열기 위해서는 &lt;a href=&quot;https://github.com/apache/cordova-plugin-inappbrowser&quot;&gt;InAppBrowser&lt;/a&gt; 플러그인이 필요하다. 다음과 같이 inappbrowser 플러그인을 설치한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap plugin add org.apache.cordova.inappbrowser
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;inappbrowser로 외부링크를 브라우저로 열기 위해서는 HTML 코드 안에 a 링크에 다음과 같이 target이 반드시 필요하다. 그리고 &lt;code&gt;target&lt;/code&gt;은 &lt;code&gt;_system&lt;/code&gt;으로 한다. 위 HTML 코드를 다음과 같이 수정하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;!DOCTYPE html&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;charset=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;utf-8&amp;quot;&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;meta&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;name=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;viewport&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;content=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;

        &lt;span class=&quot;nt&quot;&gt;&amp;lt;link&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lib/ionic/css/ionic.css&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;rel=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;stylesheet&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;lib/ionic/js/dist/js/ionic.bundle.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script &lt;/span&gt;&lt;span class=&quot;na&quot;&gt;src=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;cordova.js&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;script&amp;gt;&lt;/span&gt;
          &lt;span class=&quot;nx&quot;&gt;angular&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;SFApp&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ionic&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;/script&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;title&amp;gt;&amp;lt;/title&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;nt&quot;&gt;&amp;lt;body&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;ng-app=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;SFApp&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;div&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;bar bar-header bar-positive&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;h1&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;title&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;a link demo&lt;span class=&quot;nt&quot;&gt;&amp;lt;/h1&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/div&amp;gt;&lt;/span&gt;

      &lt;span class=&quot;nt&quot;&gt;&amp;lt;ion-content&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;class=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;has-header&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;padding=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;true&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;c&quot;&gt;&amp;lt;!-- &amp;lt;a href=&amp;quot;http://blog.saltfactory.net&amp;quot; target=&amp;quot;_system&amp;quot;&amp;gt;Go saltfactor&amp;#39;s blog&amp;lt;/a&amp;gt; --&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;#&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;window.open(&amp;#39;http://blog.saltfactory.net&amp;#39;, &amp;#39;_system&amp;#39;);&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Go saltfactor&amp;#39;s blog&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;nt&quot;&gt;&amp;lt;/ion-content&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;nt&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
&lt;span class=&quot;nt&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다시 ios 플랫폼에 코드를 적용해서 실행해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap run ios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;앱이 실행되면 다시 a 링크를 클릭해보자. 아래 그림과 같이 이전과는 다르게 모바일 사파리 브라우저로 열리는 것을 확인할 수 있다. 위 코드는 iOS에서 사용할 경우 &lt;code&gt;window.open&lt;/code&gt; 에 &lt;code&gt;target&lt;/code&gt;을 &lt;code&gt;_system&lt;/code&gt;으로 사용하면 되는 예제를 보여주고 있다. 안드로이드일 경우에는 다음과 같이 &lt;code&gt;navigator.app.loadUrl&lt;/code&gt;과 &lt;code&gt;openExtenral:true&lt;/code&gt;를 사용해야한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;#&amp;quot;&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;onclick=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;navigator.app.loadUrl(&amp;#39;http://blog.saltfactory.net&amp;#39;, {openExternal:true});&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Go saltfactor&amp;#39;s blog&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;img src=&quot;http://cfile23.uf.tistory.com/image/23112434539943BE2D30CA&quot; alt=&quot;open safari browser {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile4.uf.tistory.com/image/245D9834539943C01F0F9C&quot; alt=&quot;backgroud navigation ios {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile5.uf.tistory.com/image/237C8C34539943C12FC75C&quot; alt=&quot;background navigation ios {width:320px;}&quot;&gt;&lt;/p&gt;

&lt;p&gt;하지만 이 방법을 사용하기 위해서는 a 링크의 href를 분석해서 inappbrower를 사용해서 링크를 열수 있는 JavaScript 코드로 변경을 해줘야한다. &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;컨텐츠를 개발자가 만들때는 문제가 되지 않지만 HTML 코드를 서버에서 Ajax와 같은 것을 이용해서 HTML코드를 가져와서 PhoneGap을 적용할 때는 a 링크 사용의 문제는 여전히 존재하게 된다. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;네이티브-코드-변경---ios&quot;&gt;네이티브 코드 변경 - iOS&lt;/h2&gt;

&lt;p&gt;PhoneGap은 내부적으로 &lt;strong&gt;WebView&lt;/strong&gt;를 열어서 사용하고 로컬의 웹 자원을 사용한다. 다시 말해서 &lt;code&gt;file://&lt;/code&gt; 로 HTML을 불러오기 때문에 &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;scheme가 &lt;strong&gt;&lt;em&gt;http&lt;/em&gt;&lt;/strong&gt;나 &lt;strong&gt;&lt;em&gt;https&lt;/em&gt;&lt;/strong&gt;일 경우에는 브라우저의 새 창으로 열리게 하면 된다. &lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;우리는 PhoneGap 프로젝트를 iOS 플랫폼을 추가해서 만들었는데 iOS 플랫폼 디렉토리에 들어가서 &lt;code&gt;MainViewController.m&lt;/code&gt; 파일을 열어보자. 그리고 scheme를 분석해서 http와 https일 경우는 모바일 브라우저로 링크를 열게 다음과 같이 코드를 추가한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-objective-c&quot; data-lang=&quot;objective-c&quot;&gt;&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;

&lt;span class=&quot;cp&quot;&gt;#pragma mark UIWebDelegate implementation&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;webViewDidFinishLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;UIWebView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theWebView&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Black base color for background matches the native apps&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;theWebView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backgroundColor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;UIColor&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;blackColor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;webViewDidFinishLoad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theWebView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/* Comment out the block below to over-ride */&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;/*&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;- (void) webViewDidStartLoad:(UIWebView*)theWebView&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    return [super webViewDidStartLoad:theWebView];&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;- (void) webView:(UIWebView*)theWebView didFailLoadWithError:(NSError*)error&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    return [super webView:theWebView didFailLoadWithError:error];&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;- (BOOL) webView:(UIWebView*)theWebView shouldStartLoadWithRequest:(NSURLRequest*)request navigationType:(UIWebViewNavigationType)navigationType&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;    return [super webView:theWebView shouldStartLoadWithRequest:request navigationType:navigationType];&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;*/&lt;/span&gt;


&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;BOOL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;UIWebView&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theWebView&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;shouldStartLoadWithRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;NSURLRequest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;navigationType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;UIWebViewNavigationType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;navigationType&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;bp&quot;&gt;NSURL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Intercept the external http requests and forward to Safari.app&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Otherwise forward to the PhoneGap WebView&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;http&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scheme&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;isEqualToString&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;@&amp;quot;https&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;UIApplication&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sharedApplication&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;openURL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;NO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;webView&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;theWebView&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;shouldStartLoadWithRequest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;request&lt;/span&gt; &lt;span class=&quot;nl&quot;&gt;navigationType&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;navigationType&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;];&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;@end&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;err&quot;&gt;생략&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;그리고 &lt;strong&gt;InAppBrowser&lt;/strong&gt;를 더이상 사용하지 않기 위해서 플러그인을 삭제한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap plugin remove org.apache.cordova.inappbrowser
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;마지막으로 HTML 코드도 InAppBrowser를 더이상 사용하지 않을 것이기 때문에 최초 a 링크 html 코드로 변경한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-html&quot; data-lang=&quot;html&quot;&gt;&lt;span class=&quot;nt&quot;&gt;&amp;lt;a&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;href=&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http://blog.saltfactory.net&amp;quot;&lt;/span&gt;&lt;span class=&quot;nt&quot;&gt;&amp;gt;&lt;/span&gt;Go saltfactor&amp;#39;s blog&lt;span class=&quot;nt&quot;&gt;&amp;lt;/a&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;다시 phonegap으로 ios 시뮬레이터를 실행해보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap run ios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;앱을 실행한 후 링크를 클릭하면 다음 그림과 같이 모바일 브라우저로 링크가 열리게 되는 것을 확인할 수 있다.이 방법은 기존의 HTML에 들어있는 a 링크를 InAppB    rowser 플러그인을 사용해서 열도록 코드를 분석해서 태그를 변경하지 않아도 되는 장점이 있다. &lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile8.uf.tistory.com/image/2748EB4553993D393A709B&quot; alt=&quot;simple page within a link {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile23.uf.tistory.com/image/23112434539943BE2D30CA&quot; alt=&quot;view safari new page from a link {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile4.uf.tistory.com/image/245D9834539943C01F0F9C&quot; alt=&quot;ios background navigator {width:320px;}&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;네이티브코드-변경---android&quot;&gt;네이티브코드 변경 - Android&lt;/h2&gt;

&lt;p&gt;위에서 우리는 iOS에서 네이티브 코드를 변경해서 &lt;strong&gt;&lt;em&gt;WebView&lt;/em&gt;&lt;/strong&gt;의 이벤트를 핸들링하여 처리하였는데 그러면 Android에서는 어떻게 할 수 있을까? 원리는 동일하다. iOS에서 WebView에서 링크를 클릭하였을 경우 &lt;code&gt;shouldStartLoadWithRequest&lt;/code&gt;에서 URL을 인터셉트하여 URL scheme를 분석한 것 같이 Android에서는 &lt;code&gt;shouldOverrideUrlLoading&lt;/code&gt; 안에서 URL scheme를 분석하여 처리하면 가능하다.&lt;/p&gt;

&lt;p&gt;먼저 안드로이드 PhoneGap 프로젝트에서 플랫폼을 추가하자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap build android
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이렇게 안드로이드 플랫폼을 추가하면 자동으로 안드로이드 프로젝트 파일이 생성이 되는데 앱이 시작할때 열리는 Activity를 열어보자. 우리는 PhoneGap 프로젝트 이름을 SfPhoneGapDemo로 만들었기 때문에 Activity의 이름이 &lt;code&gt;SfPhoneGapDemo.java&lt;/code&gt;로 만들어졌을 것이다. Activity 파일을 열어서 다음과 같이 수정한다.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;cm&quot;&gt;/*&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       Licensed to the Apache Software Foundation (ASF) under one&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       or more contributor license agreements.  See the NOTICE file&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       distributed with this work for additional information&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       regarding copyright ownership.  The ASF licenses this file&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       to you under the Apache License, Version 2.0 (the&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       &amp;quot;License&amp;quot;); you may not use this file except in compliance&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       with the License.  You may obtain a copy of the License at&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;         http://www.apache.org/licenses/LICENSE-2.0&lt;/span&gt;

&lt;span class=&quot;cm&quot;&gt;       Unless required by applicable law or agreed to in writing,&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       software distributed under the License is distributed on an&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       &amp;quot;AS IS&amp;quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       KIND, either express or implied.  See the License for the&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       specific language governing permissions and limitations&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt;       under the License.&lt;/span&gt;
&lt;span class=&quot;cm&quot;&gt; */&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;net&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;saltfactory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;tutorial&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;phonegapdemo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.content.Intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.graphics.Bitmap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.net.Uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.os.Bundle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.util.Log&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;android.webkit.WebView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;org.apache.cordova.*&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.net.MalformedURLException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.net.URL&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;SfPhoneGapDemo&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CordovaActivity&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Bundle&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;onCreate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;savedInstanceState&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;// Set by &amp;lt;content src=&amp;quot;index.html&amp;quot; /&amp;gt; in config.xml&lt;/span&gt;

        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;init&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;appView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setWebViewClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;CordovaWebViewClient&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;appView&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
            &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;boolean&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;shouldOverrideUrlLoading&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;WebView&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

                &lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;parse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

                &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getScheme&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;http&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getScheme&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;equals&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&amp;quot;https&amp;quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)){&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;Intent&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;ACTION_VIEW&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uri&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;startActivity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;intent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;shouldOverrideUrlLoading&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;view&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;


        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;loadUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Config&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;getStartUrl&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;());&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;//super.loadUrl(&amp;quot;file:///android_asset/www/index.html&amp;quot;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;이제 앱을 실행시켜보자.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-text&quot; data-lang=&quot;text&quot;&gt;phonegap run android
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;앱을 실행시켜서 a 링크를 클릭해보자. 그러면 안드로이드 디바이스의 디폴트 브라우저로 링크가 열리는 것을 확인할 수 있다.
이렇게 네이티브 코드를 수정하여 사용하면 InAppBrowser에서 새 창을 브라우저에서 열기 위해서 여러가지 HTML 코드를 다시 프로그램으로 수정할 필요 없이 기존의 HTML 코드의 a 링크를 그대로 사용하면서 새로운 브라우저에 열 수 있게 할 수 있다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://cfile9.uf.tistory.com/image/26261A3A5399749C0808A6&quot; alt=&quot;android simple page within a link {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile21.uf.tistory.com/image/210D153A5399749D2E5630&quot; alt=&quot;android default brwoser new page {width:320px;}&quot;&gt;
&lt;img src=&quot;http://cfile10.uf.tistory.com/image/2407753A5399749D23F2F4&quot; alt=&quot;android backgroud navigator {width:320px;}&quot;&gt;&lt;/p&gt;

&lt;h2 id=&quot;결론&quot;&gt;결론&lt;/h2&gt;

&lt;p&gt;기존의 iOS 앱과 Android 앱을 하나의 코드로 관리하기 위해서 &lt;a href=&quot;http://ionicframework.com&quot;&gt;Ionic Framework&lt;/a&gt; 를 이용하여 하이브리드 앱을 만들었다. Ionic은 &lt;a href=&quot;https://angularjs.org/&quot;&gt;AngularJS&lt;/a&gt;와 &lt;a href=&quot;http://cordova.apache.org&quot;&gt;Cordova&lt;/a&gt;(&lt;a href=&quot;http://phonegap.com&quot;&gt;PhoneGap&lt;/a&gt;) 기반의 하이브리드 앱 개발 플랫폼인데 앱을 구현할 때 상세보기에서 서버로 부터 웹페이지코드(HTML)을 가져와서 뷰에 출력시켜주는 부분이 있었다. 그런데 상세보기 페이지 안에 사용자가 작성한 A 링크가 문제가 되는 것을 확인했다. 서버에서 HTML 코드를 받아오는 것이기 때문에 PhoneGap의 &lt;a href=&quot;https://github.com/apache/cordova-plugin-inappbrowser&quot;&gt;InAppBrowser&lt;/a&gt; 플러그인을 사용해서 HTML 코드를 변경시키는 것은 복잡하고 비용이 많이 발생하는 것으로 판단되었다. 그래서 서버로부터 받아오는 HTML 의 코드는 변경하지 않고 HTML 코드 안에 A 링크가 포함되어 있을 때 , 사용자가 링크를 클릭(터치)하게 되면 새로운 모바일 브라우저로 링크가 열리게 하려고 자료를 찾고 연구하였다. 방법은 PhoneGap은 네이티브코드의 WebView를 사용하고 있는데 이 WebView는 각각 플랫폼에서 이벤트를 받아서 처리하는 부분에 URL을 인터셉트할 수 있는 것을 확인하였고, iOS에서는 &lt;code&gt;shouldStartLoadWithRequest&lt;/code&gt;를 이용하고 Android에서는 `shouldOverrideUrlLoading&amp;#39;을 사용하여 처리할 수 있는 것을 알게되었다. 이것이 하이브리드 앱의 장점이 아닌가 생각한다. 웹 자원의 코드를 변경하는 것도 가능하고 네이티브의 자원을 변경하여 사용하는 것도 가능해서 문제의 해결방법이 다양한 각도로 접근할 수 있는 것 같다. 하이브리드 앱을 개발한다면 컨텐츠 안에 들어있는 A 링크를 처리하는 문제를 반드시 겪게 될 것인데 이 포스팅에서 소개하는 내용으로 문제를 해결할 수 있기를 바래본다.&lt;/p&gt;

&lt;h2 id=&quot;참고&quot;&gt;참고&lt;/h2&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://developer.apple.com/library/ios/documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html&quot;&gt;https://developer.apple.com/library/ios/documentation/uikit/reference/UIWebViewDelegate_Protocol/Reference/Reference.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://developer.android.com/reference/android/webkit/WebViewClient.html&quot;&gt;http://developer.android.com/reference/android/webkit/WebViewClient.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/17887348/phonegap-open-link-in-browser&quot;&gt;http://stackoverflow.com/questions/17887348/phonegap-open-link-in-browser&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://techiepulkit.blogspot.kr/2013/01/android-invoking-url-scheme-intent-from.html&quot;&gt;http://techiepulkit.blogspot.kr/2013/01/android-invoking-url-scheme-intent-from.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://stackoverflow.com/questions/12601491/android-phonegap-intercept-url-equivalent-of-ios-shouldstartloadwithrequest&quot;&gt;http://stackoverflow.com/questions/12601491/android-phonegap-intercept-url-equivalent-of-ios-shouldstartloadwithrequest&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;연구원-소개&quot;&gt;연구원 소개&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;작성자 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;송성광&lt;/a&gt; 개발 연구원&lt;/li&gt;
&lt;li&gt;프로필 : &lt;a href=&quot;http://about.me/saltfactory&quot;&gt;http://about.me/saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;이메일 : &lt;a href=&quot;mailto:saltfactory@gmail.com&quot;&gt;saltfactory@gmail.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;트위터 : &lt;a href=&quot;https://twitter.com/saltfactory&quot;&gt;@saltfactory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;페이스북 : &lt;a href=&quot;https://facebook.com/salthub&quot;&gt;https://facebook.com/salthub&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;연구소 : &lt;a href=&quot;http://www.hibrain.net&quot;&gt;하이브레인넷&lt;/a&gt; 부설연구소&lt;/li&gt;
&lt;li&gt;연구실 : &lt;a href=&quot;http://dblab.changwon.ac.kr&quot;&gt;창원대학교 데이터베이스 연구실&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
        <pubDate>Sat, 14 Jun 2014 00:00:00 +0900</pubDate>
        <link>http://saltfactory.net/series/hybridapp/solve-external-link-tag-in-phonegap.html</link>
        <guid isPermaLink="true">http://saltfactory.net/series/hybridapp/solve-external-link-tag-in-phonegap.html</guid>
        
        
        <category>hybridapp</category>
        
      </item>
    
  </channel>
</rss>
